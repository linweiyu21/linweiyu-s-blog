<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Micronaut,Groovy,Gradle,Java,ÊñáÊ°£,‰∏≠Êñá">
    <meta name="description" content="Micronaut Groovy Gradle Java ÊñáÊ°£ ‰∏≠Êñá">
    <meta name="author" content="ÊûóÂ®ÅÁæΩ">
    
    <title>
        
            Dockerfile reference |
        
        ÊûóÂ®ÅÁæΩÁöÑÁ¨îËÆ∞
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"rgb(153,153,0)","avatar":"/images/avatar.jpg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"400px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":null,"description":"def containsüöÄ = ['Micronaut', 'Groovy', 'Gradle', 'etc']"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ÁßíÂâç","minute":"%s ÂàÜÈíüÂâç","hour":"%s Â∞èÊó∂Ââç","day":"%s Â§©Ââç","week":"%s Âë®Ââç","month":"%s ‰∏™ÊúàÂâç","year":"%s Âπ¥Ââç"};
  </script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                ÊûóÂ®ÅÁæΩÁöÑÁ¨îËÆ∞
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                È¶ñÈ°µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                ÂàÜÁ±ª
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                Ê†áÁ≠æ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ÂΩíÊ°£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ÂÖ≥‰∫é
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">È¶ñÈ°µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">ÂàÜÁ±ª</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">Ê†áÁ≠æ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ÂΩíÊ°£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ÂÖ≥‰∫é</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

    <a target="_blank" rel="noopener" href="https://github.com/linweiyu21/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80"
        viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
        aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg></a>
    <style>
      .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }

      @keyframes octocat-wave {

        0%,
        100% {
          transform: rotate(0)
        }

        20%,
        60% {
          transform: rotate(-25deg)
        }

        40%,
        80% {
          transform: rotate(10deg)
        }
      }

      @media (max-width:500px) {
        .github-corner:hover .octo-arm {
          animation: none
        }

        .github-corner .octo-arm {
          animation: octocat-wave 560ms ease-in-out
        }
      }
    </style>
</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Dockerfile reference</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">ÊûóÂ®ÅÁæΩ</span>
                        
                            <span class="author-label">Lv8</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-05-18 10:38:18</span>
        <span class="mobile">2022-05-18 10:38</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Docker/">Docker</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Docker/">Docker</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Reference/">Reference</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <!-- TOC -->

<ul>
<li><a href="#usage-%E4%BD%BF%E7%94%A8">Usage (‰ΩøÁî®)</a></li>
<li><a href="#buildkit">BuildKit</a></li>
<li><a href="#format-%E6%A0%BC%E5%BC%8F">Format (Ê†ºÂºè)</a></li>
<li><a href="#parser-directives-%E8%A7%A3%E6%9E%90%E5%99%A8%E6%8C%87%E4%BB%A4">Parser directives (Ëß£ÊûêÂô®Êåá‰ª§)</a><ul>
<li><a href="#syntax">syntax</a></li>
<li><a href="#escape">escape</a></li>
</ul>
</li>
<li><a href="#environment-replacement-%E7%8E%AF%E5%A2%83%E6%9B%B4%E6%8D%A2">Environment replacement (ÁéØÂ¢ÉÊõ¥Êç¢)</a></li>
<li><a href="#dockerignore-file-dockerignore-%E6%96%87%E4%BB%B6">.dockerignore file (<code>.dockerignore</code> Êñá‰ª∂)</a></li>
<li><a href="#from-from-%E6%8C%87%E4%BB%A4">FROM (FROM Êåá‰ª§)</a><ul>
<li><a href="#understanding-how-arg-and-from-interact-%E7%90%86%E8%A7%A3-arg-%E5%92%8C-from-%E6%80%8E%E6%A0%B7%E4%BA%A4%E4%BA%92">Understanding how ARG and FROM interact (ÁêÜËß£ ARG Âíå FROM ÊÄéÊ†∑‰∫§‰∫í)</a></li>
</ul>
</li>
<li><a href="#run-run-%E6%8C%87%E4%BB%A4">RUN (RUN Êåá‰ª§)</a><ul>
<li><a href="#know-issues-run-run-%E6%8C%87%E4%BB%A4%E7%9A%84%E5%B7%B2%E7%9F%A5%E9%97%AE%E9%A2%98">Know issues (RUN) (RUN Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò)</a></li>
</ul>
</li>
<li><a href="#cmd-cmd-%E6%8C%87%E4%BB%A4">CMD (CMD Êåá‰ª§)</a></li>
<li><a href="#label-label-%E6%8C%87%E4%BB%A4">LABEL (LABEL Êåá‰ª§)</a></li>
<li><a href="#maintainer-deprecated-maintainer-%E6%8C%87%E4%BB%A4-%E5%B7%B2%E8%BF%87%E6%97%B6">MAINTAINER (deprecated) (MAINTAINER Êåá‰ª§ Â∑≤ËøáÊó∂)</a></li>
<li><a href="#expose-expose-%E6%8C%87%E4%BB%A4">EXPOSE (EXPOSE Êåá‰ª§)</a></li>
<li><a href="#env-env-%E6%8C%87%E4%BB%A4">ENV (ENV Êåá‰ª§)</a><ul>
<li><a href="#%E6%9B%BF%E4%BB%A3%E7%9A%84%E8%AF%AD%E6%B3%95">Êõø‰ª£ÁöÑËØ≠Ê≥ï</a></li>
</ul>
</li>
<li><a href="#add-add-%E6%8C%87%E4%BB%A4">ADD (ADD Êåá‰ª§)</a></li>
<li><a href="#copy-copy-%E6%8C%87%E4%BB%A4">COPY (COPY Êåá‰ª§)</a></li>
<li><a href="#entrypoint-entrypoint-%E6%8C%87%E4%BB%A4">ENTRYPOINT (ENTRYPOINT Êåá‰ª§)</a><ul>
<li><a href="#exec-form-entrypoint-example-exec-%E5%BD%A2%E5%BC%8F-entrypoint-%E4%BE%8B%E5%AD%90">Exec form ENTRYPOINT example (<code>Exec</code> ÂΩ¢Âºè <code>ENTRYPOINT</code> ‰æãÂ≠ê)</a></li>
<li><a href="#shell-form-entrypoint-example-shell-%E5%BD%A2%E5%BC%8F-entrypoint-%E4%BE%8B%E5%AD%90">Shell form ENTRYPOINT example (Shell ÂΩ¢Âºè <code>ENTRYPOINT</code> ‰æãÂ≠ê)</a></li>
<li><a href="#understand-how-cmd-and-entrypoint-interact-%E7%90%86%E8%A7%A3-cmd-%E5%92%8C-entrypoint-%E6%98%AF%E6%80%8E%E6%A0%B7%E4%BA%A4%E4%BA%92%E7%9A%84">Understand how CMD and ENTRYPOINT interact (ÁêÜËß£ CMD Âíå ENTRYPOINT ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ)</a></li>
</ul>
</li>
<li><a href="#volume-volume-%E6%8C%87%E4%BB%A4">VOLUME (VOLUME Êåá‰ª§)</a><ul>
<li><a href="#notes-about-specifying-volumes-%E5%85%B3%E4%BA%8E%E6%8C%87%E5%AE%9A%E5%8D%B7%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">Notes about specifying volumes (ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π)</a></li>
<li><a href="#%E7%90%86%E8%A7%A3">ÁêÜËß£</a></li>
</ul>
</li>
<li><a href="#user-user-%E6%8C%87%E4%BB%A4">USER (USER Êåá‰ª§)</a></li>
<li><a href="#workdir-workdir-%E6%8C%87%E4%BB%A4">WORKDIR (WORKDIR Êåá‰ª§)</a></li>
<li><a href="#arg-arg-%E6%8C%87%E4%BB%A4">ARG (ARG Êåá‰ª§)</a><ul>
<li><a href="#default-values-%E9%BB%98%E8%AE%A4%E5%80%BC">Default values (ÈªòËÆ§ÂÄº)</a></li>
<li><a href="#scope-%E4%BD%9C%E7%94%A8%E5%9F%9F">Scope (‰ΩúÁî®Âüü)</a></li>
<li><a href="#using-arg-variables-%E4%BD%BF%E7%94%A8-arg-%E5%8F%98%E9%87%8F">Using ARG variables (‰ΩøÁî® ARG ÂèòÈáè)</a></li>
<li><a href="#predefined-args-%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84-args">Predefined ARGs (È¢ÑÂÆö‰πâÁöÑ ARGs)</a></li>
<li><a href="#automatic-platform-args-in-the-global-scope-%E5%85%A8%E5%B1%80%E8%8C%83%E5%9B%B4%E5%86%85%E7%9A%84%E8%87%AA%E5%8A%A8%E5%B9%B3%E5%8F%B0-args">Automatic platform ARGs in the global scope (ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞ ARGs)</a></li>
<li><a href="#impact-on-build-caching-%E5%AF%B9%E6%9E%84%E5%BB%BA%E7%BC%93%E5%AD%98%E7%9A%84%E5%BD%B1%E5%93%8D">Impact on build caching (ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç)</a></li>
</ul>
</li>
<li><a href="#onbuild-onbuild-%E6%8C%87%E4%BB%A4">ONBUILD (ONBUILD Êåá‰ª§)</a></li>
<li><a href="#stopsignal-stopsignal-%E6%8C%87%E4%BB%A4">STOPSIGNAL (STOPSIGNAL Êåá‰ª§)</a></li>
<li><a href="#healthcheck-healthcheck-%E6%8C%87%E4%BB%A4">HEALTHCHECK (HEALTHCHECK Êåá‰ª§)</a></li>
<li><a href="#shell-shell-%E6%8C%87%E4%BB%A4">SHELL (SHELL Êåá‰ª§)</a></li>
<li><a href="#%E5%8F%82%E8%80%83">ÂèÇËÄÉ</a></li>
</ul>
<!-- /TOC -->

<blockquote>
<p>Docker can build images automatically by reading the instructions from a <code>Dockerfile</code>.</p>
</blockquote>
<p>ÈÄöËøá‰ªé‰∏Ä‰∏™ <code>Dockerfile</code> ‰∏≠ËØªÂèñÊåá‰ª§, Docker ÂèØ‰ª•Ëá™Âä®ÊûÑÂª∫ÈïúÂÉè</p>
<blockquote>
<p>A <code>Dockerfile</code> is a text document that contains all the commands a user could call on the command line to assemble an image.</p>
</blockquote>
<p>Dockerfile ÊòØ‰∏Ä‰∏™ÊñáÊú¨ÊñáÊ°£, ÂåÖÂê´‰∫ÜÁî®Êà∑ÂèØ‰ª•Âú®ÂëΩ‰ª§Ë°å‰∏äË∞ÉÁî®ÁöÑ, ‰ª•ÁªÑÂêàÈïúÂÉèÁöÑÊâÄÊúâÂëΩ‰ª§</p>
<blockquote>
<p>Using <code>docker build</code> users can create an automated build that executes several command-line instructions in succession.</p>
</blockquote>
<p>‰ΩøÁî® <code>docker build</code>, Áî®Êà∑ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™Ëá™Âä®ÂåñÊûÑÂª∫, Ëøô‰∏™ÊûÑÂª∫ËøûÁª≠ÊâßË°åÂ§ö‰∏™ÂëΩ‰ª§Ë°åÊåá‰ª§</p>
<blockquote>
<p>This page describes the commands you can use in a Dockerfile.</p>
</blockquote>
<p>Ëøô‰∏™È°µÈù¢ÊèèËø∞‰∫Ü‰Ω†ÂèØ‰ª•Âú® <code>Dockerfile</code> ‰∏≠‰ΩøÁî®ÁöÑÂëΩ‰ª§</p>
<blockquote>
<p>When you are done reading this page, refer to the <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code>Dockerfile</code> Best Practices</a> for a tip-oriented guide.</p>
</blockquote>
<p>Âú®‰Ω†ËØªÂÆåËøô‰∏™È°µÈù¢‰πãÂêé, Êü•Áúã <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code>Dockerfile</code> Best Practices</a> ‰ª•Ëé∑ÂèñÈù¢ÂêëÊèêÁ§∫ÁöÑÊåáÂçó</p>
<h2 id="Usage-‰ΩøÁî®"><a href="#Usage-‰ΩøÁî®" class="headerlink" title="Usage (‰ΩøÁî®)"></a>Usage (‰ΩøÁî®)</h2><blockquote>
<p>The <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/build/" >docker build<i class="fas fa-external-link-alt"></i></a> command builds an image from a <code>Dockerfile</code> and a context.</p>
</blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/build/" >docker build<i class="fas fa-external-link-alt"></i></a> ÂëΩ‰ª§‰ªé <code>Dockerfile</code> Âíå ‰∏ä‰∏ãÊñá ‰∏≠ÊûÑÂª∫ÈïúÂÉè</p>
<blockquote>
<p>The build‚Äôs context is the set of files at a specified location <code>PATH</code> or <code>URL</code>.</p>
</blockquote>
<p>ÊûÑÂª∫ÁöÑ‰∏ä‰∏ãÊñáÊòØ‰Ωç‰∫éÊåáÂÆö <code>PATH</code> Êàñ <code>URL</code> ÁöÑ‰ΩçÁΩÆ‰∏≠ÁöÑ‰∏ÄÁªÑÊñá‰ª∂</p>
<blockquote>
<p>The <code>PATH</code> is a directory on your local filesystem. The <code>URL</code> is a Git repository location.</p>
</blockquote>
<p><code>PATH</code> ÊòØÂú®‰Ω†Êú¨Âú∞Êñá‰ª∂Á≥ªÁªü‰∏äÁöÑ‰∏Ä‰∏™Êñá‰ª∂Â§π. <code>URL</code> ÊòØ‰∏Ä‰∏™ Git ‰ªìÂ∫ìÂú∞ÂùÄ</p>
<blockquote>
<p>The build context is processed recursively. So, a <code>PATH</code> includes any subdirectories and the <code>URL</code> includes the repository and its submodules.</p>
</blockquote>
<p>ÊûÑÂª∫‰∏ä‰∏ãÊñáÊòØÈÄíÂΩíÂ§ÑÁêÜÁöÑ. ÊâÄ‰ª•, <code>PATH</code> ÂåÖÊã¨‰∫ÜÊâÄÊúâÁöÑÂ≠êÁõÆÂΩï, <code>URL</code> ÂåÖÊã¨‰∫Ü‰ªìÂ∫ìÂíåÂÆÉÁöÑÂ≠êÊ®°Âùó</p>
<blockquote>
<p>This example shows a build command that uses the current directory (.) as build context:</p>
</blockquote>
<p>Ëøô‰∏™‰æãÂ≠êÂ±ïÁ§∫‰∫Ü‰∏Ä‰∏™‰ΩøÁî®ÂΩìÂâçÁõÆÂΩï (.) ‰Ωú‰∏∫ÊûÑÂª∫‰∏ä‰∏ãÊñáÁöÑÊûÑÂª∫ÂëΩ‰ª§:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The build is run by the Docker daemon, not by the CLI. The first thing a build process does is send the entire context (recursively) to the daemon. In most cases, it‚Äôs best to start with an empty directory as context and keep your Dockerfile in that directory. Add only the files needed for building the Dockerfile.</p>
</blockquote>
<p>Ëøô‰∏™ÊûÑÂª∫ÊòØÈÄöËøá Docker daemon ËøêË°åÁöÑ, ‰∏çÊòØÈÄöËøá CLI. ÊûÑÂª∫ËøáÁ®ãÂÅöÁöÑÁ¨¨‰∏Ä‰ª∂‰∫ãÊòØÂ∞ÜÊï¥‰∏™‰∏ä‰∏ãÊñá (ÈÄíÂΩíÂú∞) ÂèëÈÄÅÂà∞ daemon. Âú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã, ÊúÄÂ•Ω‰ΩøÁî®‰∏Ä‰∏™Á©∫ÁõÆÂΩï‰Ωú‰∏∫‰∏ä‰∏ãÊñáÊù•ÂºÄÂßã, Âπ∂Â∞Ü <code>Dockerfile</code> ‰øùÂ≠òÂú®Ëøô‰∏™ÁõÆÂΩï‰∏≠. Âè™Ê∑ªÂä†ÊûÑÂª∫ <code>Dockerfile</code> ÊâÄÈúÄË¶ÅÁöÑÊñá‰ª∂</p>
<blockquote>
<p>Warning<br>Do not use your root directory, <code>/</code>, as the <code>PATH</code> for your build context, as it causes the build to transfer the entire contents of your hard drive to the Docker daemon.</p>
</blockquote>
<p>Ë≠¶Âëä, ‰∏çË¶ÅÂ∞ÜÊ†πÁõÆÂΩï <code>/</code> ËÆæÁΩÆ‰∏∫‰Ω†ÁöÑÊûÑÂª∫‰∏ä‰∏ãÊñáÁöÑ <code>PATH</code>, Âõ†‰∏∫ËøôÂ∞Ü‰ºöÂØºËá¥ÊûÑÂª∫Â∞Ü‰Ω†Á°¨Áõò‰∏äÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπ‰º†ËæìÁªô Docker daemon</p>
<blockquote>
<p>To use a file in the build context, the <code>Dockerfile</code> refers to the file specified in an instruction, for example, a <code>COPY</code> instruction. To increase the build‚Äôs performance, exclude files and directories by adding a <code>.dockerignore</code> file to the context directory. For information about how to <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">create a <code>.dockerignore</code> file</a> see the documentation on this page.</p>
</blockquote>
<p>Ë¶ÅÂú®ÊûÑÂª∫‰∏ä‰∏ãÊñá‰∏≠‰ΩøÁî®Êñá‰ª∂, <code>Dockerfile</code> Êü•Áúã (refer to) Âú®Êåá‰ª§‰∏≠ÊåáÂÆöÁöÑÊñá‰ª∂, ‰æãÂ¶Ç, ‰∏Ä‰∏™ <code>COPY</code> Êåá‰ª§. ‰∏∫‰∫ÜÊèêÈ´òÊûÑÂª∫ÁöÑÊÄßËÉΩ, ÈÄöËøáÊ∑ªÂä†‰∏Ä‰∏™ <code>.dockerignore</code> Êñá‰ª∂Âà∞‰∏ä‰∏ãÊñáÁõÆÂΩï‰∏≠Êù•ÊéíÈô§Êñá‰ª∂ÂíåÁõÆÂΩï. Êü•ÁúãËøô‰∏™È°µÈù¢‰∏äÁöÑ <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">create a <code>.dockerignore</code> file</a> Ëé∑ÂèñÂÖ≥‰∫éÂ¶Ç‰ΩïÂàõÂª∫‰∏Ä‰∏™ <code>.dockeringore</code> Êñá‰ª∂ÁöÑ‰ø°ÊÅØ</p>
<blockquote>
<p>Traditionally, the <code>Dockerfile</code> is called <code>Dockerfile</code> and located in the root of the context. You use the <code>-f</code> flag with <code>docker build</code> to point to a Dockerfile anywhere in your file system.</p>
</blockquote>
<p>‰π†ÊÉØ‰∏ä, <code>Dockerfile</code> Ë¢´Áß∞‰∏∫ <code>Dockerfile</code>, ‰Ωç‰∫é‰∏ä‰∏ãÊñáÁöÑÊ†πÁõÆÂΩï‰∏≠. ‰Ω†ÂèØ‰ª•Âú® <code>docker build</code> ‰∏≠‰ΩøÁî® <code>-f</code> Ê†áÂøóÊù•ÊåáÂêë‰∏Ä‰∏™Âú®‰Ω†Êñá‰ª∂Á≥ªÁªü‰∏≠‰ªª‰Ωï‰ΩçÁΩÆ‰∏äÁöÑ Dockerfile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -f /path/to/a/Dockerfile .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>You can specify a repository and tag at which to save the new image if the build succeeds:</p>
</blockquote>
<p>‰Ω†ÂèØ‰ª•ÊåáÂÆöÂú®ÊûÑÂª∫ÊàêÂäü‰øùÂ≠òÊñ∞ÈïúÂÉèÊó∂‰ΩøÁî®ÁöÑ‰ªìÂ∫ìÂíåÊ†áÁ≠æ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t shyke/myapp .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>To tag the image into multiple repositories after the build, add multiple <code>-t</code> parameters when you run the <code>build</code> command:</p>
</blockquote>
<p>Ë¶ÅÂú®ÊûÑÂª∫‰πãÂêéÂ∞ÜÈïúÂÉèÊ†áËÆ∞Âà∞Â§ö‰∏™‰ªìÂ∫ì, Âú®ËøêË°å <code>build</code> ÂëΩ‰ª§Êó∂Ê∑ªÂä†Â§ö‰∏™ <code>-t</code> ÂèÇÊï∞:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t shyke/myapp:1.0.2 -t shyke/myapp:latest .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Before the Docker daemon runs the instructions in the <code>Dockerfile</code>, it performs a preliminary validation of the <code>Dockerfile</code> and returns an error if the syntax is incorrect:</p>
</blockquote>
<p>Âú® Docker daemon ËøêË°å <code>Dockerfile</code> ‰∏≠ÁöÑÊåá‰ª§Ââç, Docker daemon ÂØπ <code>Dockerfile</code> ËøõË°å‰∏Ä‰∏™ÂàùÊ≠•ÁöÑÊ†°È™å, Â¶ÇÊûúËØ≠Ê≥ï‰∏çÊ≠£Á°ÆËøôËøîÂõûÈîôËØØ:</p>
<blockquote>
<p>The Docker daemon runs the instructions in the <code>Dockerfile</code> one-by-one, committing the result of each instruction to a new image if necessary, before finally outputting the ID of your new image. The Docker daemon will automatically clean up the context you sent.</p>
</blockquote>
<p>Docker daemon ‰∏Ä‰∏™‰∏Ä‰∏™Âú∞ËøêË°å <code>Dockerfile</code> ‰∏≠ÁöÑÊåá‰ª§, Â¶ÇÊûúÂøÖË¶ÅÁöÑËØù, Âú®ÊúÄÁªàËæìÂá∫‰Ω†ÁöÑÊñ∞ÈïúÂÉèÁöÑ ID Ââç, Êèê‰∫§ÊØè‰∏Ä‰∏™Êåá‰ª§ÁöÑÁªìÊûúÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÈïúÂÉè‰∏≠. Docker daemon ‰ºöËá™Âä®Ê∏ÖÁêÜ‰Ω†‰Ω†ÂèëÈÄÅÁöÑ‰∏ä‰∏ãÊñá</p>
<blockquote>
<p>Note that each instruction is run independently, and causes a new image to be created - so <code>RUN cd /tmp</code> will not have any effect on the next instructions.</p>
</blockquote>
<p>Ê≥®ÊÑè, ÊØè‰∏™Êåá‰ª§ÈÉΩÊòØÁã¨Á´ãËøêË°åÁöÑ, ÂØºËá¥‰∏Ä‰∏™Êñ∞ÈïúÂÉèË¢´ÂàõÂª∫, ÊâÄ‰ª• <code>RUN cd /tmp</code> Â∞Ü‰∏ç‰ºöÂØπ‰∏ã‰∏Ä‰∏™Êåá‰ª§‰∫ßÁîü‰ªª‰ΩïÂΩ±Âìç</p>
<blockquote>
<p>Whenever possible, Docker uses a build-cache to accelerate the <code>docker build</code> process significantly. This is indicated by the <code>CACHED</code> message in the console output. (For more information, see the <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code>Dockerfile</code> best practices guide</a>):</p>
</blockquote>
<p>Âè™Ë¶ÅÊúâÂèØËÉΩ, Docker Â∞±‰ºö‰ΩøÁî®ÊûÑÂª∫ÁºìÂ≠òÊù•ÊòæËëóÂä†Âø´ <code>docker build</code> ÁöÑÂ§ÑÁêÜ. ËøôÁî±ÊéßÂà∂Âè∞ËæìÂá∫‰∏≠ÁöÑ <code>CACHED</code> Ê∂àÊÅØÊåáÁ§∫. (Êü•Áúã <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/"><code>Dockerfile</code> best practices guide</a> Ëé∑ÂèñÊõ¥Â§ö‰ø°ÊÅØ):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t svendowideit/ambassador .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>By default, the build cache is based on results from previous builds on the machine on which you are building. The <code>--cache-from</code> option also allows you to use a build-cache that‚Äôs distributed through an image registry refer to the <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/build/#specifying-external-cache-sources" >specifying external cache sources section<i class="fas fa-external-link-alt"></i></a> in the <code>docker build</code> command reference.</p>
</blockquote>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ã, ÊûÑÂª∫ÁºìÂ≠òÂü∫‰∫é‰Ω†Ê≠£Âú®ÊûÑÂª∫ÁöÑÊú∫Âô®‰∏äÁöÑÂÖàÂâçÁöÑÊûÑÂª∫ÁªìÊûú. <code>--cache-from</code> ÈÄâÈ°πËøòÂÖÅËÆ∏‰Ω†‰ΩøÁî®ÈÄöËøáÈïúÂÉèÊ≥®ÂÜåÂ§ÑÂàÜÂèëÁöÑÊûÑÂª∫ÁºìÂ≠ò, ËØ∑ÂèÇËÄÉ <code>docker build</code> ÂëΩ‰ª§ÊâãÂÜå‰∏≠ÁöÑ <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/build/#specifying-external-cache-sources" >specifying external cache sources section<i class="fas fa-external-link-alt"></i></a> ÈÉ®ÂàÜ</p>
<blockquote>
<p>When you‚Äôre done with your build, you‚Äôre ready to look into <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/scan/">scanning your image with <code>docker scan</code></a>, and <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/docker-hub/repos/" >pushing your image to Docker Hub<i class="fas fa-external-link-alt"></i></a>.</p>
</blockquote>
<p>ÂΩìÂÆåÊàêÊûÑÂª∫Êó∂, ‰Ω†Â∞±ÂèØ‰ª•ÂºÄÂßã‰ΩøÁî® <code>docker scan</code> Êù•<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/scan/" >Êâ´Êèè‰Ω†ÁöÑÈïúÂÉè<i class="fas fa-external-link-alt"></i></a>, Âπ∂<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/docker-hub/repos/" >Êé®ÈÄÅ‰Ω†ÁöÑÈïúÂÉèÂà∞ Docker Hub<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="BuildKit"><a href="#BuildKit" class="headerlink" title="BuildKit"></a>BuildKit</h2><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/moby/buildkit" >BuildKit<i class="fas fa-external-link-alt"></i></a> ÂêéÁ´ØÊèê‰æõ‰∫ÜÊØîÊóßÁöÑÊûÑÂª∫Â∑•ÂÖ∑Êõ¥Â§öÁöÑÂäüËÉΩ</p>
<p>ËÆæÁΩÆ <code>DOCKER_BUILDKIT=1</code> ÁéØÂ¢ÉÂèòÈáèÊù•ÂºÄÂêØ‰ΩøÁî® BuildKit</p>
<h2 id="Format-Ê†ºÂºè"><a href="#Format-Ê†ºÂºè" class="headerlink" title="Format (Ê†ºÂºè)"></a>Format (Ê†ºÂºè)</h2><p><code>Dockerfile</code> ‰∏≠ÁöÑÊ†ºÂºè:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ê≥®Èáä</span></span><br><span class="line">Êåá‰ª§ ÂèÇÊï∞</span><br></pre></td></tr></table></figure>

<p>Êåá‰ª§‰∏çÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑ,Á∫¶ÂÆö‰ΩøÁî®Â§ßÂÜôÂΩ¢Âºè</p>
<p>‰∏Ä‰∏™ <code>Dockerfile</code> ÂøÖÈ°ª‰ª• <code>FROM</code> Êåá‰ª§‰∏∫ÂºÄÂßã</p>
<p>‰ΩÜÊòØ <code>FROM</code> Êåá‰ª§ÂèØ‰ª•Âá∫Áé∞Âú® <code>Ëß£ÊûêÂô®Êåá‰ª§(parser directives)</code>, <code>Ê≥®Èáä</code>, <code>ÂÖ®Â±ÄËåÉÂõ¥ÁöÑ ARGs</code> ‰πãÂêé</p>
<p><code>FROM</code> ‰πãÂâçÂè™ËÉΩÊúâ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ <code>ARG</code> Êåá‰ª§ÔºåËøô‰∫õÊåá‰ª§Â£∞ÊòéÂú® <code>Dockerfile</code> ÁöÑ <code>FROM</code> Ë°å‰∏≠‰ΩøÁî®ÁöÑÂèÇÊï∞</p>
<p>Docker Âè™‰ºöÂ∞Ü‰ª• <code>#</code> ÂºÄÂ§¥ÁöÑË°åÁúã‰ΩúÊòØÊ≥®Èáä</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Comment</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&#x27;we are running some # of cool things&#x27;</span></span></span><br></pre></td></tr></table></figure>

<p>Ê≥®ÈáäË°åÂú® Dockerfile Êåá‰ª§ÂºÄÂßãÊâßË°åÂâçÂ∞Ü‰ºöË¢´Âà†Èô§</p>
<p>Example - ‰ª•‰∏ã‰∏§‰∏™Êåá‰ª§ÊòØÁ≠âÂêåÁöÑ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello \</span></span><br><span class="line"><span class="language-bash"><span class="comment"># comment</span></span></span><br><span class="line">world</span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello \</span></span><br><span class="line"><span class="language-bash">world</span></span><br></pre></td></tr></table></figure>

<p>Âú®Ê≥®Èáä‰∏≠‰∏çÊîØÊåÅ Ë°åÁªßÁª≠Â≠óÁ¨¶ (Line continuation)</p>
<p>‰∏∫‰∫ÜÂêëÂêéÂÖºÂÆπ, <code>#</code> Âíå Êåá‰ª§ ÂâçÁöÑÁ©∫Ê†ºÂ∞Ü‰ºöË¢´ÂøΩÁï•</p>
<p>Example - ‰ª•‰∏ã‰∏§ÁßçÂÜôÊ≥ïÊòØÁ≠âÂêåÁöÑ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">        <span class="comment"># this is a comment-line</span></span><br><span class="line">    <span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> world</span></span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># this is a comment-line</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> world</span></span><br></pre></td></tr></table></figure>

<p>‰ΩÜÊòØ, Âú®Êåá‰ª§ÂèÇÊï∞‰∏≠ÁöÑÁ©∫Ê†ºÊòØ‰ºöË¢´‰øùÁïôÁöÑ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">     hello\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">     world&quot;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="Parser-directives-Ëß£ÊûêÂô®Êåá‰ª§"><a href="#Parser-directives-Ëß£ÊûêÂô®Êåá‰ª§" class="headerlink" title="Parser directives (Ëß£ÊûêÂô®Êåá‰ª§)"></a>Parser directives (Ëß£ÊûêÂô®Êåá‰ª§)</h2><p>Ëß£ÊûêÂô®Êåá‰ª§ÊòØÂèØÈÄâÁöÑ, Âπ∂‰∏î‰ºöÂΩ±Âìç <code>Dockerfile</code> ‰∏≠ÂêéÁª≠Ë°åÁöÑÂ§ÑÁêÜÊñπÂºè</p>
<p>Ëß£ÊûêÂô®Êåá‰ª§‰∏ç‰ºöÊ∑ªÂä†Â±Ç (layers) Âà∞ÊûÑÂª∫‰∏≠, ‰πü‰∏ç‰ºö‰Ωú‰∏∫‰∏Ä‰∏™ÊûÑÂª∫Ê≠•È™§Âá∫Áé∞</p>
<p>Ëß£ÊûêÂô®Êåá‰ª§ÈÄöËøá <code># directive=value</code> ÁöÑÂΩ¢Âºè‰Ωú‰∏∫ÁâπÊÆäÁöÑÊ≥®ÈáäÁ±ªÂûãÂá∫Áé∞</p>
<p>‰∏Ä‰∏™Êåá‰ª§Âè™ËÉΩ‰ΩøÁî®‰∏ÄÊ¨°</p>
<p>‰∏ÄÊó¶‰∏Ä‰∏™Ê≥®Èáä, Á©∫ÁôΩË°åÊàñËÄÖÊûÑÂª∫Âô®Êåá‰ª§ (builder instruction) Â∑≤ÁªèË¢´Â§ÑÁêÜ‰∫Ü, ÈÇ£‰πà Docker Â∞Ü‰∏ç‰ºöÂÜçÂØªÊâæËß£ÊûêÂô®Êåá‰ª§. Docker Â∞ÜÊâÄÊúâÁöÑËß£ÊûêÂô®Êåá‰ª§Áúã‰ΩúÊòØÊôÆÈÄöÁöÑÊ≥®Èáä, ‰∏ç‰ºöÂéªÊ†°È™åÂÆÉÊòØÂê¶‰∏∫‰∏Ä‰∏™Ëß£ÊûêÂô®Êåá‰ª§</p>
<p>Âõ†Ê≠§, ÊâÄÊúâÁöÑËß£ÊûêÂô®Êåá‰ª§ÂøÖÈ°ªÂú® <code>Dockerfile</code> ÁöÑÊúÄ‰∏äÈù¢</p>
<p>Ëß£ÊûêÂô®Êåá‰ª§‰∏ç‰ºöÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑ, ‰ΩÜÊòØÁ∫¶ÂÆö‰ΩøÁî®Â∞èÂÜô</p>
<p>ËøòÁ∫¶ÂÆöÂú®‰ªª‰ΩïËß£ÊûêÂô®Êåá‰ª§ÂêéÈù¢ÂåÖÂê´‰∏Ä‰∏™Á©∫Ë°å</p>
<p>Âú®Ëß£ÊûêÂô®Êåá‰ª§‰∏≠‰∏çÊîØÊåÅÊç¢Ë°åÁ¨¶</p>
<p>Êú™Áü•ÁöÑËß£ÊûêÂô®Êåá‰ª§ÂΩìÂÅöÊôÆÈÄöÊ≥®Èáä</p>
<p>Ëß£ÊûêÂô®Êåá‰ª§‰∏≠ÂÖÅËÆ∏‰ΩøÁî®ÈùûÊç¢Ë°åÁ©∫Ê†º</p>
<p>ÊîØÊåÅÂ¶Ç‰∏ã‰∏§ÁßçËß£ÊûêÂô®Êåá‰ª§:</p>
<ul>
<li><code>syntax</code></li>
<li><code>escape</code></li>
</ul>
<h3 id="syntax"><a href="#syntax" class="headerlink" title="syntax"></a>syntax</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax=[remote image reference]</span></span><br></pre></td></tr></table></figure>

<p>‰æãÂ¶Ç:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax=docker/dockerfile:1</span></span><br><span class="line"><span class="comment"># syntax=docker.io/docker/dockerfile:1</span></span><br><span class="line"><span class="comment"># syntax=example.com/user/repo:tag@sha256:abcdef...</span></span><br></pre></td></tr></table></figure>

<p>Ëøô‰∏™ÂäüËÉΩÂè™ËÉΩÂú®‰ΩøÁî® BuildKit ÂêéÁ´ØÊó∂‰ΩøÁî®, Âú®‰ΩøÁî®‰º†ÁªüÊûÑÂª∫Âô®ÂêéÁ´ØÊó∂Â∞Ü‰ºöË¢´ÂøΩÁï•</p>
<p>syntax Êåá‰ª§ÂÆö‰πâ‰∫ÜÁî®Êù•ÊûÑÂª∫ Dockerfile ÁöÑ Dockerfile ËØ≠Ê≥ïÁöÑ‰ΩçÁΩÆ</p>
<p>Ëøô‰∫õ Dockerfile ËØ≠Ê≥ïÂÆûÁé∞‰Ωú‰∏∫‰∏Ä‰∏™ Docker ÈïúÂÉèËøõË°åÂèëÂ∏É</p>
<p>BuildKit ‰ΩøÁî®Â§ñÈÉ®ÁöÑ Dockerfile ËØ≠Ê≥ïÂÆûÁé∞Êù•Âú®‰∏Ä‰∏™ÂÆπÂô®Ê≤ôÁõíÁéØÂ¢É‰∏≠ÊâßË°åÊûÑÂª∫</p>
<p>ÂÆòÊñπÁöÑ Dockerfile ËØ≠Ê≥ïÂÆûÁé∞‰Ωç‰∫é Docker Hub ‰∏≠ÁöÑ <code>docker/dockerfile</code> ‰ªìÂ∫ì‰∏≠</p>
<p>Á®≥ÂÆöÁâàÊú¨ÁöÑËØ≠Ê≥ïÂÆûÁé∞: <code>docker/dockerfile:1</code></p>
<p>ÂÆûÈ™åÁâàÊú¨ÁöÑËØ≠Ê≥ïÂÆûÁé∞: <code>docker/dockerfile:labs</code></p>
<h3 id="escape"><a href="#escape" class="headerlink" title="escape"></a>escape</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># escape=\</span></span><br></pre></td></tr></table></figure>

<p>ÊàñËÄÖ</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># escape=`</span></span><br></pre></td></tr></table></figure>

<p><code>escape</code> Êåá‰ª§Áî®Êù•ËÆæÁΩÆÂú® <code>Dockerfile</code> ‰∏≠‰ΩøÁî®ÁöÑËΩ¨‰πâÁ¨¶Á¨¶Âè∑. ÈªòËÆ§ÁöÑËΩ¨‰πâÁ¨¶Âè∑ÊòØ <code>\</code></p>
<p>Âú® Windows Âπ≥Âè∞‰∏≠, Ë∑ØÂæÑÂàÜÈöîÁ¨¶ÊòØ <code>\</code>, Âõ†Ê≠§ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™Êåá‰ª§Êù•ËÆæÁΩÆËΩ¨‰πâÁ¨¶Âè∑‰∏∫ `</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># escape=`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> microsoft/nanoserver</span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> testfile.txt c:\</span></span><br><span class="line"><span class="language-bash">RUN <span class="built_in">dir</span> c:\</span></span><br></pre></td></tr></table></figure>

<h2 id="Environment-replacement-ÁéØÂ¢ÉÊõ¥Êç¢"><a href="#Environment-replacement-ÁéØÂ¢ÉÊõ¥Êç¢" class="headerlink" title="Environment replacement (ÁéØÂ¢ÉÊõ¥Êç¢)"></a>Environment replacement (ÁéØÂ¢ÉÊõ¥Êç¢)</h2><p>ÁéØÂ¢ÉÂèòÈáèÔºà‰ΩøÁî® <code>ENV</code> ËØ≠Âè•Â£∞ÊòéÔºâ‰πüÂèØ‰ª•Âú®Êüê‰∫õÊåá‰ª§‰∏≠Áî®‰ΩúË¶ÅÁî± <code>Dockerfile</code> Ëß£ÈáäÁöÑÂèòÈáè</p>
<p>Ëøò‰ºöÂ§ÑÁêÜËΩ¨‰πâÊù•Â∞ÜÁ±ª‰ººÂèòÈáèÁöÑËØ≠Ê≥ïÂåÖÂê´Âú®ËØ≠Âè•Â≠óÈù¢Èáè‰∏≠</p>
<p>ÁéØÂ¢ÉÂèòÈáèÂú® <code>Dockerfile</code> ‰∏≠Áî® <code>$variable_name</code> Êàñ <code>$&#123;variable_name&#125;</code> Ë°®Á§∫</p>
<p>‰ΩøÁî® <code>\</code> ÂØπ $ ËøõË°åËΩ¨‰πâ</p>
<p><code>Dockerfile</code> ‰∏≠ÁöÑÂ¶Ç‰∏ãÊåá‰ª§ÊîØÊåÅÁéØÂ¢ÉÂèòÈáè:</p>
<ul>
<li><code>ADD</code></li>
<li><code>COPY</code></li>
<li><code>ENV</code></li>
<li><code>EXPOSE</code></li>
<li><code>FROM</code></li>
<li><code>LABEL</code></li>
<li><code>STOPSIGNAL</code></li>
<li><code>USER</code></li>
<li><code>VOLUME</code></li>
<li><code>WORKDIR</code></li>
<li><code>ONBUILD</code> (Âíå‰∏äÈù¢ÁöÑÊåá‰ª§ÁªìÂêàÁöÑÊó∂ÂÄô)</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> abc=hello</span><br><span class="line"><span class="keyword">ENV</span> abc=bye def=$abc</span><br><span class="line"><span class="keyword">ENV</span> ghi=$abc</span><br></pre></td></tr></table></figure>

<p><code>def</code> ÁöÑÂÄº‰∏∫ <code>hello</code>; <code>ghi</code> ÁöÑÂÄº‰∏∫ <code>bye</code>; Âõ†‰∏∫ÊØè‰∏ÄË°åÁöÑÊåá‰ª§ÊòØÂü∫‰∫é‰∏ä‰∏Ä‰∏™Êåá‰ª§ÁîüÊàêÁöÑÈïúÂÉèÁöÑ</p>
<h2 id="dockerignore-file-dockerignore-Êñá‰ª∂"><a href="#dockerignore-file-dockerignore-Êñá‰ª∂" class="headerlink" title=".dockerignore file (.dockerignore Êñá‰ª∂)"></a>.dockerignore file (<code>.dockerignore</code> Êñá‰ª∂)</h2><p>Âú® Docker CLI Â∞Ü‰∏ä‰∏ãÊñáÂèëÈÄÅÁªô Docker Daemon Ââç, Docker CLI Âú®‰∏ä‰∏ãÊñáÁöÑÊ†πÁõÆÂΩï‰∏≠ÂØªÊâæ‰∏Ä‰∏™ÂêçÁß∞‰∏∫ <code>.dockerignore</code> ÁöÑÊñá‰ª∂</p>
<p>Â¶ÇÊûúËøô‰∏™Êñá‰ª∂Â≠òÂú®, CLI Â∞Ü‰ºö‰øÆÊîπ‰∏ä‰∏ãÊñáÊù•ÊéíÈô§ÂåπÈÖçËøô‰∏™Êñá‰ª∂‰∏≠ÁöÑÊ®°ÂºèÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï</p>
<p>ËøôÈÅøÂÖç‰∫ÜÂ∞ÜÂæàÂ§ßÁöÑÊñá‰ª∂ÊàñËÄÖÊïèÊÑüÁöÑÊñá‰ª∂ÂèëÈÄÅÂà∞ Daemon ‰∏≠</p>
<p>Âπ∂‰∏îÈÅøÂÖç‰∫ÜÂú®‰ΩøÁî® <code>ADD</code> Êàñ <code>COPY</code> Êó∂ÊΩúÂú®Âú∞Ê∑ªÂä†Â§ßÊñá‰ª∂ÊàñÊïèÊÑüÊñá‰ª∂Âà∞ÈïúÂÉè‰∏≠</p>
<p>CLI Ëß£Êûê <code>.dockerignore</code> Êñá‰ª∂</p>
<p><code>.dockerignore</code> Êñá‰ª∂‰ΩøÁî®Êñ∞Ë°å‰Ωú‰∏∫Â§ö‰∏™Ê®°ÂºèÁöÑÂàÜÈöî</p>
<p>‰∏∫‰∫ÜËøõË°åÂåπÈÖç, ‰∏ä‰∏ãÊñáÁöÑÊ†π‰Ωú‰∏∫Â∑•‰ΩúÁõÆÂΩïÂíåÊ†πÁõÆÂΩï</p>
<p>‰æãÂ¶Ç, Ê®°Âºè <code>/foo/bar</code> Âíå <code>foo/bar</code> ÈÉΩ‰ºöÊéíÈô§ <code>PATH</code> ‰∏ã <code>foo</code> ÁõÆÂΩï‰∏≠ÁöÑÂêçÁß∞‰∏∫ <code>bar</code> ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï, ÊàñËÄÖÊòØÊéíÈô§‰Ωç‰∫é <code>URL</code> ÊåáÂêëÁöÑ Git ‰ªìÂ∫ìÁöÑÊ†π‰∏ãÁöÑ <code>foo</code> ÁõÆÂΩï‰∏≠ÁöÑ <code>bar</code> Êñá‰ª∂ÊàñÁõÆÂΩï</p>
<p><code>.dockerignore</code> Êñá‰ª∂‰∏≠Á¨¨‰∏ÄÂàó‰∏∫ <code>#</code> ÁöÑË°åË¢´ËÆ§‰∏∫ÊòØÊ≥®Èáä, ‰∏ç‰ºöË¢´ CLI Ëß£Êûê</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># comment</span><br><span class="line">*/temp*</span><br><span class="line">*/*/temp*</span><br><span class="line">temp?</span><br></pre></td></tr></table></figure>

<p>Table - Build behavior:</p>
<table>
<thead>
<tr>
<th align="left">Rule</th>
<th align="left">Behavior</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code># comment</code></td>
<td align="left">ÂøΩÁï•</td>
</tr>
<tr>
<td align="left"><code>*/temp*</code></td>
<td align="left">ÊéíÈô§Ê†π (root) ‰∏ãÁöÑ‰∏ÄÁ∫ßÂ≠êÁõÆÂΩï‰∏≠ÂêçÁß∞‰ª• <code>temp</code> ÂºÄÂ§¥ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï</td>
</tr>
<tr>
<td align="left"><code>*/*/temp*</code></td>
<td align="left">ÊéíÈô§Ê†π (root) ‰∏ãÁöÑ‰∫åÁ∫ßÂ≠êÁõÆÂΩï‰∏≠ÂêçÁß∞‰ª• <code>temp</code> ÂºÄÂ§¥ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï</td>
</tr>
<tr>
<td align="left"><code>temp?</code></td>
<td align="left">ÊéíÈô§Ê†π (root) ÁõÆÂΩï‰∏ãÊâÄÊúâÁöÑÂêçÂ≠ó‰ª• <code>temp</code> ÂºÄÂ§¥ÁÑ∂ÂêéÊé•‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï. ‰æãÂ¶Ç <code>/tempa</code>, <code>/tempb</code></td>
</tr>
</tbody></table>
<p>ÂåπÈÖç‰ΩøÁî® Go ËØ≠Ë®ÄÁöÑ <a class="link"   target="_blank" rel="noopener" href="https://golang.org/pkg/path/filepath#Match" >filepath.Match<i class="fas fa-external-link-alt"></i></a> ËßÑÂàô</p>
<p>‰∏Ä‰∏™È¢ÑÂ§ÑÁêÜÊ≠•È™§Âà†Èô§‰∫ÜÂ§¥Â∞æÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶, Âπ∂‰ΩøÁî® Go ËØ≠Ë®ÄÁöÑ <a class="link"   target="_blank" rel="noopener" href="https://golang.org/pkg/path/filepath/#Clean" >filepath.Clean<i class="fas fa-external-link-alt"></i></a> Ê∂àÈô§ <code>.</code> Âíå <code>..</code> ÂÖÉÁ¥†</p>
<p>Âú®È¢ÑÂ§ÑÁêÜÂêé, Á©∫ÁôΩË°åÂ∞Ü‰ºöË¢´ÂøΩÁï•</p>
<p>Docker ËøòÊîØÊåÅ‰ΩøÁî® <code>**</code> Êù•ÂåπÈÖç‰ªª‰ΩïÊï∞ÈáèÁöÑÁõÆÂΩï (ÂåÖÊã¨ 0 ‰∏™ÁõÆÂΩï). ‰æãÂ¶Ç <code>**/*.go</code> Â∞Ü‰ºöÊéíÈô§ÊâÄÊúâÁõÆÂΩï‰∏≠‰ª• <code>.go</code> ÁªìÂ∞æÁöÑÊâÄÊúâÊñá‰ª∂, Ê†πÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂‰πü‰ºöË¢´ÊéíÈô§</p>
<p>‰ª•Á¨¶Âè∑ <code>!</code> ÂºÄÂ§¥ÁöÑË°åÁî®Êù•Â£∞Êòé‰∏çË¶ÅËøõË°åÊéíÈô§ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï</p>
<p>Example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*.md</span><br><span class="line">!README.md</span><br></pre></td></tr></table></figure>

<p>Èô§‰∫Ü <code>README.md</code> Êñá‰ª∂‰πãÂ§ñÁöÑ‰ª• <code>.md</code> ÁªìÂ∞æÁöÑÊñá‰ª∂ÈÉΩ‰ºöË¢´ÊéíÈô§</p>
<p>‰Ω†ËøòÂèØ‰ª•‰ΩøÁî® <code>.dockerignore</code> Êñá‰ª∂Êù•ÊéíÈô§ <code>Dockerfile</code> Êñá‰ª∂Âíå <code>.dockerignore</code> Êñá‰ª∂. Ëøô‰∏§‰∏™Êñá‰ª∂‰ªçÁÑ∂‰ºöË¢´ÂèëÈÄÅÂà∞ Daemon, Âõ†‰∏∫ÈúÄË¶Å‰ΩøÁî®ÂÆÉ‰ª¨Êù•ËøõË°åÊûÑÂª∫. ‰ΩÜÊòØ <code>ADD</code> Âíå <code>COPY</code> Êåá‰ª§‰∏ç‰ºöÂ§çÂà∂ÂÆÉ‰ª¨Âà∞ÈïúÂÉè‰∏≠</p>
<p>Âõ†‰∏∫ÂéÜÂè≤ÂéüÂõ†, <code>.</code> Ê®°ÂºèË¢´ÂøΩÁï•‰∫Ü</p>
<h2 id="FROM-FROM-Êåá‰ª§"><a href="#FROM-FROM-Êåá‰ª§" class="headerlink" title="FROM (FROM Êåá‰ª§)"></a>FROM (FROM Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt; [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>

<p><code>FROM</code> Êåá‰ª§ÂàùÂßãÂåñ‰∏Ä‰∏™Êñ∞ÁöÑÊûÑÂª∫Èò∂ÊÆµ, ‰∏∫ÂêéÁª≠Êåá‰ª§ËÆæÁΩÆ<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/glossary/#base-image" >Âü∫Á°ÄÈïúÂÉè<i class="fas fa-external-link-alt"></i></a></p>
<p>Âõ†Ê≠§, ÊúâÊïàÁöÑ <code>Dockerfile</code> ÂøÖÈ°ª‰ª•‰∏Ä‰∏™ <code>FROM</code> Êåá‰ª§ÂºÄÂßã</p>
<p><code>iamge</code> ÂèØ‰ª•ÊòØ‰ªª‰ΩïÊúâÊïàÁöÑÈïúÂÉè, ÂèØ‰ª•ÁâπÂà´ÂÆπÊòìÂú∞‰ªé<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/docker-hub/repos/" >ÂÖ¨ÂºÄ‰ªìÂ∫ì<i class="fas fa-external-link-alt"></i></a> ÊãâÂèñ‰∏Ä‰∏™ÈïúÂÉèÊù•ÂºÄÂßã</p>
<p><code>ARG</code> ÊòØ <code>Dokcerfile</code> ‰∏≠ÂîØ‰∏ÄÂèØ‰ª•Âá∫Áé∞Âú® <code>FROM</code> ÂâçÈù¢ÁöÑÊåá‰ª§</p>
<p><code>FROM</code> ÂèØ‰ª•Âú®Âçï‰∏™ <code>Dockerfile</code> ‰∏≠Âá∫Áé∞Â§öÊ¨°Êù•ÂàõÂª∫Â§ö‰∏™ÈïúÂÉè, ÊàñËÄÖ‰ΩøÁî®‰∏Ä‰∏™ÊûÑÂª∫Èò∂ÊÆµ‰Ωú‰∏∫Âè¶‰∏Ä‰∏™ÊûÑÂª∫Èò∂ÊÆµÁöÑ‰æùËµñ</p>
<p>Âè™ÈúÄÂú®ÊØè‰∏™Êñ∞ÁöÑ <code>FROM</code> Êåá‰ª§‰πãÂâçËÆ∞ÂΩï Êèê‰∫§ÁöÑÊúÄÂêé‰∏Ä‰∏™ËæìÂá∫ÁöÑ ÈïúÂÉèID</p>
<p>ÊØè‰∏™ <code>FROM</code> Êåá‰ª§ÈÉΩ‰ºöÊ∏ÖÈô§ÂÖàÂâçÊåá‰ª§ÂàõÂª∫ÁöÑ‰ªª‰ΩïÁä∂ÊÄÅ</p>
<p>ÈÄöËøáÊ∑ªÂä† <code>AS name</code> Áªô <code>FROM</code> Êåá‰ª§, ÂèØ‰ª•ÂèØÈÄâÂú∞‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑÊûÑÂª∫Èò∂ÊÆµÊåáÂÆöÂêçÂ≠ó. Ëøô‰∏™ÂêçÂ≠óÂèØ‰ª•Âú®ÂêéÈù¢ÁöÑ <code>FROM</code> Âíå <code>COPY --from=&lt;name&gt;</code> Êåá‰ª§‰∏≠Áî®Êù•ÊåáÂêëËøô‰∏™Èò∂ÊÆµ‰∏≠ÊûÑÂª∫ÁöÑÈïúÂÉè</p>
<p><code>tag</code> Âíå <code>digest</code> ÂÄºÊòØÂèØÈÄâÁöÑ, Â¶ÇÊûúÈÉΩÊ≤°ÊúâÊåáÂÆöËøô‰∏§‰∏™ÂÄº, ÊûÑÂª∫Âô®ÈªòËÆ§‰ΩøÁî® <code>latest</code> Ê†áÁ≠æ. Â¶ÇÊûúÊûÑÂª∫Âô®Êâæ‰∏çÂà∞ <code>tag</code> ÂÄºÂ∞Ü‰ºöËøîÂõûËøîÂõû‰∏Ä‰∏™ÈîôËØØ</p>
<p>Â¶ÇÊûú <code>FROM</code> ÂºïÁî®Â§öÂπ≥Âè∞ÈïúÂÉèÔºåÂèØÈÄâÁöÑ <code>--platform</code> Ê†áÂøóÂèØÁî®‰∫éÊåáÂÆöÈïúÂÉèÁöÑÂπ≥Âè∞. ‰æãÂ¶Ç <code>linux/amd64</code>, <code>linux/arm64</code>, <code>windows/amd64</code></p>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰ΩøÁî®ÊûÑÂª∫ËØ∑Ê±ÇÁöÑÁõÆÊ†áÂπ≥Âè∞</p>
<p>ÂÖ®Â±ÄÊûÑÂª∫ÂèÇÊï∞ÂèØ‰ª•Áî®‰∫é <code>--platform</code> Ê†áÂøóÁöÑÂÄº, ‰æãÂ¶Ç <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#automatic-platform-args-in-the-global-scope" >Ëá™Âä®ÁöÑÂπ≥Âè∞ ARGs<i class="fas fa-external-link-alt"></i></a> ÂÖÅËÆ∏‰Ω†Âº∫Âà∂Èò∂ÊÆµ‰∏∫ÂΩìÊú¨Âú∞ÊûÑÂª∫Âπ≥Âè∞ (<code>--platform=$BUILDPLATFORM</code>), Âπ∂‰ΩøÁî®ÂÆÉ‰∫§ÂèâÁºñËØëÂà∞Èò∂ÊÆµÂÜÖÁöÑÁõÆÊ†áÂπ≥Âè∞</p>
<h3 id="Understanding-how-ARG-and-FROM-interact-ÁêÜËß£-ARG-Âíå-FROM-ÊÄéÊ†∑‰∫§‰∫í"><a href="#Understanding-how-ARG-and-FROM-interact-ÁêÜËß£-ARG-Âíå-FROM-ÊÄéÊ†∑‰∫§‰∫í" class="headerlink" title="Understanding how ARG and FROM interact (ÁêÜËß£ ARG Âíå FROM ÊÄéÊ†∑‰∫§‰∫í)"></a>Understanding how ARG and FROM interact (ÁêÜËß£ ARG Âíå FROM ÊÄéÊ†∑‰∫§‰∫í)</h3><p><code>FROM</code> Êåá‰ª§ÊîØÊåÅ‰ªª‰ΩïÈÄöËøá <code>ARG</code> Êåá‰ª§Â£∞ÊòéÁöÑÂèòÈáè, <code>ARG</code> Êåá‰ª§Âá∫Áé∞Âú®Á¨¨‰∏Ä‰∏™ <code>FROM</code> Êåá‰ª§‰πãÂâç</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> CODE_VERSION=latest</span><br><span class="line"><span class="keyword">FROM</span> base:$&#123;CODE_VERSION&#125;</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /code/run-app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> extras:$&#123;CODE_VERSION&#125;</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /code/run-extras</span></span><br></pre></td></tr></table></figure>

<p>Âú® <code>FROM</code> Êåá‰ª§‰πãÂâçÂ£∞ÊòéÁöÑ <code>ARG</code> Êåá‰ª§Âú®ÊûÑÂª∫Èò∂ÊÆµ‰πãÂ§ñ, ÊâÄ‰ª•ÂÆÉ‰∏çËÉΩÂú® <code>FROM</code> Êåá‰ª§‰πãÂêéÁöÑ‰ªª‰ΩïÊåá‰ª§‰∏≠‰ΩøÁî®</p>
<p>Ë¶Å‰ΩøÁî®Âú®Á¨¨‰∏Ä‰∏™ <code>FROM</code> ‰πãÂâçÂ£∞ÊòéÁöÑ <code>ARG</code> ÁöÑÈªòËÆ§ÂÄºÔºåËØ∑‰ΩøÁî®Âú®ÊûÑÂª∫Èò∂ÊÆµÂÜÖÊ≤°ÊúâÂÄºÁöÑ <code>ARG</code> Êåá‰ª§:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> VERSION=latest</span><br><span class="line"><span class="keyword">FROM</span> busybos:$VERSION</span><br><span class="line"><span class="keyword">ARG</span> VERSION</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$VERSION</span> &gt; image_version</span></span><br></pre></td></tr></table></figure>

<h2 id="RUN-RUN-Êåá‰ª§"><a href="#RUN-RUN-Êåá‰ª§" class="headerlink" title="RUN (RUN Êåá‰ª§)"></a>RUN (RUN Êåá‰ª§)</h2><p><code>RUN</code> Êåá‰ª§Êúâ‰∏§ÁßçÂΩ¢Âºè:</p>
<ul>
<li><code>RUN &lt;command&gt;</code> (<strong>shell</strong>ÂΩ¢Âºè, ÂëΩ‰ª§ÊòØÂú®‰∏Ä‰∏™ shell ‰∏≠ËøêË°åÁöÑ, Âú® Linux ‰∏äÈªòËÆ§ÊòØ <code>/bin/sh -c</code>, Âú® Windows ‰∏äÈªòËÆ§ÊòØ <code>cmd /S /C</code>)</li>
<li><code>RUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</code> (<strong>exec</strong>ÂΩ¢Âºè)</li>
</ul>
<p><code>RUN</code> Êåá‰ª§Â∞Ü‰ºöÂú®ÂΩìÂâçÈïúÂÉè‰πã‰∏äÁöÑÊñ∞Â±Ç‰∏≠ÊâßË°å‰ªª‰ΩïÂëΩ‰ª§Âπ∂Êèê‰∫§ÁªìÊûú. Êèê‰∫§ÁöÑÁªìÊûúÈïúÂÉèÂ∞ÜÁî®‰∫é <code>Dockerfile</code> ‰∏≠ÁöÑ‰∏ã‰∏ÄÊ≠•</p>
<p>Â∞Ü <code>RUN</code> Êåá‰ª§ÂàÜÂ±ÇÂπ∂ÁîüÊàêÊèê‰∫§ Á¨¶Âêà Docker ÁöÑÊ†∏ÂøÉÊ¶ÇÂøµ, ÂÖ∂‰∏≠Êèê‰∫§ÈùûÂ∏∏Âªâ‰ª∑, Âπ∂‰∏îÂèØ‰ª•‰ªéÈïúÂÉèÂéÜÂè≤ÁöÑ‰ªª‰ΩïÁÇπÂàõÂª∫ÂÆπÂô®, Â∞±ÂÉèÊ∫ê‰ª£Á†ÅÊéßÂà∂‰∏ÄÊ†∑</p>
<p><code>exec</code> ÂΩ¢ÂºèÂèØ‰ª•ÈÅøÂÖç shell Â≠óÁ¨¶‰∏≤Â§ÑÁêÜ, Âπ∂‰ΩøÁî®‰∏çÂåÖÂê´ÊåáÂÆö shell ÊâßË°åÊñá‰ª∂ÁöÑÂü∫Á°ÄÈïúÂÉè <code>RUN</code> ÂëΩ‰ª§</p>
<p>ÂèØ‰ª•‰ΩøÁî® <code>SHELL</code> Êåá‰ª§Êù•‰∏∫ <code>shell</code> ÂΩ¢ÂºèÊîπÂèòÈªòËÆ§ÁöÑ shell</p>
<p>Âú® <code>shell</code> ÂΩ¢Âºè‰∏≠‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>\</code> Êù•Â∞Ü‰∏Ä‰∏™ <code>RUN</code> Êåá‰ª§Êç¢Ë°åÂà∞‰∏ã‰∏ÄË°å:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> /bin/bash -c <span class="string">&#x27;source $HOME/.bashrc; \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">echo $HOME&#x27;</span></span></span><br></pre></td></tr></table></figure>

<p>Ë¶Å‰ΩøÁî®‰∏çÂêåÁöÑ shell, ËÄå‰∏çÊòØ <code>/bin/sh</code>, Âú® <code>exec</code> ÂΩ¢Âºè‰∏≠‰º†ÂÖ•ÊÉ≥Ë¶ÅÁöÑ shell:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> [<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo hello&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p><code>exec</code> ÂΩ¢ÂºèË¢´Ëß£Êûê‰∏∫‰∏Ä‰∏™ JSON Êï∞ÁªÑ, ÊÑèÂë≥ÁùÄ‰Ω†ÂøÖÈ°ª‰ΩøÁî®ÂèåÂºïÂè∑ <code>&quot;</code> Êù•ÂåÖÂõ¥ËØçËØ≠, ‰∏çË¶Å‰ΩøÁî®ÂçïÂºïÂè∑</p>
<p>‰∏çÂÉè <code>shell</code> ÂΩ¢Âºè, <code>exec</code> ÂΩ¢Âºè‰∏ç‰ºöË∞ÉÁî®‰∏Ä‰∏™ÂëΩ‰ª§ shell. ËøôÊÑèÂë≥ÁùÄ‰∏ç‰ºöÂèëÁîüÊ≠£Â∏∏ÁöÑ shell Â§ÑÁêÜ. ‰æãÂ¶Ç, <code>RUN [ &quot;echo&quot;, &quot;$HOME&quot; ]</code> Â∞Ü‰∏ç‰ºöÂú® <code>$HOME</code> ‰∏äÂÅöÂèòÈáèÊõøÊç¢. Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶Å shell Â§ÑÁêÜ, ÈÇ£‰πàÂèØ‰ª•‰ΩøÁî® <code>shell</code> ÂΩ¢Âºè, ÊàñËÄÖÁõ¥Êé•ÊâßË°å‰∏Ä‰∏™ shell ‰æãÂ¶Ç: <code>RUN [ &quot;sh&quot;, &quot;-c&quot;, &quot;echo $HOME&quot; ]</code>. ÂΩì‰ΩøÁî® <code>exec</code> ÂΩ¢ÂºèÂπ∂Áõ¥Êé•ÊâßË°å‰∏Ä‰∏™ shell Êó∂, Âíå‰ΩøÁî® <code>shell</code> ÂΩ¢Âºè‰∏ÄÊ†∑, ÊòØ shell Êù•Â§ÑÁêÜÁéØÂ¢ÉÂèòÈáèÊâ©Â±ï, ËÄå‰∏çÊòØ Docker</p>
<p>Âú® <code>JSON</code> ÂΩ¢Âºè‰∏≠ÊúâÂøÖË¶ÅËøõË°åÂèçÊñúÁ∫øËΩ¨‰πâ. ËøôÂú®ÂèçÊñúÊù†ÊòØË∑ØÂæÑÂàÜÈöîÁ¨¶ÁöÑ Windows ‰∏äÂ∞§‰∏∫ÈáçË¶Å:</p>
<p>ÈîôËØØ: <code>RUN [&quot;c:\windows\system32\tasklist.exe&quot;]</code></p>
<p>Ê≠£Á°Æ: <code>RUN [&quot;c:\\windows\\system32\\tasklist.exe&quot;]</code></p>
<p><code>RUN</code> Êåá‰ª§ÁöÑÁºìÂ≠ò‰∏ç‰ºöÂú®‰∏ã‰∏ÄÊ¨°ÊûÑÂª∫ÊúüÈó¥Ëá™Âä®Â§±Êïà</p>
<p>ÂÉè <code>RUN apt-get dist-upgrade -y</code> ËøôÊ†∑ÁöÑÊåá‰ª§ÁöÑÁºìÂ≠òÂú®‰∏ãÊ¨°ÊûÑÂª∫ÊúüÈó¥‰ºöË¢´ÈáçÊñ∞‰ΩøÁî®</p>
<p><code>RUN</code> Êåá‰ª§ÁöÑÁºìÂ≠òÂèØ‰ª•ÈÄöËøá‰ΩøÁî® <code>--no-cache</code> Ê†áÂøóÊù•Êó†ÊïàÂåñ, ‰æãÂ¶Ç <code>docker build --no-cache</code></p>
<p>Êü•Áúã <code>Dockerfile</code> <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" >ÊúÄ‰Ω≥ÂÆûË∑µ<i class="fas fa-external-link-alt"></i></a> Ëé∑ÂèñÊõ¥Â§ö‰ø°ÊÅØ</p>
<p>ÂèØ‰ª•ÈÄöËøá <code>ADD</code> Âíå <code>COPY</code> Êåá‰ª§Êù•‰Ωø <code>RUN</code> Êåá‰ª§ÁöÑÁºìÂ≠òÊó†Êïà</p>
<h3 id="Know-issues-RUN-RUN-Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò"><a href="#Know-issues-RUN-RUN-Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò" class="headerlink" title="Know issues (RUN) (RUN Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò)"></a>Know issues (RUN) (RUN Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò)</h3><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/docker/docker/issues/783" >ÈóÆÈ¢ò 783<i class="fas fa-external-link-alt"></i></a> ÊòØÂÖ≥‰∫éÊñá‰ª∂ÊùÉÈôêÁöÑÈóÆÈ¢ò, Ëøô‰∏™ÈóÆÈ¢ò‰ºöÂú®‰ΩøÁî® AUFS Êñá‰ª∂Á≥ªÁªüÊó∂Âá∫Áé∞. Â∞ùËØï <code>rm</code> ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÂèØ‰ª•Ê≥®ÊÑèÂà∞Ëøô‰∏™ÈóÆÈ¢ò</p>
<h2 id="CMD-CMD-Êåá‰ª§"><a href="#CMD-CMD-Êåá‰ª§" class="headerlink" title="CMD (CMD Êåá‰ª§)"></a>CMD (CMD Êåá‰ª§)</h2><p><code>CMD</code> Êåá‰ª§Êúâ‰∏âÁßçÂΩ¢Âºè:</p>
<ul>
<li><code>CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]</code> (<code>exec</code> ÂΩ¢Âºè, Êé®Ëçê‰ΩøÁî®ËøôÁßçÂΩ¢Âºè)</li>
<li><code>CMD [&quot;param1&quot;,&quot;param2&quot;]</code> (‰Ωú‰∏∫ <code>ENTRYPOINT</code> ÁöÑÈªòËÆ§ÂèÇÊï∞)</li>
<li><code>CMD command param1 param2</code> (<code>shell</code> ÂΩ¢Âºè)</li>
</ul>
<p>Âú® <code>Dockerfile</code> ‰∏≠Âè™ËÉΩÊúâ‰∏Ä‰∏™ <code>CMD</code> Êåá‰ª§. Â¶ÇÊûú‰Ω†ÊåáÂÆö‰∫ÜË∂ÖËøá 1 ‰∏™ <code>CMD</code> Êåá‰ª§, ÈÇ£‰πàÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™ <code>CMD</code> Êåá‰ª§ÁîüÊïà</p>
<p><code>CMD</code> Êåá‰ª§ÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØ‰∏∫Ê≠£Âú®ÊâßË°åÁöÑÂÆπÂô®Êèê‰æõÈªòËÆ§ÂÄº</p>
<p>Ëøô‰∫õÈªòËÆ§ÂÄº<strong>ÂèØ‰ª•</strong>ÂåÖÊã¨ÂèØÊâßË°åÊñá‰ª∂. ‰πüÂèØ‰ª•ÁúÅÁï•ÂèØÊâßË°åÊñá‰ª∂, Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, ‰Ω†ÂøÖÈ°ªÊåáÂÆö <code>ENTRYPOINT</code> Êåá‰ª§</p>
<p>Â¶ÇÊûú <code>CMD</code> Êåá‰ª§Áî®Êù•‰∏∫ <code>ENTRYPOINT</code> Êåá‰ª§Êèê‰æõÈªòËÆ§ÂèÇÊï∞, ÈÇ£‰πà <code>CMD</code> Êåá‰ª§Âíå <code>ENTRYPOINT</code> Êåá‰ª§ÈÉΩË¶Å‰ΩøÁî® JSON Êï∞ÁªÑÊ†ºÂºèÊù•ÊåáÂÆö</p>
<p><code>CMD</code> Êåá‰ª§ÁöÑ <code>exec</code> ÂΩ¢Âºè‰Ωú‰∏∫ JSON Êï∞ÁªÑË¢´Ëß£Êûê, ËøôÊÑèÂë≥ÁùÄ‰Ω†ÂøÖÈ°ª‰ΩøÁî®ÂèåÂºïÂè∑Êù•ÂåÖË£πÂÜÖÂÆπ</p>
<p>‰∏çÂÉè <code>shell</code> ÂΩ¢Âºè, <code>exec</code> ÂΩ¢Âºè‰∏ç‰ºöË∞ÉÁî®‰∏Ä‰∏™ÂëΩ‰ª§ shell. ËøôÊÑèÂë≥ÁùÄ‰∏ç‰ºöÂèëÁîüÊ≠£Â∏∏ÁöÑ shell Â§ÑÁêÜ</p>
<p>‰æãÂ¶Ç <code>CMD [ &quot;echo&quot;, &quot;$HOME&quot; ]</code> Â∞Ü‰∏ç‰ºöÂú® <code>$HOME</code> ‰∏äÊâßË°åÂèòÈáèÊõøÊç¢</p>
<p>Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶Å <code>shell</code> Â§ÑÁêÜ, Ë¶Å‰πà‰ΩøÁî® <code>shell</code> ÂΩ¢Âºè, Ë¶Å‰πàÁõ¥Êé•ÊâßË°å shell, ÂÉèËøôÊ†∑: <code>CMD [ &quot;sh&quot;, &quot;-c&quot;, &quot;echo $HOME&quot; ]</code></p>
<p>ÂΩì‰ΩøÁî® <code>exec</code> ÂΩ¢Âºè‰∏îÁõ¥Êé•ÊâßË°å‰∏Ä‰∏™ shell, Ê≠£Â¶ÇÂú® <code>shell</code> ÂΩ¢Âºè‰∏≠ÈÇ£Ê†∑, Â∞Ü‰ºöÊòØÁî± shell ËÄå‰∏çÊòØ Docker Êù•ÊâßË°åÁéØÂ¢ÉÂèòÈáèÊâ©Â±ï</p>
<p>ÂΩì‰ΩøÁî® <code>shell</code> Êàñ <code>exec</code> Ê†ºÂºèÊó∂, <code>CMD</code> Êåá‰ª§ËÆæÁΩÆ‰∫ÜÂú®ËøêË°åÈïúÂÉèÊó∂ÊâßË°åÁöÑÂëΩ‰ª§</p>
<p>Â¶ÇÊûú‰Ω†‰ΩøÁî® <code>CMD</code> Êåá‰ª§ÁöÑ <code>shell</code> ÂΩ¢Âºè, ÈÇ£‰πà <code>&lt;command&gt;</code> Â∞Ü‰ºöÂú® <code>/bin/sh -c</code> ‰∏≠ÊâßË°å:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;This is a test.&quot;</span> | <span class="built_in">wc</span> -</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶ÅÂú®Ê≤°Êúâ shell ÊÉÖÂÜµ‰∏ãËøêË°å <code>&lt;command&gt;</code>, ÂàôÂøÖÈ°ªÂ∞ÜÂëΩ‰ª§Ë°®Á§∫‰∏∫ JSON Êï∞ÁªÑÂπ∂Êèê‰æõÂèØÊâßË°åÊñá‰ª∂ÁöÑÂÆåÊï¥Ë∑ØÂæÑ</p>
<p><strong>ËøôÁßçÊï∞ÁªÑÂΩ¢ÂºèÊòØ <code>CMD</code> Êåá‰ª§ÁöÑÈ¶ñÈÄâÊ†ºÂºè</strong></p>
<p>ÊâÄÊúâÈ¢ùÂ§ñÂèÇÊï∞Âú®Êï∞ÁªÑ‰∏≠ÂøÖÈ°ªË°®Ëææ‰∏∫Â≠óÁ¨¶‰∏≤:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;/usr/bin/wc&quot;</span>, <span class="string">&quot;--help&quot;</span> ]</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶Å‰Ω†ÁöÑÂÆπÂô®<strong>ÊØèÊ¨°</strong>ÈÉΩËøêË°å<strong>Áõ∏ÂêåÁöÑ</strong>ÂèØÊâßË°åÊñá‰ª∂, ÈÇ£‰πàÂèØ‰ª•ÁªìÂêà‰ΩøÁî® <code>CMD</code> Êåá‰ª§Âíå <code>ENTRYPOINT</code> Êåá‰ª§</p>
<p>Â¶ÇÊûúÁî®Êà∑Âú® <code>docker run</code> ‰∏≠ÊåáÂÆöÁöÑÂèÇÊï∞, ÈÇ£‰πàËøô‰∫õÂèÇÊï∞Â∞Ü‰ºöË¶ÜÁõñ <code>CMD</code> Êåá‰ª§‰∏≠ÊåáÂÆöÁöÑÈªòËÆ§ÂÄº</p>
<p>Note: ‰∏çË¶ÅÊ∑∑Ê∑Ü <code>RUN</code> Âíå <code>CMD</code> Êåá‰ª§. <code>RUN</code> Êåá‰ª§ÂÆûÈôÖËøêË°å‰∏Ä‰∏™ÂëΩ‰ª§Âπ∂Êèê‰∫§ÁªìÊûú; <code>CMD</code> Êåá‰ª§Âú®ÊûÑÂª∫Êó∂Ê≤°ÊúâÊâßË°å‰ªª‰Ωï‰∏úË•ø, ‰ΩÜÊòØÊåáÂÆö‰∫ÜÈïúÂÉèÁöÑÈ¢ÑÊúü (intended) ÂëΩ‰ª§</p>
<h2 id="LABEL-LABEL-Êåá‰ª§"><a href="#LABEL-LABEL-Êåá‰ª§" class="headerlink" title="LABEL (LABEL Êåá‰ª§)"></a>LABEL (LABEL Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span></span><br></pre></td></tr></table></figure>

<p><code>LABEL</code> Êåá‰ª§‰∏∫ÈïúÂÉèÊ∑ªÂä†ÂÖÉÊï∞ÊçÆ</p>
<p>‰∏Ä‰∏™ <code>LABEL</code> ÊòØ‰∏Ä‰∏™ÈîÆÂÄºÂØπ</p>
<p>Ë¶ÅÂú® <code>LABEL</code> ÂÄº‰∏≠ÂåÖÂê´Á©∫Ê†º, ËØ∑ÂÉèÂú®ÂëΩ‰ª§Ë°åËß£Êûê‰∏≠‰∏ÄÊ†∑‰ΩøÁî®ÂºïÂè∑ÂíåÂèçÊñúÁ∫ø</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> <span class="string">&quot;com.example.vendor&quot;</span>=<span class="string">&quot;ACME Incorporated&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> com.example.label-with-avlue=<span class="string">&quot;foo&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> version=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> describes=<span class="string">&quot;This is text illustrates \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">that label-values can span multiple lines.&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>‰∏Ä‰∏™ÈïúÂÉèÂèØ‰ª•ÊúâÂ§ö‰∏™ label</p>
<p>ÂèØ‰ª•Âú®ÂçïÁã¨‰∏ÄË°å‰∏≠ÊåáÂÆöÂ§ö‰∏™ label. Âú® Docker 1.10 ÁâàÊú¨‰πãÂâç, ËøôÂèØ‰ª•ÂáèÂ∞ëÊúÄÁªàÁöÑÈïúÂÉèÂ§ßÂ∞è, ‰ΩÜÊòØÁé∞Âú®‰∏çÊòØËøôÊ†∑Â≠ê‰∫Ü</p>
<p>‰Ω†‰πüËøòÂèØ‰ª•ÈÄâÊã©Âú®ÂçïÁã¨‰∏ÄË°å‰∏≠Áü•ÈÅìÊåáÂÆöÂ§ö‰∏™ label, ‰ΩøÁî®Â¶Ç‰∏ã‰∏§ÁßçÊñπÂºè:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> multi.label1=<span class="string">&quot;value1&quot;</span> multi.label2=<span class="string">&quot;value2&quot;</span> other=<span class="string">&quot;value3&quot;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> multi.label1=<span class="string">&quot;value1&quot;</span> \</span></span><br><span class="line"><span class="language-bash">      multi.label2=<span class="string">&quot;value2&quot;</span> \</span></span><br><span class="line"><span class="language-bash">      other=<span class="string">&quot;value3&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>Âü∫Á°ÄÈïúÂÉèÊàñÁà∂ÈïúÂÉè (<code>FROM</code> Ë°å‰∏≠ÁöÑÈïúÂÉè) ‰∏≠ÂåÖÂê´ÁöÑ labels Áî±‰Ω†ÁöÑÈïúÂÉèËøõË°åÁªßÊâø</p>
<p>Â¶ÇÊûú label Â∑≤ÁªèÂ≠òÂú®‰ΩÜÂÖ∑Êúâ‰∏çÂêåÁöÑÂÄº, ÈÇ£‰πàÊúÄËøëÂ∫îÁî®ÁöÑÂÄºÂ∞ÜË¶ÜÁõñ‰ªª‰Ωï‰πãÂâçËÆæÁΩÆÁöÑÂÄº</p>
<p>Ë¶ÅÊü•ÁúãÈïúÂÉèÁöÑ labels, ‰ΩøÁî® <code>docker image inspect</code> ÂëΩ‰ª§. ÂèØ‰ª•‰ΩøÁî® <code>--format</code> ÈÄâÈ°πÊù•Â£∞Êòé‰ªÖÂ±ïÁ§∫ labels:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker image inspect --format=<span class="string">&#x27;&#x27;</span> myimage</span><br></pre></td></tr></table></figure>

<h2 id="MAINTAINER-deprecated-MAINTAINER-Êåá‰ª§-Â∑≤ËøáÊó∂"><a href="#MAINTAINER-deprecated-MAINTAINER-Êåá‰ª§-Â∑≤ËøáÊó∂" class="headerlink" title="MAINTAINER (deprecated) (MAINTAINER Êåá‰ª§ Â∑≤ËøáÊó∂)"></a>MAINTAINER (deprecated) (MAINTAINER Êåá‰ª§ Â∑≤ËøáÊó∂)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MAINTAINER</span> &lt;name&gt;</span><br></pre></td></tr></table></figure>

<p><code>MAINTAINER</code> Êåá‰ª§Áî®Êù•ËÆæÁΩÆÂàõÂª∫ÈïúÂÉèÁöÑ‰ΩúËÄÖÂ≠óÊÆµ</p>
<p>‰ΩøÁî® <code>LABEL</code> Êåá‰ª§Êù•‰ª£Êõø <code>MAINTAINER</code> Êåá‰ª§: <code>LABEL org.opencontainers.image.authors=&quot;SvenDowideit@home.org.au&quot;</code></p>
<h2 id="EXPOSE-EXPOSE-Êåá‰ª§"><a href="#EXPOSE-EXPOSE-Êåá‰ª§" class="headerlink" title="EXPOSE (EXPOSE Êåá‰ª§)"></a>EXPOSE (EXPOSE Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPOSE</span> &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span><br></pre></td></tr></table></figure>

<p><code>EXPOSE</code> Êåá‰ª§ÈÄöÁü• Docker, ÂÆπÂô®Ë¶ÅÂú®ËøêË°åÊó∂ÁõëÂê¨ÊåáÂÆöÁöÑÁΩëÁªúÁ´ØÂè£</p>
<p>‰Ω†ÂèØ‰ª•ÊåáÂÆöÁ´ØÂè£ÊòØÁõëÂê¨Âú® TCP ËøòÊòØ UDP ‰∏ä, Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÂçèËÆÆÈÇ£‰πàÈªòËÆ§ÊòØ TCP</p>
<p><code>EXPOSE</code> Êåá‰ª§ÂÆûÈôÖ‰∏äÂπ∂Ê≤°ÊúâÂèëÂ∏É (publish) Á´ØÂè£</p>
<p><code>EXPOSE</code> Êåá‰ª§ÂÖÖÂΩì ÊûÑÂª∫ÈïúÂÉèÁöÑ‰∫∫ Âíå ËøêË°åÂÆπÂô®ÁöÑ‰∫∫ ‰πãÈó¥ÁöÑ‰∏ÄÁßçÊñáÊ°£, ÂÖ≥‰∫é<strong>ÊâìÁÆó</strong>ÂèëÂ∏É (publish) Âì™‰∫õÁ´ØÂè£ÁöÑÊñáÊ°£</p>
<p>Ë¶ÅÂú®ËøêË°åÂÆπÂô®Êó∂ÂÆûÈôÖ‰∏äÂèëÂ∏ÉÁ´ØÂè£, Âú® <code>docker run</code> ÂëΩ‰ª§‰∏ä‰ΩøÁî® <code>-p</code> Ê†áÂøóÊù•ÂèëÂ∏ÉÂπ∂Êò†Â∞Ñ‰∏ÄÂà∞Â§ö‰∏™Á´ØÂè£, ÊàñËÄÖ‰ΩøÁî® <code>-P</code> Ê†áÂøóÊù•ÂèëÂ∏ÉÊâÄÊúâÊö¥Èú≤ÁöÑ (exposed) Á´ØÂè£Âπ∂Â∞ÜÂÆÉ‰ª¨Êò†Â∞ÑÂà∞È´òÈò∂Á´ØÂè£ (high-order ports)</p>
<p>ÈªòËÆ§Âú∞, <code>EXPOSE</code> Êåá‰ª§ÂÅáÂÆö‰ΩøÁî® TCP. ‰Ω†ËøòÂèØ‰ª•ÊåáÂÆö UDP:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span>/udp</span><br></pre></td></tr></table></figure>

<p>Ë¶ÅÂêåÊó∂Êö¥Èú≤ TCP Âíå UDP, ÈÇ£‰πàÂåÖÂê´‰∏§Ë°å:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span>/tcp</span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span>/udp</span><br></pre></td></tr></table></figure>

<p>Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, Â¶ÇÊûú‰Ω†Â∞Ü <code>-P</code> Âíå <code>docker run</code> ‰∏ÄËµ∑‰ΩøÁî®, Ëøô‰∏™Á´ØÂè£Â∞Ü‰∏∫ TCP Êö¥Èú≤‰∏ÄÊ¨°, ‰∏∫ UDP Êö¥Èú≤‰∏ÄÊ¨°. ËÆ∞‰Ωè, <code>-P</code> ‰ΩøÁî®‰ΩøÁî®‰∏ªÊú∫‰∏äÁöÑ‰∏¥Êó∂È´òÈò∂‰∏ªÊú∫Á´ØÂè£ (high-ordered host port), ÊâÄ‰ª• TCP Âíå UDP ÁöÑÁ´ØÂè£Â∞Ü‰ºö‰∏çÂêå</p>
<p><code>-P</code> Ê†áÂøóÂ∞ÜÂÆπÂô®‰∏≠ÊâÄÊúâÊö¥Èú≤ÁöÑÁ´ØÂè£Êò†Â∞ÑÂà∞ÂÆø‰∏ªÊú∫‰∏äÁöÑÈöèÊú∫Á´ØÂè£</p>
<p>‰∏çÁÆ° <code>EXPOSE</code> Â¶Ç‰ΩïËÆæÁΩÆ, ‰Ω†ÂèØ‰ª•Âú®ËøêË°åÊó∂‰ΩøÁî® <code>-p</code> Ê†áÂøóÊù•Ë¶ÜÁõñÂÆÉ‰ª¨:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -p 80:80/tcp -p 80:80/udp</span><br></pre></td></tr></table></figure>

<p>Ë¶ÅÂú®‰∏ªÊú∫Á≥ªÁªü‰∏äËÆæÁΩÆÁ´ØÂè£ÈáçÂÆöÂêë, Êü•Áúã<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/run/#expose-incoming-ports">‰ΩøÁî® <code>-P</code> Ê†áÂøó</a></p>
<p><code>docker network</code> ÂëΩ‰ª§ÊîØÊåÅ‰∏∫ÂÆπÂô®‰πãÈó¥ÁöÑÈÄö‰ø°ÂàõÂª∫ÁΩëÁªú, ËÄåÊó†ÈúÄÊö¥Èú≤ÊàñÂèëÂ∏ÉÁâπÂÆöÁ´ØÂè£, Âõ†‰∏∫ËøûÊé•Âà∞ÁΩëÁªúÁöÑÂÆπÂô®ÂèØ‰ª•ÈÄöËøá‰ªª‰ΩïÁ´ØÂè£‰∫íÁõ∏ÈÄö‰ø°. Êõ¥ËØ¶ÁªÜÁöÑ‰ø°ÊÅØËØ∑Êü•Áúã<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/networking/" >Ëøô‰∏™ÂäüËÉΩ<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="ENV-ENV-Êåá‰ª§"><a href="#ENV-ENV-Êåá‰ª§" class="headerlink" title="ENV (ENV Êåá‰ª§)"></a>ENV (ENV Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> &lt;key&gt;=&lt;value&gt; ...</span><br></pre></td></tr></table></figure>

<p><code>ENV</code> Êåá‰ª§ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè <code>&lt;key&gt;</code> ÁöÑÂÄº‰∏∫ <code>&lt;value&gt;</code></p>
<p>ËØ•ÂÄºÂ∞ÜÂú®ÊûÑÂª∫Èò∂ÊÆµÁöÑÊâÄÊúâÂêéÁª≠Êåá‰ª§ÁöÑÁéØÂ¢É‰∏≠, ‰πüÂèØ‰ª•Âú®ËÆ∏Â§öÊåá‰ª§‰∏≠<a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#environment-replacement" >ÂÜÖËÅîÊõøÊç¢<i class="fas fa-external-link-alt"></i></a></p>
<p>ËØ•ÂÄºÂ∞Ü‰ºöË¢´Ëß£Êûê‰∏∫ÂÖ∂‰ªñÁéØÂ¢ÉÂèòÈáè, ÊâÄ‰ª•Â¶ÇÊûúÂºïÂè∑Â≠óÁ¨¶Ê≤°ÊúâË¢´ËΩ¨‰πâ, ÈÇ£‰πàÂºïÂè∑Â≠óÁ¨¶Â∞Ü‰ºöË¢´Âà†Èô§</p>
<p>‰∏éÂëΩ‰ª§Ë°åËß£Êûê‰∏ÄÊ†∑, ÂºïÂè∑ÂíåÂèçÊñúÁ∫øÂèØ‰ª•Áî®Êù•Âú®ÂÄº‰∏≠ÂåÖÂê´Á©∫Ê†º</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> MY_NAME=<span class="string">&quot;John Doe&quot;</span></span><br><span class="line"><span class="keyword">ENV</span> MY_DOG=Rex\ The\ Dog <span class="comment"># ‰ΩøÁî®ÂèçÊñúÁ∫øÊù•ÂØπÁ©∫Ê†ºËΩ¨‰πâ</span></span><br><span class="line"><span class="keyword">ENV</span> MY_CAT=fluffy</span><br></pre></td></tr></table></figure>

<p><code>ENV</code> Êåá‰ª§ÂÖÅËÆ∏ÂêåÊó∂ËÆæÁΩÆÂ§ö‰∏™ <code>&lt;key&gt;=&lt;value&gt;</code> ÂèòÈáè, ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂ∞Ü‰ºöÂú®ÊúÄÁªàÈïúÂÉè‰∏≠‰∫ßÁîüÁõ∏ÂêåÁöÑÊúÄÁªàÁªìÊûú:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> MY_NAME=<span class="string">&quot;John Doe&quot;</span> MY_DOG=Rex\ The\ Dog \</span><br><span class="line">    MY_CAT=fluffy</span><br></pre></td></tr></table></figure>

<p>‰ΩøÁî® <code>ENV</code> ËÆæÁΩÆÁöÑÁéØÂ¢ÉÂèòÈáèÂ∞ÜÊåÅÁª≠Âà∞ÂÆπÂô®‰ªéÁªìÊûúÈïúÂÉè‰∏≠ËøêË°åÁöÑÊó∂ÂÄô. ‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>docker inspect</code> ÂëΩ‰ª§Êù•Êü•ÁúãËøô‰∫õÁéØÂ¢ÉÂèòÈáèÂÄº. ÂèØ‰ª•‰ΩøÁî® <code>docker run --env &lt;key&gt;=&lt;value&gt;</code> ÂëΩ‰ª§Êù•‰øÆÊîπËøô‰∫õÁéØÂ¢ÉÂèòÈáèÂÄº</p>
<p>ÁéØÂ¢ÉÂèòÈáèÁöÑÊåÅ‰πÖÂåñÂèØËÉΩÂØºËá¥‰∏çÂèØÈ¢ÑÊñôÁöÑÂâØ‰ΩúÁî®. ‰æãÂ¶Ç, ËÆæÁΩÆ <code>ENV DEBIAN_FRONTEND=noninteractive</code> ‰øÆÊîπ <code>apt-get</code> ÁöÑË°å‰∏∫, ÂèØËÉΩ‰ºöËÆ©‰Ω†ÁöÑÈïúÂÉèÁöÑÁî®Êà∑ÊÑüÂà∞Ëø∑ÊÉë</p>
<p>Â¶ÇÊûú‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáè‰ªÖ‰ªÖÂú®ÊûÑÂª∫Êó∂ÈúÄË¶ÅËÄåÂú®ÊúÄÁªàÈïúÂÉè‰∏≠‰∏çÈúÄË¶Å, ËÄÉËôë‰∏∫ÂçïÁã¨‰∏Ä‰∏™ÂëΩ‰ª§ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÂÄº:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> DEBIAN_FRONTEND=noninteractive apt-get update &amp;&amp; apt-get install -y ...</span></span><br></pre></td></tr></table></figure>

<p>ÊàñËÄÖ‰ΩøÁî® <code>ARG</code> Êåá‰ª§, Ëøô‰∏™Êåá‰ª§ÁöÑÂÄº‰∏ç‰ºöÊåÅÁª≠Âà∞ÊúÄÁªàÈïúÂÉè‰∏≠:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> DEBIAN_FRONTEND=noninteractive</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y ...</span></span><br></pre></td></tr></table></figure>

<h3 id="Êõø‰ª£ÁöÑËØ≠Ê≥ï"><a href="#Êõø‰ª£ÁöÑËØ≠Ê≥ï" class="headerlink" title="Êõø‰ª£ÁöÑËØ≠Ê≥ï"></a>Êõø‰ª£ÁöÑËØ≠Ê≥ï</h3><p><code>ENV</code> Êåá‰ª§ËøòÊúâ‰∏Ä‰∏™Êõø‰ª£ÁöÑËØ≠Ê≥ï <code>ENV &lt;key&gt; &lt;value&gt;</code>, ÂéªÊéâ‰∫Ü <code>=</code>:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> MY_VAR my-value</span><br></pre></td></tr></table></figure>

<p>Ëøô‰∏™ËØ≠Ê≥ï<strong>‰∏çÂÖÅËÆ∏</strong>*Âú®Âçï‰∏™ <code>ENV</code> Êåá‰ª§‰∏≠ËÆæÁΩÆÂ§ö‰∏™ÁéØÂ¢ÉÂèòÈáè</p>
<p>Ëøô‰∏™Êõø‰ª£ÁöÑËØ≠Ê≥ïÊòØ‰∏∫‰∫ÜÂêëÂêéÁöÑÂÖºÂÆπÊÄß, ‰∏çÂª∫ËÆÆÁªßÁª≠‰ΩøÁî®</p>
<h2 id="ADD-ADD-Êåá‰ª§"><a href="#ADD-ADD-Êåá‰ª§" class="headerlink" title="ADD (ADD Êåá‰ª§)"></a>ADD (ADD Êåá‰ª§)</h2><p><code>ADD</code> Êåá‰ª§Êúâ‰∏§ÁßçÂΩ¢Âºè:</p>
<ul>
<li><code>ADD [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</code></li>
<li><code>ADD [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;src&gt;&quot;,...&quot;&lt;dest&gt;&quot;]</code></li>
</ul>
<p>ÂåÖÂê´Á©∫Ê†ºÁöÑË∑ØÂæÑÈúÄË¶ÅÁ¨¨‰∫åÁßçÂΩ¢Âºè</p>
<p><code>--chown</code> ÂäüËÉΩ‰ªÖÂú®Áî®‰∫éÊûÑÂª∫ Linux ÂÆπÂô®ÁöÑ Dockfile ‰∏äÂèóÊîØÊåÅ, Âú® Windows ÂÆπÂô®‰∏ä‰∏çÊîØÊåÅ. Âõ†‰∏∫Áî®Êà∑ÂíåÁî®Êà∑ÁªÑÊâÄÊúâÊùÉÊ¶ÇÂøµ‰∏çËÉΩÂú® Linux Âíå Windows ‰πãÈó¥ËΩ¨Êç¢, Âõ†Ê≠§‰ΩøÁî® <code>/etc/passwd</code> Âíå <code>/etc/group</code> Â∞ÜÁî®Êà∑ÂêçÂíåÁªÑÂêçËΩ¨Êç¢‰∏∫ ID ‰ºöÈôêÂà∂Ê≠§ÂäüËÉΩ‰ªÖÈÄÇÁî®‰∫éÂü∫‰∫é Linux Êìç‰ΩúÁ≥ªÁªüÁöÑÂÆπÂô®</p>
<p><code>ADD</code> Êåá‰ª§‰ªé <code>&lt;src&gt;</code> <strong>Â§çÂà∂</strong>Êñ∞ÁöÑ Êñá‰ª∂,ÁõÆÂΩï,ËøúÁ®ãÊñá‰ª∂URLs , Âπ∂Â∞ÜÂÆÉ‰ª¨<strong>Ê∑ªÂä†</strong>Âà∞ÈïúÂÉèÁöÑÊñá‰ª∂Á≥ªÁªü‰∏≠ÁöÑ <code>&lt;dest&gt;</code> Ë∑ØÂæÑ‰∏ä</p>
<p>ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ <code>&lt;src&gt;</code> ËµÑÊ∫ê, ‰ΩÜÊòØÂ¶ÇÊûúÂÆÉ‰ª¨ÊòØÊñá‰ª∂ÊàñËÄÖÁõÆÂΩï, ÂÆÉ‰ª¨ÁöÑË∑ØÂæÑË¢´Ëß£Êûê‰∏∫Áõ∏ÂØπ‰∫éÊûÑÂª∫‰∏ä‰∏ãÊñáÁöÑÊ∫ê</p>
<p>ÊØè‰∏™ <code>&lt;src&gt;</code> ÂèØ‰ª•ÂåÖÂê´ÈÄöÈÖçÁ¨¶, Âπ∂‰ΩøÁî® Go ËØ≠Ë®ÄÁöÑ <a class="link"   target="_blank" rel="noopener" href="https://golang.org/pkg/path/filepath#Match" >filepath.Match<i class="fas fa-external-link-alt"></i></a> Êù•ËøõË°åÂåπÈÖç:</p>
<p>Example - Ê∑ªÂä†ÊâÄÊúâ‰∏Ä‰∏™ ‚Äúhom‚Äù ÂºÄÂ§¥ÁöÑÊñá‰ª∂:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> hom* /mydir/</span></span><br></pre></td></tr></table></figure>

<p>Example - <code>?</code> Á¨¶Âè∑Áî®Êù•ÂåπÈÖç‰ªª‰ΩïÂçï‰∏™Â≠óÁ¨¶:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> hom?.txt /mydir/</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;dest&gt;</code> ÊòØ‰∏Ä‰∏™ÁªùÂØπË∑ØÂæÑ, ÊàñËÄÖÁõ∏ÂØπ‰∫é <code>WORKDIR</code> ÁöÑË∑ØÂæÑ, <code>&lt;src&gt;</code> Â∞Ü‰ºöË¢´Â§çÂà∂Âà∞ÁõÆÊ†áÂÆπÂô®ÂÜÖÁöÑËøô‰∏™Ë∑ØÂæÑ‰∏≠</p>
<p>Example - ‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑ, Âπ∂Ê∑ªÂä† test.txt Âà∞ <code>&lt;WORKDIR&gt;/relativeDir/</code> ‰∏≠:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> test.txt relativeDir /</span></span><br></pre></td></tr></table></figure>

<p>Example - ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ, Ê∑ªÂä† test.txt Âà∞ <code>/absoluteDir/</code> ‰∏≠:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> test.txt /absoluteDir/</span></span><br></pre></td></tr></table></figure>

<p>ÂΩìÊ∑ªÂä†ÂåÖÂê´ÁâπÊÆäÂ≠óÁ¨¶ (‰æãÂ¶Ç <code>[</code> Âíå <code>]</code>) ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩïÊó∂, ‰Ω†ÈúÄË¶Å‰ΩøÁî® Golang ËßÑÂàôËΩ¨‰πâÈÇ£‰∫õË∑ØÂæÑÊù•ÈÅøÂÖçÂ∞ÜÂÆÉ‰ª¨‰Ωú‰∏∫‰∏Ä‰∏™ÂåπÈÖçÊ®°ÂºèÊù•ÁúãÂæÖ</p>
<p>Example - Ê∑ªÂä†‰∏Ä‰∏™ÂêçÁß∞‰∏∫ <code>arr[0].txt</code> ÁöÑÊñá‰ª∂:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> arr[[]0].txt /mydir/</span></span><br></pre></td></tr></table></figure>

<p>ÊâÄÊúâÊñ∞Êñá‰ª∂ÂíåÁõÆÂΩï‰ΩøÁî®‰∏∫Èõ∂ÁöÑ UID Âíå GID ËøõË°åÂàõÂª∫, Èô§ÈùûÊåáÂÆö‰∫ÜÂèØÈÄâÁöÑ <code>--chown</code> Ê†áÂøó, <code>--chown</code> Ê†áÂøóÊåáÂÆö‰∫ÜÁªôÂÆöÁöÑÁî®Êà∑Âêç, ÁªÑÂêç, ÊàñËÄÖ UID&#x2F;GID ÁöÑÁªÑÂêà‰ª•ËØ∑Ê±ÇÊ∑ªÂä†ÂÜÖÂÆπÁöÑÁâπÂÆöÊâÄÊúâÊùÉ</p>
<p><code>--chown</code> Ê†áÂøóÁöÑÊ†ºÂºèÂÖÅËÆ∏Áî®Êà∑ÂêçÂíåÁªÑÂêçÂ≠óÁ¨¶‰∏≤ÊàñÁõ¥Êé•Êï¥Êï∞ UID Âíå GID ÁöÑ‰ªªÊÑèÁªÑÂêà</p>
<p>Êèê‰æõ‰∏çÂ∏¶ÁªÑÂêçÁöÑÁî®Êà∑ÂêçÊàñ‰∏çÂ∏¶ GID ÁöÑ UID Â∞Ü‰ΩøÁî®‰∏é GID Áõ∏ÂêåÁöÑÊï∞Â≠ó‰Ωú‰∏∫ GID</p>
<p>Â¶ÇÊûúÊèê‰æõ‰∫ÜÁî®Êà∑ÂêçÊàñÁªÑÂêç, ÂàôÂÆπÂô®ÁöÑÊ†πÊñá‰ª∂Á≥ªÁªü <code>/etc/passwd</code> Âíå <code>/etc/group</code> Êñá‰ª∂Â∞ÜÂàÜÂà´Áî®‰∫éÊâßË°å‰ªéÂêçÁß∞Âà∞Êï¥Êï∞ UID Êàñ GID ÁöÑËΩ¨Êç¢</p>
<p>Example - ‰∏ãÈù¢‰æãÂ≠êÂ±ïÁ§∫ <code>--chown</code> Ê†áÂøóÁöÑÊúâÊïàÂÆö‰πâ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="language-bash"> --<span class="built_in">chown</span>=55:mygroup files* /somedir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> --<span class="built_in">chown</span>=bin files* /somedir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> --<span class="built_in">chown</span>=1 files* /somedir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> --<span class="built_in">chown</span>=10:11 files* /somedir/</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûúÂÆπÂô®Ê†πÊñá‰ª∂Á≥ªÁªü‰∏çÂåÖÂê´ <code>/etc/passwd</code> Êàñ <code>/etc/group</code> Êñá‰ª∂, Âπ∂‰∏îÂú® <code>--chown</code> Ê†áÂøó‰∏≠‰ΩøÁî®‰∫ÜÁî®Êà∑ÂêçÊàñÁªÑÂêç, ÂàôÊûÑÂª∫Â∞ÜÂú® <code>ADD</code> Êìç‰ΩúÊó∂Â§±Ë¥•</p>
<p>‰ΩøÁî®Êï∞Â≠óÂΩ¢ ID ‰∏çÈúÄË¶ÅÊü•Êâæ, Âπ∂‰∏î‰∏ç‰æùËµñ‰∫éÂÆπÂô®Ê†πÊñá‰ª∂Á≥ªÁªü</p>
<p>Âú® <code>&lt;src&gt;</code> ÊòØ‰∏Ä‰∏™ËøúÁ®ãÊñá‰ª∂ URL ÁöÑÊÉÖÂÜµ‰∏ã, <code>&lt;dest&gt;</code> Â∞ÜÊã•Êúâ 600 ÁöÑÊùÉÈôê</p>
<p>Â¶ÇÊûúÊ≠£Âú®Ëé∑ÂèñÁöÑËøúÁ®ãÊñá‰ª∂ÂÖ∑Êúâ HTTP <code>Last-Modified</code> ËØ∑Ê±ÇÂ§¥, ÂàôËØ•ËØ∑Ê±ÇÂ§¥‰∏≠ÁöÑÊó∂Èó¥Êà≥Â∞ÜÁî®‰∫éËÆæÁΩÆÁõÆÊ†áÊñá‰ª∂ÁöÑ <code>mtime</code></p>
<p>‰ΩÜÊòØ, ‰∏éÂú® <code>ADD</code> ÊúüÈó¥Â§ÑÁêÜÁöÑ‰ªª‰ΩïÂÖ∂‰ªñÊñá‰ª∂‰∏ÄÊ†∑, Âú®Á°ÆÂÆöÊñá‰ª∂ÊòØÂê¶Â∑≤Êõ¥Êîπ‰ª•ÂèäÊòØÂê¶Â∫îËØ•Êõ¥Êñ∞ÁºìÂ≠òÊó∂, ‰∏ç‰ºöÂåÖÂê´ <code>mtime</code></p>
<p>Â¶ÇÊûú‰Ω†ÈÄöËøá STDIN (<code>docker build - &lt; somefile</code>) ‰º†ÈÄí <code>Dockerfile</code> Êù•ËøõË°åÊûÑÂª∫, ÈÇ£Â∞Ü‰ºöÊ≤°ÊúâÊûÑÂª∫‰∏ä‰∏ãÊñá, ÊâÄ‰ª• <code>Dockerfile</code> Âè™ËÉΩÂåÖÂê´‰∏Ä‰∏™Âü∫‰∫é URL ÁöÑ <code>ADD</code> Êåá‰ª§</p>
<p>‰Ω†ËøòÂèØ‰ª•ÈÄöËøá STDIN ‰º†ÈÄíÂéãÁº©Êñá‰ª∂: (<code>docker build - &lt; archive.tar.gz</code>), ÂéãÁº©Êñá‰ª∂Ê†πÁõÆÂΩï‰∏≠ÁöÑ <code>Dockerfile</code> ÂíåÂéãÁº©Êñá‰ª∂ÁöÑÂÖ∂‰ΩôÈÉ®ÂàÜÂ∞ÜÁî®‰ΩúÊûÑÂª∫ÁöÑ‰∏ä‰∏ãÊñá</p>
<p>Â¶ÇÊûú‰Ω†ÁöÑ URL Êñá‰ª∂ÊòØ‰ΩøÁî®ËÆ§ËØÅ‰øùÊä§ÁöÑ, ‰Ω†ÈúÄË¶Å‰ΩøÁî® <code>RUN wget</code>, <code>RUN curl</code> ÊàñÂÆπÂô®‰∏≠ÁöÑÂÖ∂‰ªñÂ∑•ÂÖ∑, Âõ†‰∏∫ <code>ADD</code> Êåá‰ª§‰∏çÊîØÊåÅËÆ§ËØÅ</p>
<p>Â¶ÇÊûú <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∑≤Êõ¥Êîπ, ÂàôÁ¨¨‰∏Ä‰∏™ÈÅáÂà∞ÁöÑ <code>ADD</code> Êåá‰ª§Â∞Ü‰Ωø <code>Dockerfile</code> ‰∏≠ÊâÄÊúâÂêéÁª≠Êåá‰ª§ÁöÑÁºìÂ≠òÊó†Êïà. ËøôÂåÖÊã¨‰Ωø <code>RUN</code> Êåá‰ª§ÁöÑÁºìÂ≠òÊó†ÊïàÂåñ. Êü•Áúã <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#leverage-build-cache"><code>Dockerfile</code> Best Practices guide - Leverage build cache</a> Ëé∑Âèñ‰ø°ÊÅØ</p>
<p><code>ADD</code> ÈÅµÂæ™‰ª•‰∏ãËßÑÂàô:</p>
<ul>
<li><code>&lt;src&gt;</code> ÁöÑË∑ØÂæÑÂøÖÈ°ªÂú®ÊûÑÂª∫ÁöÑ‰∏ä‰∏ãÊñá‰∏≠; ‰∏çÂèØ‰ª• <code>ADD ../something/something</code>, Âõ†‰∏∫ <code>docker build</code> ÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØÂèëÈÄÅ‰∏ä‰∏ãÊñáÁõÆÂΩï (ÂíåÂ≠êÁõÆÂΩï) Áªô Docker Daemon</li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰∏Ä‰∏™ URL ‰∏î <code>&lt;dest&gt;</code> Ê≤°Êúâ‰ª•‰∏Ä‰∏™ÊñúÁ∫øÁªìÂ∞æ, ÈÇ£‰πàÊñá‰ª∂‰ªé URL ‰∏≠‰∏ãËΩΩÂπ∂Â§çÂà∂Âà∞ <code>&lt;dest&gt;</code></li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰∏Ä‰∏™ URL ‰∏î <code>&lt;dest&gt;</code> ‰ª•‰∏Ä‰∏™ÊñúÁ∫øÁªìÂ∞æ, ÈÇ£‰πàÂ∞Ü‰ªé URL ‰∏≠Êé®Êñ≠Êñá‰ª∂Âêç, Âπ∂Â∞ÜÊñá‰ª∂‰∏ãËΩΩÂà∞ <code>&lt;dest&gt;/&lt;filename&gt;</code>. ‰æãÂ¶Ç, <code>ADD http://example.com/foobar /</code> Â∞Ü‰ºöÂàõÂª∫Êñá‰ª∂ <code>/foobar</code>. URL ÂøÖÈ°ªÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑË∑ØÂæÑ, ‰ª•‰æøÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÊâæÂà∞ÈÄÇÂΩìÁöÑÊñá‰ª∂Âêç (<code>http://example.com</code> Êó†Ê≥ïÂ∑•‰Ωú)</li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰∏Ä‰∏™ÁõÆÂΩï, ÈÇ£‰πàÁõÆÂΩïÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπË¢´Â§çÂà∂, ÂåÖÊã¨Êñá‰ª∂Á≥ªÁªüÂÖÉÊï∞ÊçÆ; <strong>ÁõÆÂΩïÊú¨Ë∫´‰∏ç‰ºöË¢´Â§çÂà∂, Âè™ÊúâÁõÆÂΩï‰∏≠ÁöÑÂÜÖÂÆπ‰ºöË¢´Â§çÂà∂</strong></li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØÂèØËØÜÂà´ÁöÑÂéãÁº©Ê†ºÂºè (identity, gzip, bzip2 Êàñ xz) ÁöÑÊú¨Âú∞ tar Â≠òÊ°£, ÂàôÂ∞ÜÂÖ∂Ëß£ÂéãÁº©‰∏∫ÁõÆÂΩï. ‰ªéËøúÁ®ã URLs Ëé∑ÂèñÁöÑËµÑÊ∫ê<strong>‰∏ç‰ºö</strong>Ëß£ÂéãÁº©. ÂΩì‰∏Ä‰∏™ÁõÆÂΩïË¢´Â§çÂà∂ÊàñËß£ÂéãÁº©Êó∂, ÂÆÉÂÖ∑Êúâ‰∏é <code>tar -x</code> Áõ∏ÂêåÁöÑË°å‰∏∫, ÁªìÊûúÊòØÂ¶Ç‰∏ãÁöÑÁªìÂêà:<ul>
<li>ÁõÆÊ†áË∑ØÂæÑ‰∏äÂ≠òÂú®ÁöÑ‰ªª‰Ωï‰∏úË•ø</li>
<li>Ê∫êÊ†ë (source tree) ÁöÑÂÜÖÂÆπ, Áî® ‚Äú2‚Äù ÁöÑÊñπÂºèËß£ÂÜ≥ÂÜ≤Á™Å. ‰ª•ÈÄê‰∏™Êñá‰ª∂‰∏∫Âü∫Á°Ä</li>
</ul>
</li>
<li>Êñá‰ª∂ÊòØÂê¶Ë¢´Èâ¥ÂÆö‰∏∫ÂèØËØÜÂà´ÁöÑÂéãÁº©Ê†ºÂºè‰ªÖÂèñÂÜ≥‰∫éÊñá‰ª∂ÁöÑÂÜÖÂÆπ, ËÄå‰∏çÊòØÊñá‰ª∂Âêç. ‰æãÂ¶Ç, Â¶ÇÊûú‰∏Ä‰∏™Á©∫Êñá‰ª∂ÊÅ∞Â•Ω‰ª• <code>.tar.gz</code> ÁªìÂ∞æ, ËøôÂ∞Ü‰∏ç‰ºöË¢´ËØÜÂà´‰∏∫ÂéãÁº©Êñá‰ª∂, ‰πü‰∏ç‰ºöÁîüÊàê‰ªª‰ΩïÁ±ªÂûãÁöÑËß£ÂéãÁº©ÈîôËØØÊ∂àÊÅØ, ËÄåÊòØÂ∞ÜÊñá‰ª∂ÁÆÄÂçïÂú∞Â§çÂà∂Âà∞ÁõÆÊ†á‰ΩçÁΩÆ</li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰ªª‰ΩïÂÖ∂‰ªñÁ±ªÂûãÁöÑÊñá‰ª∂, ÂÆÉ‰ºö‰∏éÂÖÉÊï∞ÊçÆ‰∏ÄËµ∑ÂçïÁã¨Â§çÂà∂. Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰ª• <code>/</code> ÁªìÂ∞æ, ÂàôÂ∞ÜÂÖ∂ËßÜ‰∏∫ÁõÆÂΩï, ‰∏î <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∞ÜÂÜôÂÖ• <code>&lt;dest&gt;/base(&lt;src&gt;</code></li>
<li>Â¶ÇÊûúÊåáÂÆö‰∫ÜÂ§ö‰∏™ <code>&lt;src&gt;</code> Ê∫ê, Êó†ËÆ∫ÊòØÁõ¥Êé•ÊåáÂÆöËøòÊòØ‰ΩøÁî®‰∫ÜÈÄöÈÖçÁ¨¶ÊåáÂÆö, ÈÇ£‰πà <code>&lt;dest&gt;</code> ÂøÖÈ°ªÊòØÁõÆÂΩï, Âπ∂‰∏îÂøÖÈ°ª‰ª• <code>/</code> ÁªìÂ∞æ</li>
<li>Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰∏çÊòØ‰ª• <code>/</code> ÁªìÂ∞æ, ÈÇ£‰πà <code>&lt;dest&gt;</code> Â∞ÜË¢´ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÊñá‰ª∂‰∏î <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∞Ü‰ºöË¢´ÂÜôÂà∞ <code>&lt;dest&gt;</code></li>
<li>Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰∏çÂ≠òÂú®, ÂÆÉ‰ºöËøûÂêåÂÖ∂Ë∑ØÂæÑ‰∏≠ÊâÄÊúâÁº∫Â§±ÁöÑÁõÆÂΩï‰∏ÄËµ∑ÂàõÂª∫</li>
</ul>
<h2 id="COPY-COPY-Êåá‰ª§"><a href="#COPY-COPY-Êåá‰ª§" class="headerlink" title="COPY (COPY Êåá‰ª§)"></a>COPY (COPY Êåá‰ª§)</h2><p><code>COPY</code> Êåá‰ª§Êúâ‰∏§ÁßçÂΩ¢Âºè:</p>
<ul>
<li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</code></li>
<li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;src&gt;&quot;,... &quot;&lt;dest&gt;&quot;]</code></li>
</ul>
<p>ÂåÖÂê´Á©∫Ê†ºÁöÑË∑ØÂæÑÈúÄË¶Å‰ΩøÁî®Âêé‰∏ÄÁßçÂΩ¢Âºè</p>
<p><code>--chown</code> ÂäüËÉΩ‰ªÖÂú®Áî®‰∫éÊûÑÂª∫ Linux ÂÆπÂô®ÁöÑ Dockfile ‰∏äÂèóÊîØÊåÅ, Âú® Windows ÂÆπÂô®‰∏ä‰∏çÊîØÊåÅ. Âõ†‰∏∫Áî®Êà∑ÂíåÁî®Êà∑ÁªÑÊâÄÊúâÊùÉÊ¶ÇÂøµ‰∏çËÉΩÂú® Linux Âíå Windows ‰πãÈó¥ËΩ¨Êç¢, Âõ†Ê≠§‰ΩøÁî® <code>/etc/passwd</code> Âíå <code>/etc/group</code> Â∞ÜÁî®Êà∑ÂêçÂíåÁªÑÂêçËΩ¨Êç¢‰∏∫ ID ‰ºöÈôêÂà∂Ê≠§ÂäüËÉΩ‰ªÖÈÄÇÁî®‰∫éÂü∫‰∫é Linux Êìç‰ΩúÁ≥ªÁªüÁöÑÂÆπÂô®</p>
<p><code>COPY</code> Êåá‰ª§‰ªé <code>&lt;src&gt;</code> ‰∏≠<strong>Â§çÂà∂</strong>Êñ∞Êñá‰ª∂ÊàñÁõÆÂΩï, Âπ∂Â∞ÜÂÆÉ‰ª¨Ê∑ªÂä†Âà∞ÂÆπÂô®Êñá‰ª∂Á≥ªÁªüÁöÑ <code>&lt;dest&gt;</code> ‰∏≠</p>
<p>ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ <code>&lt;src&gt;</code> ËµÑÊ∫ê, ‰ΩÜÊñá‰ª∂ÂíåÁõÆÂΩïÁöÑË∑ØÂæÑË¢´Ëß£Èáä‰∏∫Áõ∏ÂØπ‰∫éÊûÑÂª∫‰∏ä‰∏ãÊñáÁöÑÊ∫ê (source)</p>
<p>ÊØè‰∏™ <code>&lt;src&gt;</code> ÂèØËÉΩÂåÖÂê´ÈÄöÈÖçÁ¨¶‰∏îÂ∞Ü‰ºö‰ΩøÁî® Go ËØ≠Ë®ÄÁöÑ <a class="link"   target="_blank" rel="noopener" href="https://golang.org/pkg/path/filepath#Match" >filepath.Match<i class="fas fa-external-link-alt"></i></a> ËßÑÂàôËøõË°åÂåπÈÖç</p>
<p>Example - Ê∑ªÂä†ÊâÄÊúâ‰ª• ‚Äúhom‚Äù ÂºÄÂ§¥ÁöÑÊñá‰ª∂:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> hom* /mydir/</span></span><br></pre></td></tr></table></figure>

<p>Example - <code>?</code> Áî®Êù•‰ª£Êõø‰ªª‰ΩïÂçï‰∏™Â≠óÁ¨¶. ‰æãÂ¶Ç ‚Äúhome.txt‚Äù:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> hom?.txt /mydir/</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;dest&gt;</code> ÊòØ‰∏Ä‰∏™ÁªùÂØπË∑ØÂæÑ, ÊàñËÄÖ‰∏Ä‰∏™Áõ∏ÂØπ‰∫é <code>WORKDIR</code> ÁöÑË∑ØÂæÑ, Ê∫ê (source) Â∞ÜË¢´Â§çÂà∂Âà∞ÁõÆÊ†áÂÆπÂô®‰∏≠</p>
<p>Example - ‰ΩøÁî®‰∏Ä‰∏™Áõ∏ÂØπË∑ØÂæÑ, Ê∑ªÂä† <code>test.txt</code> Âà∞ <code>&lt;WORKDIR&gt;/relativeDir/</code>:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> test.txt relativeDir/</span></span><br></pre></td></tr></table></figure>

<p>Example - ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ, Ê∑ªÂä† <code>test.txt</code> Âà∞ <code>/absoluteDir/</code>:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> test.txt /absoluteDir/</span></span><br></pre></td></tr></table></figure>

<p>ÂΩìÊ∑ªÂä†ÂåÖÂê´ÁâπÊÆäÂ≠óÁ¨¶ (‰æãÂ¶Ç <code>[</code> Âíå <code>]</code>) ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩïÊó∂, ‰Ω†ÈúÄË¶Å‰ΩøÁî® Golang ËßÑÂàôËΩ¨‰πâÈÇ£‰∫õË∑ØÂæÑÊù•ÈÅøÂÖçÂ∞ÜÂÆÉ‰ª¨‰Ωú‰∏∫‰∏Ä‰∏™ÂåπÈÖçÊ®°ÂºèÊù•ÁúãÂæÖ</p>
<p>Example - Ê∑ªÂä†‰∏Ä‰∏™ÂêçÁß∞‰∏∫ <code>arr[0].txt</code> ÁöÑÊñá‰ª∂:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> arr[[]0].txt /mydir/</span></span><br></pre></td></tr></table></figure>

<p>ÊâÄÊúâÊñ∞Êñá‰ª∂ÂíåÁõÆÂΩï‰ΩøÁî®‰∏∫Èõ∂ÁöÑ UID Âíå GID ËøõË°åÂàõÂª∫, Èô§ÈùûÊåáÂÆö‰∫ÜÂèØÈÄâÁöÑ <code>--chown</code> Ê†áÂøó, <code>--chown</code> Ê†áÂøóÊåáÂÆö‰∫ÜÁªôÂÆöÁöÑÁî®Êà∑Âêç, ÁªÑÂêç, ÊàñËÄÖ UID&#x2F;GID ÁöÑÁªÑÂêà‰ª•ËØ∑Ê±ÇÊ∑ªÂä†ÂÜÖÂÆπÁöÑÁâπÂÆöÊâÄÊúâÊùÉ</p>
<p><code>--chown</code> Ê†áÂøóÁöÑÊ†ºÂºèÂÖÅËÆ∏Áî®Êà∑ÂêçÂíåÁªÑÂêçÂ≠óÁ¨¶‰∏≤ÊàñÁõ¥Êé•Êï¥Êï∞ UID Âíå GID ÁöÑ‰ªªÊÑèÁªÑÂêà</p>
<p>Êèê‰æõ‰∏çÂ∏¶ÁªÑÂêçÁöÑÁî®Êà∑ÂêçÊàñ‰∏çÂ∏¶ GID ÁöÑ UID Â∞Ü‰ΩøÁî®‰∏é GID Áõ∏ÂêåÁöÑÊï∞Â≠ó‰Ωú‰∏∫ GID</p>
<p>Â¶ÇÊûúÊèê‰æõ‰∫ÜÁî®Êà∑ÂêçÊàñÁªÑÂêç, ÂàôÂÆπÂô®ÁöÑÊ†πÊñá‰ª∂Á≥ªÁªü <code>/etc/passwd</code> Âíå <code>/etc/group</code> Êñá‰ª∂Â∞ÜÂàÜÂà´Áî®‰∫éÊâßË°å‰ªéÂêçÁß∞Âà∞Êï¥Êï∞ UID Êàñ GID ÁöÑËΩ¨Êç¢</p>
<p>Example - ‰∏ãÈù¢‰æãÂ≠êÂ±ïÁ§∫ <code>--chown</code> Ê†áÂøóÁöÑÊúâÊïàÂÆö‰πâ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chown</span>=55:mygroup files* /somedir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chown</span>=bin files* /somedir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chown</span>=1 files* /somedir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chown</span>=10:11 files* /somedir/</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûúÂÆπÂô®Ê†πÊñá‰ª∂Á≥ªÁªü‰∏çÂåÖÂê´ <code>/etc/passwd</code> Êàñ <code>/etc/group</code> Êñá‰ª∂, Âπ∂‰∏îÂú® <code>--chown</code> Ê†áÂøó‰∏≠‰ΩøÁî®‰∫ÜÁî®Êà∑ÂêçÊàñÁªÑÂêç, ÂàôÊûÑÂª∫Â∞ÜÂú® <code>COPY</code> Êìç‰ΩúÊó∂Â§±Ë¥•</p>
<p>‰ΩøÁî®Êï∞Â≠óÂΩ¢ ID ‰∏çÈúÄË¶ÅÊü•Êâæ, Âπ∂‰∏î‰∏ç‰æùËµñ‰∫éÂÆπÂô®Ê†πÊñá‰ª∂Á≥ªÁªü</p>
<p>Â¶ÇÊûú‰Ω†ÈÄöËøá STDIN (<code>docker build - &lt; somefile</code>) ‰º†ÈÄí <code>Dockerfile</code> Êù•ËøõË°åÊûÑÂª∫, ÈÇ£Â∞Ü‰ºöÊ≤°ÊúâÊûÑÂª∫‰∏ä‰∏ãÊñá, ÊâÄ‰ª•‰∏çËÉΩ‰ΩøÁî® <code>COPY</code></p>
<p><code>COPY</code> ÂèØÈÄâÂú∞Êé•Âèó‰∏Ä‰∏™ <code>--from=&lt;name&gt;</code> Ê†áÂøó, Ëøô‰∏™Ê†áÂøóÂèØÁî®‰∫éÂ∞ÜÊ∫ê‰ΩçÁΩÆËÆæÁΩÆ‰∏∫ÂÖàÂâçÁöÑÊûÑÂª∫Èò∂ÊÆµ (‰ΩøÁî® <code>FROM .. AS &lt;name&gt;</code> ÂàõÂª∫), ËØ•Èò∂ÊÆµÂ∞ÜÁî®‰∫é‰ª£ÊõøÁî®Êà∑ÂèëÈÄÅÁöÑÊûÑÂª∫‰∏ä‰∏ãÊñá</p>
<p>Â¶ÇÊûúÊâæ‰∏çÂà∞ÂÖ∑ÊúâÊåáÂÆöÂêçÁß∞ÁöÑÊûÑÂª∫Èò∂ÊÆµ, ÂàôÂ∞ùËØï‰ΩøÁî®ÂÖ∑ÊúâÁõ∏ÂêåÂêçÁß∞ÁöÑÈïúÂÉè</p>
<p><code>COPY</code> ÈÅµÂæ™Â¶Ç‰∏ãËßÑÂàô:</p>
<ul>
<li><code>&lt;src&gt;</code> Ë∑ØÂæÑÂøÖÈ°ªÂú®ÊûÑÂª∫ÁöÑ‰∏ä‰∏ãÊñá‰∏≠; ‰Ω†‰∏çËÉΩ <code>COPY ../something/something</code>, Âõ†‰∏∫ <code>docker build</code> ÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØÂèëÈÄÅ‰∏ä‰∏ãÊñá‰ª∂Â§π (ÂíåÂ≠êÊñá‰ª∂Â§π) Áªô Docker Daemon</li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰∏Ä‰∏™Êñá‰ª∂Â§π, ÈÇ£‰πàËøô‰∏™Êñá‰ª∂Â§π‰∏≠ÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπÈÉΩË¢´Â§çÂà∂, ÂåÖÊã¨Êñá‰ª∂Á≥ªÁªüÂÖÉÊï∞ÊçÆ; Êñá‰ª∂Â§πÊú¨Ë∫´‰∏ç‰ºöË¢´Â§çÂà∂, Âè™‰ºöÂ§çÂà∂ÂÆÉÈáåÈù¢ÁöÑÂÜÖÂÆπ</li>
<li>Â¶ÇÊûú <code>&lt;src&gt;</code> ÊòØ‰ªª‰ΩïÂÖ∂‰ªñÁ±ªÂûãÁöÑÊñá‰ª∂, ÂÆÉ‰ºö‰∏éÂÆÉÁöÑÂÖÉÊï∞ÊçÆ‰∏ÄËµ∑ÂçïÁã¨Â§çÂà∂. Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰ª• <code>/</code> ÁªìÂ∞æ, ÂàôÂ∞ÜÂÖ∂ËßÜ‰∏∫ÁõÆÂΩï, Âπ∂‰∏î <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∞ÜÂÜôÂÖ• <code>&lt;dest&gt;/base(&lt;src&gt;)</code></li>
<li>Â¶ÇÊûúÊåáÂÆö‰∫ÜÂ§ö‰∏™ <code>&lt;src&gt;</code> ËµÑÊ∫ê, Êó†ËÆ∫ÊòØÁõ¥Êé•ÊåáÂÆöËøòÊòØÈÄöËøá‰ΩøÁî®ÈÄöÈÖçÁ¨¶ÊåáÂÆö, ÈÇ£‰πà <code>&lt;dest&gt;</code> ÂøÖÈ°ªÊòØ‰∏Ä‰∏™Êñá‰ª∂Â§π, ÂÆÉÂøÖÈ°ª‰ª• <code>\</code> ‰Ωú‰∏∫ÁªìÂ∞æ</li>
<li>Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰∏çÊòØ‰ª• <code>\</code> ‰Ωú‰∏∫ÁªìÂ∞æ, ÂÆÉÂ∞ÜË¢´ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÊñá‰ª∂, ‰∏î <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∞ÜË¢´ÂÜôÂà∞ <code>&lt;dest&gt;</code></li>
<li>Â¶ÇÊûú <code>&lt;dest&gt;</code> ‰∏çÂ≠òÂú®, ÂÆÉ‰ºöËøûÂêåÂÖ∂Ë∑ØÂæÑ‰∏≠ÊâÄÊúâÁº∫Â§±ÁöÑÁõÆÂΩï‰∏ÄËµ∑ÂàõÂª∫</li>
</ul>
<p>Â¶ÇÊûú <code>&lt;src&gt;</code> ÁöÑÂÜÖÂÆπÂ∑≤Êõ¥Êîπ, ÂàôÁ¨¨‰∏Ä‰∏™ÈÅáÂà∞ÁöÑ <code>COPY</code> Êåá‰ª§Â∞Ü‰Ωø Dockerfile ‰∏≠ÊâÄÊúâÂêéÁª≠Êåá‰ª§ÁöÑÁºìÂ≠òÊó†Êïà. ËøôÂåÖÊã¨‰Ωø <code>RUN</code> Êåá‰ª§ÁöÑÁºìÂ≠òÊó†Êïà</p>
<p>Êü•Áúã <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#leverage-build-cache"><code>Dockerfile</code> best practices guide - Leverage build cache</a> Ëé∑ÂèñÊõ¥Â§ö‰ø°ÊÅØ</p>
<h2 id="ENTRYPOINT-ENTRYPOINT-Êåá‰ª§"><a href="#ENTRYPOINT-ENTRYPOINT-Êåá‰ª§" class="headerlink" title="ENTRYPOINT (ENTRYPOINT Êåá‰ª§)"></a>ENTRYPOINT (ENTRYPOINT Êåá‰ª§)</h2><p><code>ENTRYPOINT</code> Êúâ‰∏§ÁßçÂΩ¢Âºè:</p>
<p><code>exec</code> ÂΩ¢Âºè, ËøôÊòØÈ¶ñÈÄâÂΩ¢Âºè: <code>ENTRYPOINT [ &quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot; ]</code></p>
<p><code>shell</code> ÂΩ¢Âºè: <code>ENTRYPOINT command param1 param2</code></p>
<p><code>ENTRYPOINT</code> ÂÖÅËÆ∏‰Ω†ÈÖçÁΩÆ ÂÆπÂô® ‰Ωú‰∏∫‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂Êù•ËøêË°å</p>
<p>Example - ‰ΩøÁî®ÈªòËÆ§ÂÜÖÂÆπÂêØÂä® Nginx, ÁõëÂê¨ 80 Á´ØÂè£:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker <span class="keyword">run</span><span class="language-bash"> -i -t --<span class="built_in">rm</span> -p 80:80 nginx</span></span><br></pre></td></tr></table></figure>

<p>‰º†Áªô <code>docker run &lt;image&gt;</code> ÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞Â∞Ü‰ºöÈôÑÂä†Âà∞ <code>exec</code> ÂΩ¢Âºè <code>ENTRYPOINT</code> Êåá‰ª§‰∏≠ÊâÄÊúâÂÖÉÁ¥†ÁöÑÂêéÈù¢, <strong>Âπ∂‰∏î‰ºöË¶ÜÁõñÊâÄÊúâ‰ΩøÁî® <code>CMD</code> ÊåáÂÆöÁöÑÂÖÉÁ¥†</strong></p>
<p>ËøôÂÖÅËÆ∏‰º†ÈÄíÂèÇÊï∞Áªô <code>ENTRYPOINT</code>, ‰æãÂ¶Ç <code>docker run &lt;image&gt; -d</code> Â∞Ü‰ºö‰º†ÈÄí <code>-d</code> ÂèÇÊï∞Áªô <code>ENTRYPOINT</code></p>
<p>ÂèØ‰ª•‰ΩøÁî® <code>docker run --entrypoint</code> Ê†áÂøóÊù•Ë¶ÜÁõñ <code>ENTRYPOINT</code> Êåá‰ª§</p>
<p><code>shell</code> ÂΩ¢ÂºèÈòªÊ≠¢‰ΩøÁî®ÊâÄÊúâ <code>CMD</code> Êåá‰ª§Êàñ <code>run</code> ÂëΩ‰ª§Ë°åÂèÇÊï∞, ‰ΩÜÁº∫ÁÇπÊòØ‰Ω†ÁöÑ <code>ENTRYPOINT</code> Â∞Ü‰Ωú‰∏∫ <code>/bin/sh -c</code> ÁöÑÂ≠êÂëΩ‰ª§ÂêØÂä®, ËøôÊ†∑‰∏ç‰ºö‰º†ÈÄí‰ø°Âè∑ (signals)</p>
<p>ËøôÊÑèÂë≥ÁùÄÂèØÊâßË°åÊñá‰ª∂‰∏ç‰ºöÊòØÂÆπÂô®ÁöÑ <code>PID 1</code>, ‰∏î‰∏ç‰ºöÊé•ÂèóÂà∞ Unix ‰ø°Âè∑ (signals), ÊâÄ‰ª•‰Ω†ÁöÑÂèØÊâßË°åÊñá‰ª∂‰∏ç‰ºö‰ªé <code>docker stop &lt;container&gt;</code> Êé•ÂèóÂà∞‰∏Ä‰∏™ <code>SIGTERM</code></p>
<p>Âè™Êúâ <code>Dockerfile</code> ‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ <code>ENTRYPOINT</code> Êåá‰ª§‰ºöÁîüÊïà</p>
<h3 id="Exec-form-ENTRYPOINT-example-Exec-ÂΩ¢Âºè-ENTRYPOINT-‰æãÂ≠ê"><a href="#Exec-form-ENTRYPOINT-example-Exec-ÂΩ¢Âºè-ENTRYPOINT-‰æãÂ≠ê" class="headerlink" title="Exec form ENTRYPOINT example (Exec ÂΩ¢Âºè ENTRYPOINT ‰æãÂ≠ê)"></a>Exec form ENTRYPOINT example (<code>Exec</code> ÂΩ¢Âºè <code>ENTRYPOINT</code> ‰æãÂ≠ê)</h3><p>ÂèØ‰ª•‰ΩøÁî® <code>ENTRYPOINT</code> ÁöÑ <code>exec</code> ÂΩ¢ÂºèÊù•ËÆæÁΩÆÈùûÂ∏∏Á®≥ÂÆöÁöÑÈªòËÆ§ÂëΩ‰ª§ÂíåÂèÇÊï∞, ÁÑ∂Âêé‰ΩøÁî®‰ªª‰∏ÄÂΩ¢ÂºèÁöÑ <code>CMD</code> Êù•ËÆæÁΩÆÈ¢ùÂ§ñÁöÑÂæàÊúâÂèØËÉΩÊîπÂèòÁöÑÈªòËÆ§ÂÄº</p>
<p>Â¶ÇÊûú‰Ω†ÈúÄË¶Å‰∏∫‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÁºñÂÜô‰∏Ä‰∏™ÂêØÂä®ËÑöÊú¨, ‰Ω†ÂèØ‰ª•ÈÄöËøá‰ΩøÁî® <code>exec</code> Âíå <code>gosu</code> ÂëΩ‰ª§Êù•Á°Æ‰øùÊúÄÂêéÁöÑÂèØÊâßË°åÊñá‰ª∂Êé•Âèó Unix ‰ø°Âè∑ (signals):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> = <span class="string">&#x27;postgres&#x27;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">chown</span> -R postgres <span class="string">&quot;<span class="variable">$PGDATA</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="subst">$(ls -A <span class="string">&quot;<span class="variable">$PGDATA</span>&quot;</span>)</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        gosu postgres initdb</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">exec</span> gosu postgres <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>ÊúÄÂêé, Â¶ÇÊûú‰Ω†ÈúÄË¶ÅÂú®ÂÖ≥Èó≠ (shutdown) ÁöÑÊó∂ÂÄôÂÅö‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÊ∏ÖÁêÜÂ∑•‰Ωú (ÊàñËÄÖÂíåÂÖ∂‰ªñÂÆπÂô®ÈÄö‰ø°), ÊàñËÄÖÂçèË∞ÉÂ§ö‰∏™ÂèØÊâßË°åÊñá‰ª∂, ‰Ω†ÂèØËÉΩÈúÄË¶ÅÁ°Æ‰øù <code>ENTRYPOINT</code> ËÑöÊú¨Êé•Êî∂ Unix ‰ø°Âè∑ (signals), ‰º†ÈÄíÂÆÉ‰ª¨, ÁÑ∂ÂêéÂÅöÊõ¥Â§öÁöÑÂ∑•‰Ωú:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># Note: I&#x27;ve written this using sh so it works in the busybox container too</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># USE the trap if you need to also do manual cleanup after the service is stopped,</span></span><br><span class="line"><span class="comment">#     or need to start multiple services in the one container</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;echo TRAPed signal&quot;</span> HUP INT QUIT TERM</span><br><span class="line"></span><br><span class="line"><span class="comment"># start service in background here</span></span><br><span class="line">/usr/sbin/apachectl start</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[hit enter key to exit] or run &#x27;docker stop &lt;container&gt;&#x27;&quot;</span></span><br><span class="line"><span class="built_in">read</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stop service and clean up here</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;stopping apache&quot;</span></span><br><span class="line">/usr/sbin/apachectl stop</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;exited <span class="variable">$0</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰Ω†‰ΩøÁî® <code>docker run -it --rm -p 80:80 --name test apache</code> Êù•ËøêË°åËøô‰∏™ÈïúÂÉè, ‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>docker exec</code> Êàñ <code>docker top</code> Ê£ÄÊü•ÂÆπÂô®ÁöÑËøõÁ®ã, ÁÑ∂ÂêéÂëäËØâ (ask) ËÑöÊú¨ÂéªÂÅúÊ≠¢ Apache:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/bin/time docker stop <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>--entrypoint</code> Ë¶ÜÁõñ <code>ENTRYPOINT</code> ËÆæÁΩÆ, ‰ΩÜÊòØËøôÂè™ËÉΩÂ∞Ü‰∫åËøõÂà∂Êñá‰ª∂ËÆæÁΩÆ‰∏∫ <code>exec</code> (‰∏ç‰ºö‰ΩøÁî® <code>sh -c</code>)</p>
<p><code>exec</code> ÂΩ¢Âºè‰Ωú‰∏∫‰∏Ä‰∏™ JSON Êï∞ÁªÑÊù•Ëß£Êûê, ËøôÊÑèÂë≥ÁùÄ‰Ω†ÂøÖÈ°ª‰ΩøÁî®ÂèåÂºïÂè∑Êù•ÂåÖË£πÂçïËØç</p>
<p>‰∏çÂÉè <code>shell</code> ÂΩ¢Âºè, <code>exec</code> ÂΩ¢Âºè‰∏ç‰ºöË∞ÉÁî®‰∏Ä‰∏™ÂëΩ‰ª§ shell. ËøôÊÑèÂë≥ÁùÄÊ≠£Â∏∏ÁöÑ shell Â§ÑÁêÜ‰∏ç‰ºöÂèëÁîü. ‰æãÂ¶Ç, <code>ENTRYPOINT [&quot;echo&quot;, &quot;$HOME&quot;]</code> Â∞Ü‰∏ç‰ºöÂú® <code>$HOME</code> ‰∏äÊâßË°åÂèòÈáèÊõøÊç¢. Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶Å shell Â§ÑÁêÜ, Ë¶Å‰πà‰ΩøÁî® <code>shell</code> ÂΩ¢ÂºèË¶Å‰πàÁõ¥Êé•ÊâßË°å‰∏Ä‰∏™ <code>shell</code>, ‰æãÂ¶Ç: <code>ENTRYPOINT [&quot;sh&quot;, &quot;-c&quot;, &quot;echo $HOME&quot;]</code>. ÂΩì‰ΩøÁî® <code>exec</code> ÂΩ¢ÂºèÂπ∂Áõ¥Êé•ÊâßË°å‰∏Ä‰∏™ shell, ‰∏é‰ΩøÁî® <code>shell</code> ÂΩ¢ÂºèÁöÑÊÉÖÂÜµ‰∏ÄÊ†∑, ËøõË°åÁéØÂ¢ÉÂèòÈáèÊâ©Â±ïÁöÑÊòØ shell ËÄå‰∏çÊòØ Docker</p>
<h3 id="Shell-form-ENTRYPOINT-example-Shell-ÂΩ¢Âºè-ENTRYPOINT-‰æãÂ≠ê"><a href="#Shell-form-ENTRYPOINT-example-Shell-ÂΩ¢Âºè-ENTRYPOINT-‰æãÂ≠ê" class="headerlink" title="Shell form ENTRYPOINT example (Shell ÂΩ¢Âºè ENTRYPOINT ‰æãÂ≠ê)"></a>Shell form ENTRYPOINT example (Shell ÂΩ¢Âºè <code>ENTRYPOINT</code> ‰æãÂ≠ê)</h3><p>ÂèØ‰ª•‰∏∫ <code>ENTRYPOINT</code> ÊåáÂÆö‰∏Ä‰∏™Á∫ØÂ≠óÁ¨¶‰∏≤, Ëøô‰∏™Â≠óÁ¨¶‰∏≤Â∞Ü‰ºöÂú® <code>/bin/sh -c</code> ‰∏≠ÊâßË°å</p>
<p>Ëøô‰∏™ÂΩ¢ÂºèÂ∞Ü‰ºö‰ΩøÁî® shell Êù•Â§ÑÁêÜÁéØÂ¢ÉÂèòÈáèÊõøÊç¢, ÊâÄÊúâ <code>CMD</code> ÊàñËÄÖ <code>docker run</code> ÂëΩ‰ª§Ë°åÂèÇÊï∞ÈÉΩ‰ºöË¢´ÂøΩÁï•</p>
<p>‰∏∫‰∫ÜÁ°Æ‰øù <code>docker stop</code> ‰ºöÊ≠£Á°ÆÂú∞ÈÄöÁü•ÈïøÊó∂Èó¥ËøêË°åÁöÑ <code>ENTRYPOINT</code> ÂèØÊâßË°åÊñá‰ª∂, ËÆ∞Âæó‰ΩøÁî® <code>exec</code> Êù•ÂêØÂä®:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> <span class="built_in">exec</span> top -b</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰∏ç‰ΩøÁî® <code>exec</code> ÊâßË°åÂëΩ‰ª§, ÂàôÂêØÂä®ÂêéÁöÑÂëΩ‰ª§ÁöÑËøõÁ®ã PID Â∞Ü‰∏çÊòØ 1, Êó†Ê≥ïÊ≠£Â∏∏Êé•Êî∂Âà∞ <code>docker stop</code> ÂèëÈÄÅÁöÑ‰ø°Âè∑</p>
<h3 id="Understand-how-CMD-and-ENTRYPOINT-interact-ÁêÜËß£-CMD-Âíå-ENTRYPOINT-ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ"><a href="#Understand-how-CMD-and-ENTRYPOINT-interact-ÁêÜËß£-CMD-Âíå-ENTRYPOINT-ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ" class="headerlink" title="Understand how CMD and ENTRYPOINT interact (ÁêÜËß£ CMD Âíå ENTRYPOINT ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ)"></a>Understand how CMD and ENTRYPOINT interact (ÁêÜËß£ CMD Âíå ENTRYPOINT ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ)</h3><p><code>CMD</code> Âíå <code>ENTRYPOINT</code> Êåá‰ª§ÈÉΩÂÆö‰πâ‰∫ÜËøêË°åÂÆπÂô®Êó∂Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§</p>
<p>‰∏ãÈù¢ÊòØÊèèËø∞ÂÆÉ‰ª¨Âêà‰ΩúÁöÑËßÑÂàô:</p>
<ol>
<li>Dockerfile ÂøÖÈ°ªÊåáÂÆöËá≥Â∞ë‰∏Ä‰∏™ <code>CMD</code> Êàñ <code>ENTRYPOINT</code> ÂëΩ‰ª§</li>
<li>Â∞ÜÂÆπÂô®‰Ωú‰∏∫ÂèØÊâßË°åÊñá‰ª∂Êó∂Â∫îËØ•ÂÆö‰πâ <code>ENTRYPOINT</code></li>
<li><code>CMD</code> Â∫îËØ•Áî®‰Ωú ‰∏∫<code>ENTRYPOINT</code>ÂëΩ‰ª§ Êàñ Âú®ÂÆπÂô®‰∏≠ÊâßË°å‰∏¥Êó∂ÂëΩ‰ª§ ÂÆö‰πâÈªòËÆ§ÂèÇÊï∞ÁöÑ‰∏ÄÁßçÊñπÂºè</li>
<li>ËøêË°åÂÆπÂô®Êó∂ÁöÑÊõø‰ª£ÂèÇÊï∞‰ºöË¶ÜÁõñÊéâ <code>CMD</code></li>
</ol>
<p>Table - ‰∏çÂêå <code>ENTRYPOINT</code> &#x2F; <code>CMD</code> ÁªÑÂêà‰∏ã‰ºöÊâßË°åÁöÑÂëΩ‰ª§:</p>
<ul>
<li>| No ENTRYPOINT | ENTRYPOINT ENTRY_exec ENTRY_p1 | ENTRYPOINT [‚ÄúENTRY_exec‚Äù, ‚ÄúENTRY_p1‚Äù]<br>:‚Äî|:‚Äî|:‚Äî|:‚Äî<br>No CMD | error, not allowed | &#x2F;bin&#x2F;sh -c ENTRY_exec ENTRY_p1 | ENTRY_exec ENTRY_p1<br>CMD [‚ÄúCMD_exec‚Äù, ‚ÄúCMD_p1‚Äù] | CMD_exec CMD_p1 | &#x2F;bin&#x2F;sh -c ENTRY_exec ENTRY_p1 | ENTRY_exec ENTRY_p1 CMD_exec CMD_p1<br>CMD [‚ÄúCMD_p1‚Äù, ‚ÄúCMD_p2‚Äù] | CMD_p1 CMD_p2 | &#x2F;bin&#x2F;sh -c ENTRY_exec ENTRY_p1 | ENTRY_exec ENTRY_p1 CMD_p1 CMD_p2<br>CMD CMD_exec CMD_p1 | &#x2F;bin&#x2F;sh -c CMD_exec CMD_p1 | &#x2F;bin&#x2F;sh -c ENTRY_exec ENTRY_p1 | ENTRY_exec ENTRY_p1 &#x2F;bin&#x2F;sh -c CMD_exec CMD_p1</li>
</ul>
<p>Â¶ÇÊûú <code>CMD</code> ÊòØÂú®Âü∫Á°ÄÈïúÂÉè‰∏≠ÂÆö‰πâÁöÑ, ÈÇ£‰πàËÆæÁΩÆ <code>ENTRYPOINT</code> Â∞Ü‰ºöÈáçÁΩÆ <code>CMD</code> ‰∏∫Á©∫ÂÄº. Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, <code>CMD</code> ÂøÖÈ°ªÂú®ÂΩìÂâçÈïúÂÉè‰∏≠ÂÆö‰πâÊù•Ëµã‰∫à‰∏Ä‰∏™ÂÄº</p>
<h2 id="VOLUME-VOLUME-Êåá‰ª§"><a href="#VOLUME-VOLUME-Êåá‰ª§" class="headerlink" title="VOLUME (VOLUME Êåá‰ª§)"></a>VOLUME (VOLUME Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">VOLUME</span><span class="language-bash"> [<span class="string">&quot;/data&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>The VOLUME instruction creates a mount point with the specified name and marks it as holding externally mounted volumes from native host or other containers.</p>
</blockquote>
<p><code>VOLUME</code> Êåá‰ª§ÂàõÂª∫‰∏Ä‰∏™ÂÖ∑ÊúâÊåáÂÆöÂêçÁß∞ÁöÑÊåÇËΩΩÁÇπ, Âπ∂Â∞ÜÂÖ∂Ê†áËÆ∞‰∏∫ ‰øùÂ≠ò Êù•Ëá™Êú¨Âú∞‰∏ªÊú∫ÊàñÂÖ∂‰ªñÂÆπÂô®ÁöÑ Â§ñÈÉ®ÊåÇËΩΩÂç∑</p>
<p>ÂÄºÂèØ‰ª•ÊòØ‰∏Ä‰∏™ JSON Êï∞ÁªÑ, <code>VOLUME [&quot;/var/log/&quot;]</code>, ÊàñËÄÖÂ∏¶ÊúâÂ§ö‰∏™ÂèÇÊï∞ÁöÑÁ∫ØÂ≠óÁ¨¶‰∏≤, ‰æãÂ¶Ç <code>VOLUME /var/log</code> Êàñ <code>VOLUME /var/log /var/db</code></p>
<p>ÊúâÂÖ≥ÈÄöËøá Docker ÂÆ¢Êà∑Á´ØÁöÑÊõ¥Â§ö‰ø°ÊÅØ&#x2F;‰æãÂ≠êÂíåÊåÇËΩΩËØ¥Êòé, ËØ∑ÂèÇËÄÉ <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/storage/volumes/" >Share Directories via Volumes<i class="fas fa-external-link-alt"></i></a> ÊñáÊ°£</p>
<p><code>docker run</code> ÂëΩ‰ª§‰ΩøÁî®Âü∫Á°ÄÈïúÂÉè‰∏≠ ÊåáÂÆö‰ΩçÁΩÆ Â≠òÂú®ÁöÑ‰ªª‰ΩïÊï∞ÊçÆ ÂàùÂßãÂåñÊñ∞ÂàõÂª∫ÁöÑÂç∑</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> /myvol</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> &gt; /myvol/greeting</span></span><br><span class="line"><span class="keyword">VOLUME</span><span class="language-bash"> /myvol</span></span><br></pre></td></tr></table></figure>

<p>Ëøô‰∏™ Dockerfile ÁîüÊàê‰∏Ä‰∏™ÈïúÂÉè, Ëøô‰∏™ÈïúÂÉèÂØºËá¥ <code>docker run</code> Âú® <code>/myvol</code> ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊåÇËΩΩÁÇπ, Âπ∂Â∞Ü <code>/greeting</code> Êñá‰ª∂Â§çÂà∂Âà∞Êñ∞ÂàõÂª∫ÁöÑÂç∑‰∏≠</p>
<h3 id="Notes-about-specifying-volumes-ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π"><a href="#Notes-about-specifying-volumes-ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π" class="headerlink" title="Notes about specifying volumes (ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π)"></a>Notes about specifying volumes (ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π)</h3><p>ËØ∑ËÆ∞‰Ωè‰ª•‰∏ã <code>Dockerfile</code> ‰∏≠ÂÖ≥‰∫éÂç∑ÁöÑ‰∫ãÈ°π</p>
<ul>
<li><strong>Âü∫‰∫é Windows ÁöÑÂÆπÂô® ‰∏äÁöÑÂç∑</strong>: ÂΩì‰ΩøÁî®Âü∫‰∫é Windows ÁöÑÂÆπÂô®Êó∂, ÂÆπÂô®‰∏≠Âç∑ÁöÑÁõÆÁöÑÂú∞ÂøÖÈ°ªÊòØ‰ª•‰∏ã‰πã‰∏Ä<ul>
<li>‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊàñÁ©∫ÁöÑÁõÆÂΩï</li>
<li><code>C:</code> ‰πãÂ§ñÁöÑÈ©±Âä®Âô®</li>
</ul>
</li>
<li><strong>‰ªé <code>Dockerfile</code> ‰∏≠Êõ¥ÊîπÂç∑</strong>: Â¶ÇÊûú‰ªª‰ΩïÊûÑÂª∫Ê≠•È™§Âú®Âç∑Â£∞Êòé‰πãÂêé‰øÆÊîπ‰∫ÜÂç∑‰∏≠ÁöÑÊï∞ÊçÆ, ÂàôËøô‰∫õ‰øÆÊîπÂ∞ÜË¢´‰∏¢ÂºÉ</li>
<li><strong>JSON Ê†ºÂºè</strong>: Ëøô‰∏™ÂàóË°®‰Ωú‰∏∫‰∏Ä‰∏™ JSON Êï∞ÁªÑÊù•Ëß£Êûê. ‰Ω†ÂøÖÈ°ª‰ΩøÁî®ÂèåÂºïÂè∑Êù•ÂåÖË£πËØçËØ≠</li>
<li><strong>‰∏ªÊú∫ÁõÆÂΩïÊòØÂú®ÂÆπÂô®ËøêË°åÊó∂Â£∞ÊòéÁöÑ</strong>: ‰∏ªÊú∫ÁõÆÂΩï (ÊåÇËΩΩÁÇπ) Êú¨Ë¥®‰∏äÊòØ‰æùËµñ‰∫é‰∏ªÊú∫ÁöÑ. ËøôÊòØ‰∏∫‰∫Ü‰øùÊåÅÈïúÂÉèÁöÑÂèØÁßªÊ§çÊÄß, Âõ†‰∏∫‰∏çËÉΩ‰øùËØÅÁªôÂÆöÁöÑ‰∏ªÊú∫ÁõÆÂΩïÂú®ÊâÄÊúâ‰∏ªÊú∫‰∏äÈÉΩÂèØÁî®. ÊâÄ‰ª•, ‰Ω†‰∏çËÉΩ‰ªé Dockerfile ‰∏≠ÊåÇËΩΩ‰∏ªÊú∫ÁõÆÂΩï. <code>VOLUME</code> Êåá‰ª§‰∏çÊîØÊåÅÊåáÂÆö‰∏Ä‰∏™ <code>host-dir</code> ÂèÇÊï∞. ‰Ω†ÂøÖÈ°ªÂú®ÂàõÂª∫ÊàñËøêË°åÂÆπÂô®Êó∂ÊåáÂÆöÊåÇËΩΩÁÇπ</li>
</ul>
<h3 id="ÁêÜËß£"><a href="#ÁêÜËß£" class="headerlink" title="ÁêÜËß£"></a>ÁêÜËß£</h3><p>Â¶ÇÊûúËøêË°åÊó∂Áî®Êà∑ÂøòËÆ∞Â∞Ü‰øùÂ≠òÊñá‰ª∂ÁöÑÁõÆÂΩïÊåÇËΩΩ‰∏∫Âç∑, ÈÇ£‰πàÂ∞±‰ºöÂú®ÂÆπÂô®Â≠òÂÇ®Â±ÇÂèëÁîüÂÜôÊìç‰Ωú</p>
<p>ÂèØ‰ª•Âú® <code>Dockerfile</code> ‰∏≠‰∫ãÂÖàÊåáÂÆöÊüê‰∫õÁõÆÂΩïÊåÇËΩΩ‰∏∫<strong>ÂåøÂêçÂç∑</strong></p>
<p>ËøôÊ†∑Âú®ËøêË°åÊó∂Âç≥‰ΩøÁî®Êà∑‰∏çÊåáÂÆöÊåÇËΩΩ, ÂÆπÂô®‰πüÂèØ‰ª•Ê≠£Â∏∏ËøêË°å, ‰πü‰∏ç‰ºöÂêëÂÆπÂô®Â≠òÂÇ®Â±ÇÂÜôÂÖ•Â§ßÈáèÊï∞ÊçÆ</p>
<p>ÂΩìÂÆπÂô®ËøêË°åÊó∂, Â¶ÇÊûúÊú™‰ΩøÁî® <code>-v</code> ÊåáÂÆöÊåÇËΩΩÊàñÊú™‰ΩøÁî® <code>--mount</code> ÊåáÂÆöÊï∞ÊçÆÂç∑, ÈÇ£‰πà Docker Â∞Ü‰ºöËá™Âä®Âú® <code>/var/lib/docker/volumes/</code> ÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆÂç∑ (ÂèØ‰ª•‰ΩøÁî® <code>docker volume ls</code> Êü•ÁúãÂà∞Ëøô‰∏™Êï∞ÊçÆÂç∑), Âπ∂Â∞ÜËøô‰∏™Êï∞ÊçÆÂç∑ÊåÇËΩΩÂà∞ <code>VOLUME</code> ËÆæÂÆöÁöÑÁõÆÂΩï‰∏≠</p>
<h2 id="USER-USER-Êåá‰ª§"><a href="#USER-USER-Êåá‰ª§" class="headerlink" title="USER (USER Êåá‰ª§)"></a>USER (USER Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USER</span> &lt;<span class="keyword">user</span>&gt;[:&lt;group&gt;]</span><br></pre></td></tr></table></figure>

<p>ÊàñËÄÖ</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USER</span> &lt;UID&gt;[:&lt;GID&gt;]</span><br></pre></td></tr></table></figure>

<p><code>USER</code> Êåá‰ª§ËÆæÁΩÆ Âú®ËøêË°åÈïúÂÉèÊó∂ ‰∏é <code>Dockerfile</code>‰∏≠<code>USER</code>Êåá‰ª§‰πãÂêéÁöÑ‰ªª‰Ωï<code>RUN</code>,<code>CMD</code>,<code>ENTRYPOINT</code>Êåá‰ª§ ‰ΩøÁî®ÁöÑÁî®Êà∑ÂêçÁß∞ (ÊàñËÄÖ UID) ÂíåÂèØÈÄâÁöÑÁî®Êà∑ÁªÑ (ÊàñËÄÖ GID)</p>
<p>Ê≥®ÊÑè, ‰∏∫Áî®Êà∑ÊåáÂÆöÁî®Êà∑ÁªÑÊó∂, Áî®Êà∑Â∞Ü‰ªÖÂÖ∑ÊúâÊåáÂÆöÁöÑÁªÑÊàêÂëòËµÑÊ†º. Â∞ÜÂøΩÁï•‰ªª‰ΩïÂÖ∂‰ªñÈÖçÁΩÆÁöÑÁªÑÊàêÂëòË∫´‰ªΩ</p>
<p>ÂΩìÁî®Êà∑Ê≤°Êúâ‰∏Ä‰∏™‰∏ªË¶ÅÁªÑÊó∂, ÈïúÂÉè (Êàñ‰∏ã‰∏ÄÊù°Êåá‰ª§) Â∞Ü‰ºö‰ΩøÁî® <code>root</code> ÁªÑÊù•ËøêË°å</p>
<p>Âú® Windows ‰∏ä, Â¶ÇÊûúÁî®Êà∑‰∏çÊòØÂÜÖÁΩÆË¥¶Êà∑, ÂàôÂøÖÈ°ªÂÖàÂàõÂª∫ËØ•Áî®Êà∑. ÂèØ‰ª•ÈÄöËøáÂ∞Ü <code>net user</code> ÂëΩ‰ª§Ë∞ÉÁî®‰Ωú‰∏∫ Dockerfile ÁöÑ‰∏ÄÈÉ®ÂàÜÊù•ÂÆåÊàê</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> microsoft/windowsservercore</span><br><span class="line"><span class="comment"># Create Windows user in the container</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> net user /add patrick</span></span><br><span class="line"><span class="comment"># Set it for subsequent commands</span></span><br><span class="line"><span class="keyword">USER</span> patrick</span><br></pre></td></tr></table></figure>

<h2 id="WORKDIR-WORKDIR-Êåá‰ª§"><a href="#WORKDIR-WORKDIR-Êåá‰ª§" class="headerlink" title="WORKDIR (WORKDIR Êåá‰ª§)"></a>WORKDIR (WORKDIR Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /path/to/workdir</span></span><br></pre></td></tr></table></figure>

<p><code>WORKDIR</code> Êåá‰ª§‰∏∫ <code>Dockerfile</code> ‰∏≠ÊâÄÊúâ <code>RUN</code>,<code>CMD</code>,<code>ENTRYPOINT</code>,<code>COPY</code>,<code>ADD</code> Êåá‰ª§ËÆæÁΩÆÂ∑•‰ΩúÁõÆÂΩï</p>
<p>Â¶ÇÊûú <code>WORKDIR</code> ‰∏çÂ≠òÂú®, Âç≥‰ΩøÂú®ÈöèÂêéÁöÑ <code>Dockerfile</code> ÊâÄÊúâÊåá‰ª§‰∏≠ÈÉΩÊ≤°ÊúâÁî®‰∏ä, ÂÆÉËøòÊòØ‰ºöË¢´ÂàõÂª∫</p>
<p><code>WORKDIR</code> Êåá‰ª§ÂèØ‰ª•Âú® <code>Dockerfile</code> ‰∏≠‰ΩøÁî®Â§öÊ¨°. Â¶ÇÊûúÊèê‰æõ‰∫Ü‰∏Ä‰∏™Áõ∏ÂØπË∑ØÂæÑ, Ëøô‰∏™Ë∑ØÂæÑÂ∞Ü‰ºöÁõ∏ÂØπ‰∫é‰∏ä‰∏Ä‰∏™ <code>WORKDIR</code> Êåá‰ª§ÁöÑË∑ØÂæÑ</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /a</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> b</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> c</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">pwd</span></span></span><br></pre></td></tr></table></figure>

<p>Ëøô‰∏™ <code>Dockerfile</code> ‰∏≠ÁöÑ <code>pwd</code> ÂëΩ‰ª§ÁöÑÊúÄÁªàËæìÂá∫ÊòØ <code>/a/b/c</code></p>
<p><code>WORKDIR</code> Êåá‰ª§ÂèØ‰ª•Ëß£ÊûêÂÖàÂâç‰ΩøÁî® <code>ENV</code> ËÆæÁΩÆÁöÑÁéØÂ¢ÉÂèòÈáè. ‰Ω†Âè™ËÉΩ‰ΩøÁî®Âú® <code>Dockerfile</code> ‰∏≠ÊòéÁ°ÆËÆæÁΩÆÁöÑÁéØÂ¢ÉÂèòÈáè:</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> DIRPATH=/path</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$DIRPATH</span>/<span class="variable">$DIRNAME</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">pwd</span></span></span><br></pre></td></tr></table></figure>

<p>Âú® <code>Dockerfile</code> ‰∏≠ÊúÄÁªàÁöÑ <code>pwd</code> ÂëΩ‰ª§ÁöÑËæìÂá∫ÊòØ <code>/path/$DIRNAME</code></p>
<p>Â¶ÇÊûúÊ≤°ÊúâÊòéÁ°ÆÊåáÂÆö, ÈÇ£‰πàÈªòËÆ§ÁöÑÂ∑•‰ΩúÁõÆÂΩïÊòØ <code>/</code>. Âú®ÂÆûË∑µ‰∏≠, Â¶ÇÊûú‰Ω†‰∏çÊòØ‰ªéÂ§¥ÂºÄÂßã (<code>FROM scratch</code>) ÊûÑÂª∫ Dockerfile, ÈÇ£‰πà <code>WORKDIR</code> ÂæàÊúâÂèØËÉΩÁî±‰Ω†Ê≠£Âú®‰ΩøÁî®ÁöÑÂü∫Á°ÄÈïúÂÉèËÆæÁΩÆ</p>
<p>Âõ†Ê≠§, ‰∏∫‰∫ÜÈÅøÂÖçÂú®Êú™Áü•ÁõÆÂΩï‰∏ãÁöÑËøõË°åÊÑèÂ§ñÊìç‰Ωú, ÊúÄ‰Ω≥ÂÆûË∑µÊòØÊòéÁ°ÆËÆæÁΩÆ‰Ω†ÁöÑ <code>WORKDIR</code></p>
<h2 id="ARG-ARG-Êåá‰ª§"><a href="#ARG-ARG-Êåá‰ª§" class="headerlink" title="ARG (ARG Êåá‰ª§)"></a>ARG (ARG Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> &lt;name&gt;[=&lt;default value&gt;]</span><br></pre></td></tr></table></figure>

<p><code>ARG</code> Êåá‰ª§ÂÆö‰πâ‰∏Ä‰∏™ÂèòÈáè, Áî®Êà∑ÂèØ‰ª•Âú®ÊûÑÂª∫Êó∂‰ΩøÁî®Â∏¶Êúâ <code>--build-arg &lt;varname&gt;=&lt;value&gt;</code> Ê†áÂøóÁöÑ <code>docker build</code> ÂëΩ‰ª§Â∞ÜËøô‰∏™ÂèòÈáè‰º†ÈÄíÁªôÊûÑÂª∫Âô® (builder). Â¶ÇÊûúÁî®Êà∑ÊåáÂÆö‰∫Ü‰∏Ä‰∏™Ê≤°ÊúâÂú® Dockerfile ‰∏≠ÂÆö‰πâÁöÑÊûÑÂª∫ÂèÇÊï∞, ÈÇ£‰πàÊûÑÂª∫Â∞Ü‰ºöËæìÂá∫‰∏Ä‰∏™Ë≠¶Âëä: <code>[Warning] One or more build-args [foo] were not consumed.</code></p>
<p>‰∏Ä‰∏™ Dockerfile ÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™ <code>ARG</code> Êåá‰ª§</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="keyword">ARG</span> user1</span><br><span class="line"><span class="keyword">ARG</span> buildno</span><br></pre></td></tr></table></figure>

<p>Ë≠¶Âëä: ‰∏çÂª∫ËÆÆ‰ΩøÁî®ÊûÑÂª∫Êó∂ÂèòÈáè‰º†ÈÄíÊú∫ÂØÜ, ‰æãÂ¶Ç Github keys, Áî®Êà∑ËÆ§ËØÅÁ≠â. ÈÄöËøá <code>docker history</code> ÂëΩ‰ª§, ÊûÑÂª∫Êó∂ÂèòÈáèÂØπÊâÄÊúâ‰ΩøÁî®ÈïúÂÉèÁöÑÁî®Êà∑ÈÉΩÊòØÂèØËßÅÁöÑ. Êü•Áúã <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information" >build images with BuildKit<i class="fas fa-external-link-alt"></i></a> ÈÉ®ÂàÜ, ‰∫ÜËß£ÊûÑÂª∫ÈïúÂÉèÊó∂‰ΩøÁî®Êú∫ÂØÜÁöÑÂÆâÂÖ®ÊñπÊ≥ï</p>
<h3 id="Default-values-ÈªòËÆ§ÂÄº"><a href="#Default-values-ÈªòËÆ§ÂÄº" class="headerlink" title="Default values (ÈªòËÆ§ÂÄº)"></a>Default values (ÈªòËÆ§ÂÄº)</h3><p><code>ARG</code> Êåá‰ª§ÂèØ‰ª•ÈÄâÊã©ÂåÖÂê´ÈªòËÆ§ÂÄº:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="keyword">ARG</span> user1=someuser</span><br><span class="line"><span class="keyword">ARG</span> buildno=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú <code>ARG</code> Êåá‰ª§Êúâ‰∏Ä‰∏™ÈªòËÆ§ÂÄº, ‰ΩÜÊòØÂú®ÊûÑÂª∫Êó∂Ê≤°Êúâ‰º†ÈÄíÂÄºËøõÊù•, ÈÇ£‰πàÊûÑÂª∫Âô® (builder) ‰ΩøÁî®ÈªòËÆ§ÂÄº</p>
<h3 id="Scope-‰ΩúÁî®Âüü"><a href="#Scope-‰ΩúÁî®Âüü" class="headerlink" title="Scope (‰ΩúÁî®Âüü)"></a>Scope (‰ΩúÁî®Âüü)</h3><p><code>ARG</code> ÂèòÈáèÂÆö‰πâ‰ªéÂú® <code>Dockerfile</code> ‰∏≠ÂÆö‰πâÂÆÉÁöÑË°åÁöÑ‰ΩçÁΩÆÂºÄÂßãÁîüÊïà, ËÄå‰∏çÊòØ‰ªéÂëΩ‰ª§Ë°åÊàñËÄÖÂÖ∂‰ªñÂú∞ÊñπÁöÑÂèÇÊï∞‰ΩøÁî®ÂºÄÂßã</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="number">2</span> <span class="keyword">USER</span> $&#123;<span class="keyword">user</span>:-some_user&#125;</span><br><span class="line"><span class="number">3</span> <span class="keyword">ARG</span> <span class="keyword">user</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">USER</span> $<span class="keyword">user</span></span><br></pre></td></tr></table></figure>

<p>Example - Áî®Êà∑ÈÄöËøáËøôÊ†∑Ë∞ÉÁî®Êù•ÊûÑÂª∫Ëøô‰∏™Êñá‰ª∂:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build --build-arg user=what_user .</span><br></pre></td></tr></table></figure>

<p>Á¨¨ <code>2</code> Ë°åÁöÑ <code>USER</code> ËÆ°ÁÆóÁªìÊûú‰∏∫ <code>some_user</code>, Âõ†‰∏∫ <code>user</code> ÂèòÈáèÂú®ÈöèÂêéÁöÑÁ¨¨ <code>3</code> Ë°åÂÆö‰πâ</p>
<p>Á¨¨ <code>4</code> Ë°åÁöÑ <code>USER</code> ËÆ°ÁÆóÁªìÊûú‰∏∫ <code>what_user</code>, Âõ†‰∏∫ <code>user</code> Â∑≤ÁªèÂÆö‰πâ‰∏îÂÄº <code>what_user</code> Â∑≤Âú®ÂëΩ‰ª§Ë°å‰∏ä‰º†ÈÄí</p>
<p>Âú®ÈÄöËøá <code>ARG</code> Êåá‰ª§ÂÆö‰πâ‰πãÂâç, ÂØπÂèòÈáèÁöÑ‰ªª‰Ωï‰ΩøÁî®ÈÉΩ‰ºöÂØºËá¥Á©∫Â≠óÁ¨¶‰∏≤</p>
<p><code>ARG</code> Êåá‰ª§Âú®ÂÆö‰πâÂÆÉÁöÑÊûÑÂª∫Èò∂ÊÆµÁªìÊùüÊó∂Ë∂ÖÂá∫‰∫Ü (goes out of) ‰ΩúÁî®Âüü. Ë¶ÅÂú®Â§ö‰∏™Èò∂ÊÆµ‰ΩøÁî®‰∏Ä‰∏™ arg, ÊØè‰∏™Èò∂ÊÆµÂøÖÈ°ªÂåÖÂê´ <code>ARG</code> Êåá‰ª§</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="keyword">ARG</span> SETTINGS</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> ./run/setup <span class="variable">$SETTINGS</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="keyword">ARG</span> SETTINGS</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> ./run/other <span class="variable">$SETTINGS</span></span></span><br></pre></td></tr></table></figure>

<h3 id="Using-ARG-variables-‰ΩøÁî®-ARG-ÂèòÈáè"><a href="#Using-ARG-variables-‰ΩøÁî®-ARG-ÂèòÈáè" class="headerlink" title="Using ARG variables (‰ΩøÁî® ARG ÂèòÈáè)"></a>Using ARG variables (‰ΩøÁî® ARG ÂèòÈáè)</h3><p>‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>ARG</code> Êàñ <code>ENV</code> Êåá‰ª§Êù•ÊåáÂÆöÂèØÁî®‰∫é <code>RUN</code> Êåá‰ª§ÁöÑÂèòÈáè</p>
<p>‰ΩøÁî® <code>ENV</code> Êåá‰ª§ÂÆö‰πâÁöÑÁéØÂ¢ÉÂèòÈáèÊÄªÊòØË¶ÜÁõñÁõ∏ÂêåÂêçÂ≠óÁöÑ <code>ARG</code> Êåá‰ª§</p>
<p>Example - ËÄÉËôëËøô‰∏™Êúâ <code>ENV</code> Âíå <code>ARG</code> Êåá‰ª§ÁöÑ Dockerfile:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">ENV</span> CONT_IMG_VER=v1.<span class="number">0.0</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$CONT_IMG_VER</span></span></span><br></pre></td></tr></table></figure>

<p>ÁÑ∂Âêé, ÂÅáËÆæ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÊûÑÂª∫Ëøô‰∏™ÈïúÂÉè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build --build-arg CONT_IMG_VER=v2.0.1 .</span><br></pre></td></tr></table></figure>

<p>Âú®Ëøô‰∏™ÊÉÖÂÜµ‰∏ã, <code>RUN</code> Êåá‰ª§‰ΩøÁî® <code>v1.0.0</code> ËÄå‰∏çÊòØ ÈÄöËøáÁî®Êà∑‰º†ÈÄíÁªô <code>ARG</code> ÁöÑ <code>v2.0.1</code></p>
<p>Ëøô‰∏™Ë°å‰∏∫Á±ª‰ºº‰∫é shell ËÑöÊú¨, ÂÖ∂‰∏≠Â±ÄÈÉ®ËåÉÂõ¥ÁöÑÂèòÈáè‰ªéÂÆÉÁöÑÂÆö‰πâÁÇπ‰ºöË¶ÜÁõñ‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÊàñ‰ªéÁéØÂ¢ÉÁªßÊâøÁöÑÂèòÈáè</p>
<p>‰ΩøÁî®‰∏äÈù¢ÁöÑÁ§∫‰æã‰ΩÜÊòØ‰ΩøÁî®‰∏çÂêåÁöÑ <code>ENV</code> ËßÑËåÉ, ‰Ω†ÂèØ‰ª•Âú® <code>ARG</code> Âíå <code>ENV</code> Êåá‰ª§‰πãÈó¥ÂàõÂª∫Êõ¥ÊúâÁî®ÁöÑ‰∫§‰∫í:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">ENV</span> CONT_IMG_VER=$&#123;CONT_IMG_VER:-v1.<span class="number">0.0</span>&#125;</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$CONT_IMG_VER</span></span></span><br></pre></td></tr></table></figure>

<p>‰∏çÂÉè <code>ARG</code> Êåá‰ª§ ,<code>ENV</code> ÂÄºÂú®ÊûÑÂª∫ÁöÑÈïúÂÉè‰∏≠ÊåÅÁª≠Â≠òÂú®. ËÄÉËôë‰∏Ä‰∏™‰∏ç‰ΩøÁî® <code>--build-arg</code> Ê†áÂøóÁöÑ docker ÊûÑÂª∫: <code>$ docker build .</code></p>
<p>‰ΩøÁî®‰∏äËø∞‰æãÂ≠êÁöÑ Dockerfile, <code>CONT_IMG_VER</code> ËøòÊòØÊåÅÁª≠Â≠òÂú®‰∫éÈïúÂÉè‰∏≠, ‰ΩÜÊòØÂÆÉÁöÑÂÄºÂ∞Ü‰ºöÊòØ <code>v1.0.0</code>, Âõ†‰∏∫ÂÆÉÁöÑÈªòËÆ§ÂÄºÂú®Á¨¨ <code>3</code> Ë°åÈÄöËøá <code>ENV</code> Êåá‰ª§ËÆæÁΩÆ</p>
<p>Ëøô‰∏™‰æãÂ≠ê‰∏≠ÁöÑÂèòÈáèÊâ©Â±ïÊäÄÊúØÂÖÅËÆ∏‰Ω†‰ªéÂëΩ‰ª§Ë°å‰º†ÈÄíÂèÇÊï∞, Âπ∂ÈÄöËøáÂà©Áî® <code>ENV</code> Êåá‰ª§Â∞ÜÂÆÉ‰ª¨‰øùÂ≠òÂú®ÊúÄÁªàÈïúÂÉè‰∏≠</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#environment-replacement" >‰ªÖÊúâÈôêÁöÑ‰∏ÄÁªÑ Dockerfile Êåá‰ª§<i class="fas fa-external-link-alt"></i></a> ÊîØÊåÅÂèòÈáèÊâ©Â±ï</p>
<h3 id="Predefined-ARGs-È¢ÑÂÆö‰πâÁöÑ-ARGs"><a href="#Predefined-ARGs-È¢ÑÂÆö‰πâÁöÑ-ARGs" class="headerlink" title="Predefined ARGs (È¢ÑÂÆö‰πâÁöÑ ARGs)"></a>Predefined ARGs (È¢ÑÂÆö‰πâÁöÑ ARGs)</h3><p>Docker Êúâ‰∏ÄÁªÑÈ¢ÑÂÆö‰πâÁöÑ <code>ARG</code> ÂèòÈáè, ‰Ω†ÂèØ‰ª•Âú® Dockerfile ‰∏≠Ê≤°ÊúâÂØπÂ∫îÁöÑ <code>ARG</code> Êåá‰ª§ÁöÑÊÉÖÂÜµ‰∏ã‰ΩøÁî®Ëøô‰∫õÂèòÈáè</p>
<ul>
<li><code>HTTP_PROXY</code></li>
<li><code>http_proxy</code></li>
<li><code>HTTPS_PROXY</code></li>
<li><code>https_proxy</code></li>
<li><code>FTP_PROXY</code></li>
<li><code>ftp_proxy</code></li>
<li><code>NO_PROXY</code></li>
<li><code>no_proxy</code></li>
</ul>
<p>Ë¶Å‰ΩøÁî®Ëøô‰∫õÂèòÈáè, ‰ΩøÁî® <code>--build-arg</code> Ê†áÂøóÂú®ÂëΩ‰ª§Ë°å‰∏ä‰º†ÈÄíÂÆÉ‰ª¨, ‰æãÂ¶Ç: <code>$ docker build --build-arg HTTPS_PROXY=https://my-proxy.example.com</code></p>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ã, Ëøô‰∫õÈ¢ÑÂÆö‰πâÂèòÈáè‰ªé <code>docker history</code> ÁöÑËæìÂá∫‰∏≠ÊéíÈô§. ÊéíÈô§ÂÆÉ‰ª¨ÂèØ‰ª•Èôç‰ΩéÂú® <code>HTTP_PROXY</code> ÂèòÈáè‰∏≠ÊÑèÂ§ñÊ≥ÑÈú≤ÊïèÊÑüË∫´‰ªΩÈ™åËØÅ‰ø°ÊÅØÁöÑÈ£éÈô©</p>
<p>‰æãÂ¶Ç, ËÄÉËôë‰ΩøÁî® <code>--build-arg HTTP_PROXY=http://user:pass@proxy.lon.example.com</code> Êù•ÊûÑÂª∫‰∏ãÈù¢ÁöÑ Dockerfile:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>Âú®ËøôÁßçÊÉÖÂÜµ‰∏ã, <code>HTTP_PROXY</code> ÂèòÈáèÁöÑÂÄºÂú® <code>docker history</code> ‰∏≠ÊòØ‰∏çÂèØÁî®ÁöÑ, ‰∏î‰∏ç‰ºöË¢´ÁºìÂ≠ò. Â¶ÇÊûú‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÂùêÊ†á (location), ‰∏î‰Ω†ÁöÑ‰ª£ÁêÜÊúçÂä°Âô®‰øÆÊîπ‰∏∫ <code>http://user:pass@proxy.sfo.example.com</code>, ÂêéÁª≠ÁöÑÊûÑÂª∫‰∏ç‰ºöÂØºËá¥ÁºìÂ≠òÊú™ÂëΩ‰∏≠</p>
<p>Â¶ÇÊûú‰Ω†ÈúÄË¶ÅË¶ÜÁõñËøô‰∏™Ë°å‰∏∫, ‰Ω†ÂèØ‰ª•ÂÉè‰∏ãÈù¢ËøôÊ†∑ÈÄöËøáÂú® Dockerfile ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ <code>ARG</code> Êåá‰ª§:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> HTTP_PROXY</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>ÊûÑÂª∫Ëøô‰∏™ Dockerfile Êó∂, <code>HTTP_PROXY</code> ‰øùÁïôÂú® <code>docker history</code> ‰∏≠, Êõ¥ÊîπÂÖ∂ÂÄº‰ºö‰ΩøÊûÑÂª∫ÁºìÂ≠òÂ§±Êïà</p>
<h3 id="Automatic-platform-ARGs-in-the-global-scope-ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞-ARGs"><a href="#Automatic-platform-ARGs-in-the-global-scope-ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞-ARGs" class="headerlink" title="Automatic platform ARGs in the global scope (ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞ ARGs)"></a>Automatic platform ARGs in the global scope (ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞ ARGs)</h3><p>Ëøô‰∏™ÂäüËÉΩÂè™ÊúâÂú®‰ΩøÁî® <a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#buildkit" >BuildKit<i class="fas fa-external-link-alt"></i></a> Êó∂ÁîüÊïà</p>
<p>Docker È¢ÑÂÆö‰πâ‰∫Ü‰∏ÄÁªÑ <code>ARG</code> ÂèòÈáè, ÂÖ∂‰∏≠ÂåÖÂê´ÊúâÂÖ≥ÊâßË°åÊûÑÂª∫ÁöÑËäÇÁÇπÂπ≥Âè∞ (ÊûÑÂª∫Âπ≥Âè∞) ÂíåÁîüÊàêÈïúÂÉèÁöÑÂπ≥Âè∞ (ÁõÆÊ†áÂπ≥Âè∞) ÁöÑ‰ø°ÊÅØ</p>
<p>ÁõÆÊ†áÂπ≥Âè∞ÂèØ‰ª•‰ΩøÁî® <code>docker build</code> ‰∏äÁöÑ <code>--platform</code> Ê†áÂøóÊù•ÊåáÂÆö</p>
<p>Ëá™Âä®ËÆæÁΩÆÂ¶Ç‰∏ã <code>ARG</code> ÂèòÈáè:</p>
<ul>
<li><code>TARGETPLATFORM</code> - ÊûÑÂª∫ÁªìÊûúÁöÑÂπ≥Âè∞. ‰æãÂ¶Ç <code>linux/amd64</code>,<code>linux/arm/v7</code>,<code>windows/amd64</code></li>
<li><code>TARGETOS</code> - TARGETPLATFORM ÁöÑ OS ÁªÑ‰ª∂</li>
<li><code>TARGETARCH</code> - TARGETPLATFORM ÁöÑÊû∂ÊûÑÁªÑ‰ª∂</li>
<li><code>TARGETVARIANT</code> - TARGETPLATFORM ÁöÑÂèò‰Ωì (variant) ÁªÑ‰ª∂</li>
<li><code>BUILDPLATFORM</code> - ÊâßË°åÊûÑÂª∫ÁöÑËäÇÁÇπÂπ≥Âè∞</li>
<li><code>BUILDOS</code> - BUILDPLATFORM ÁöÑ OS ÁªÑ‰ª∂</li>
<li><code>BUILDARCH</code> - BUILDPLATFORM ÁöÑÊû∂ÊûÑÁªÑ‰ª∂</li>
<li><code>BUILDVARIANT</code> - BUILDPLATFORM ÁöÑÂèò‰Ωì (variant) ÁªÑ‰ª∂</li>
</ul>
<p>Ëøô‰∫õÂèÇÊï∞ÊòØÂú®ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÂÆö‰πâÁöÑ, Âõ†Ê≠§Âú®ÊûÑÂª∫Èò∂ÊÆµÊàñ‰Ω†ÁöÑ <code>RUN</code> ÂëΩ‰ª§‰∏≠‰∏ç‰ºöËá™Âä®‰ΩøÁî®. Ë¶ÅÂú®ÊûÑÂª∫Èò∂ÊÆµÊö¥Èú≤Ëøô‰∫õÂèÇÊï∞‰∏≠ÁöÑ‰∏Ä‰∏™, ‰∏çË¶ÅÂ£∞ÊòéÂÄºÁöÑÊñπÂºèÊù•ÈáçÊñ∞ÂÆö‰πâÂÆÉ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">ARG</span> TARGETPLATFORM</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;I&#x27;m building for <span class="variable">$TARGETPLATFORM</span>&quot;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="Impact-on-build-caching-ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç"><a href="#Impact-on-build-caching-ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç" class="headerlink" title="Impact on build caching (ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç)"></a>Impact on build caching (ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç)</h3><p><code>ARG</code> ÂèòÈáè‰∏çÊÉ≥ <code>ENV</code> ÂèòÈáèÈÇ£Ê†∑ÊåÅÁª≠Â≠òÂú®Âà∞ÊûÑÂª∫ÁöÑÈïúÂÉè‰∏≠</p>
<p>‰ΩÜÊòØ, <code>ARG</code> ÂèòÈáè‰ª•Á±ª‰ººÁöÑÊñπÂºèÂΩ±ÂìçÊûÑÂª∫ÁºìÂ≠ò</p>
<p>Â¶ÇÊûú‰∏Ä‰∏™ Dockerfile ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ <code>ARG</code> ÂèòÈáè, Ëøô‰∏™ÂèòÈáèÁöÑÂÄºÂíå‰πãÂâçÁöÑÊûÑÂª∫‰∏≠‰∏çÂêå, ÁÑ∂Âêé‰ºöÂú®Á¨¨‰∏ÄÊ¨°‰ΩøÁî®Ëøô‰∏™ÂèòÈáèÁöÑÊó∂ÂÄôÂèëÁîü ‚ÄúÁºìÂ≠ò‰∏çÂëΩ‰∏≠‚Äù, ËÄå‰∏çÊòØÂú®Ëøô‰∏™ÂèòÈáèÂÆö‰πâÁöÑÊó∂ÂÄô</p>
<p>ÁâπÂà´ÊòØ, Âú® <code>ARG</code> Êåá‰ª§‰πãÂêéÁöÑÊâÄÊúâ <code>RUN</code> Êåá‰ª§ÈÉΩÈöêÂºè‰ΩøÁî® <code>ARG</code> ÂèòÈáè (‰Ωú‰∏∫ÁéØÂ¢ÉÂèòÈáè), Âõ†Ê≠§ÂèØËÉΩÂØºËá¥ÁºìÂ≠òÊú™ÂëΩ‰∏≠</p>
<p>ÊâÄ‰ª•È¢ÑÂÆö‰πâÁöÑ <code>ARG</code> ÂèòÈáèÈÉΩÂÖç‰∫éÁºìÂ≠ò, Èô§Èùû Dockerfile ‰∏≠ÊúâÂåπÈÖçÁöÑ <code>ARG</code> ËØ≠Âè•</p>
<p>Example - ËÄÉËôëÂ¶Ç‰∏ã‰∏§‰∏™ Dockerfile:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$CONT_IMG_VER</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello</span></span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰Ω†Âú®ÂëΩ‰ª§Ë°å‰∏≠ÊåáÂÆö‰∫Ü <code>--build-arg CONT_IMG_VER=&lt;value&gt;</code>, Âú®‰∏§ÁßçÊÉÖÂÜµ‰∏ã, Á¨¨ <code>2</code> Ë°åÁöÑËßÑËåÉ‰∏ç‰ºöÂØºËá¥‰∏Ä‰∏™ÁºìÂ≠òÊú™ÂëΩ‰∏≠</p>
<p>Á¨¨ <code>3</code> Ë°åÂØºËá¥ÁºìÂ≠òÊú™ÂëΩ‰∏≠</p>
<p><code>ARG CONT_IMG_VER</code> ÂØºËá¥ <code>RUN</code> ÈÇ£Ë°åË¢´ËØÜÂà´‰∏∫‰∏éËøêË°å <code>CONT_IMG_VER=&lt;value&gt; echo hello</code> Áõ∏Âêå, Âõ†Ê≠§Â¶ÇÊûú <code>&lt;value&gt;</code> ÂèëÁîüÂèòÂåñ, Êàë‰ª¨‰ºöÂæóÂà∞ÁºìÂ≠òÊú™ÂëΩ‰∏≠</p>
<p>ËÄÉËôëÂêå‰∏ÄÂëΩ‰ª§Ë°å‰∏ãÁöÑÂè¶‰∏Ä‰∏™Á§∫‰æã:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">ENV</span> CONT_IMG_VER=$CONT_IMG_VER</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$CONT_IMG_VER</span></span></span><br></pre></td></tr></table></figure>

<p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠, ÁºìÂ≠òÊú™ÂëΩ‰∏≠ÂèëÁîüÂú®Á¨¨‰∏âË°å. ÂèëÁîüÊú™ÂëΩ‰∏≠ÊòØÂõ†‰∏∫ <code>ENV</code> ‰∏≠ÂèòÈáèÁöÑÂÄºÂºïÁî® <code>ARG</code> ÂèòÈáè‰∏îËøô‰∏™ <code>ARG</code> ÂèòÈáèÈÄöËøáÂëΩ‰ª§Ë°åÊîπÂèò‰∫Ü. Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠, <code>ENV</code> ÂëΩ‰ª§ÂØºËá¥ÈïúÂÉèÂåÖÂê´‰∫ÜËøô‰∏™ÂÄº</p>
<p>Â¶ÇÊûú <code>ENV</code> Êåá‰ª§Ë¶ÜÁõñÂêåÂêçÁöÑ <code>ARG</code> Êåá‰ª§:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ARG</span> CONT_IMG_VER</span><br><span class="line"><span class="keyword">ENV</span> CONT_IMG_VER=hello</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$CONT_IMG_VER</span></span></span><br></pre></td></tr></table></figure>

<p>Á¨¨ <code>3</code> Ë°å‰∏ç‰ºöÂØºËá¥‰∏Ä‰∏™ÁºìÂ≠òÊú™ÂëΩ‰∏≠, Âõ†‰∏∫ <code>CONT_IMG_VER</code> ÁöÑÂÄºÊòØ‰∏Ä‰∏™Â∏∏Èáè (<code>hello</code>). Âõ†Ê≠§, Âú® <code>RUN</code> (Á¨¨ <code>4</code> Ë°å) ‰∏≠‰ΩøÁî®ÁöÑÁéØÂ¢ÉÂèòÈáèÂíåÂÄºÂú®ÊûÑÂª∫‰πãÈó¥‰∏ç‰ºöÂèëÁîüÂèòÂåñ</p>
<h2 id="ONBUILD-ONBUILD-Êåá‰ª§"><a href="#ONBUILD-ONBUILD-Êåá‰ª§" class="headerlink" title="ONBUILD (ONBUILD Êåá‰ª§)"></a>ONBUILD (ONBUILD Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ONBUILD</span> &lt;INSTRUCTION&gt;</span><br></pre></td></tr></table></figure>

<p><code>ONBUILD</code> Êåá‰ª§Â∞Ü <code>trigger</code> Êåá‰ª§Ê∑ªÂä†Âà∞ÈïúÂÉè‰∏≠, ‰ª•‰æøÁ®çÂêéÊâßË°å, Ê≠§Êó∂Ëøô‰∏™ÈïúÂÉèÁî®‰ΩúÂè¶‰∏Ä‰∏™ÊûÑÂª∫ÁöÑÂü∫Á°Ä</p>
<p><code>trigger</code> Â∞ÜÂú®‰∏ãÊ∏∏ÊûÑÂª∫ÁöÑ‰∏ä‰∏ãÊñá‰∏≠ÊâßË°å ,Â∞±Â•ΩÂÉèÂÆÉÊòØÂú®‰∏ãÊ∏∏ <code>Dockerfile</code> ‰∏≠ÁöÑ <code>FROM</code> Êåá‰ª§‰πãÂêéÁ´ãÂç≥ÊèíÂÖ•ÁöÑ‰∏ÄÊ†∑</p>
<p>‰ªª‰ΩïÊûÑÂª∫Êåá‰ª§ÈÉΩÂèØ‰ª•Ê≥®ÂÜå‰∏∫ <code>trigger</code></p>
<p>ËøôÂú®‰Ω†ÊûÑÂª∫‰∏Ä‰∏™ Áî®‰ΩúÊûÑÂª∫ÂÖ∂‰ªñÈïúÂÉèÁöÑÂü∫Á°Ä ÁöÑÈïúÂÉèÊó∂ÂæàÊúâÁî®, ‰æãÂ¶Ç‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÊûÑÂª∫ÁéØÂ¢ÉÊàñËÄÖ‰∏Ä‰∏™ÂèØ‰ª•‰ΩøÁî®Áî®Êà∑ÁâπÂÆöÈÖçÁΩÆËá™ÂÆö‰πâÁöÑÂÆàÊä§ËøõÁ®ã</p>
<p>‰æãÂ¶Ç, Â¶ÇÊûú‰Ω†ÁöÑÈïúÂÉèÊòØ‰∏Ä‰∏™ÂèØÈáçÂ§ç‰ΩøÁî®ÁöÑ Python Â∫îÁî®Á®ãÂ∫èÊûÑÂª∫Âô® ,ÂÆÉË¶ÅÊ±ÇÊ∑ªÂä†Â∫îÁî®Á®ãÂ∫èÊ∫ê‰ª£Á†ÅÂà∞‰∏Ä‰∏™ÊåáÂÆöÁöÑÁõÆÂΩï, ÁÑ∂ÂêéÂèØËÉΩÈúÄË¶ÅÂú®Ê≠§‰πãÂêéË∞ÉÁî®ÁöÑÊûÑÂª∫ËÑöÊú¨</p>
<p>Áé∞Âú®‰Ω†Ëøò‰∏çËÉΩÂ∞±Ë∞ÉÁî® <code>ADD</code> Âíå <code>RUN</code>, Âõ†‰∏∫‰Ω†Ëøò‰∏çËÉΩËÆøÈóÆÂ∫îÁî®Á®ãÂ∫èÊ∫ê‰ª£Á†Å, Âπ∂‰∏îÊØè‰∏™Â∫îÁî®Á®ãÂ∫èÊûÑÂª∫ÈÉΩ‰ºö‰∏ç‰∏ÄÊ†∑</p>
<p>‰Ω†ÂèØ‰ª•ÁÆÄÂçïÂú∞‰∏∫Â∫îÁî®Á®ãÂ∫èÂºÄÂèë‰∫∫ÂëòÊèê‰æõÊ®°Êùø <code>Dockerfile</code> ‰ª•Â∞ÜÂÖ∂Â§çÂà∂Á≤òË¥¥Âà∞‰ªñ‰ª¨ÁöÑÂ∫îÁî®Á®ãÂ∫è‰∏≠, ‰ΩÜËøôÊ†∑ÊïàÁéá‰Ωé‰∏ã, ÂÆπÊòìÂá∫Èîô‰∏îÈöæ‰ª•Êõ¥Êñ∞, Âõ†‰∏∫ÂÆÉ‰∏éÁâπÂÆöÂ∫îÁî®Á®ãÂ∫è‰ª£Á†ÅÊ∑∑ÂêàÂú®‰∏ÄËµ∑</p>
<p>Ëß£ÂÜ≥ÊñπÊ≥ïÊòØ‰ΩøÁî® <code>ONBUILD</code> Ê≥®ÂÜåÈ¢ÑÂÆö‰πâÊåá‰ª§, ‰ª•‰æøÁ®çÂêéÂú®‰∏ã‰∏Ä‰∏™ÊûÑÂª∫Èò∂ÊÆµËøêË°å</p>
<p>ÂÆÉÊòØËøôÊ†∑Â∑•‰ΩúÁöÑ:</p>
<ol>
<li>ÂΩìÈÅáÂà∞‰∏Ä‰∏™ <code>ONBUILD</code> Êåá‰ª§Êó∂, ÊûÑÂª∫Âô®Â∞Ü‰∏Ä‰∏™ trigger Ê∑ªÂä†Âà∞Ê≠£Âú®ÊûÑÂª∫ÁöÑÈïúÂÉèÁöÑÂÖÉÊï∞ÊçÆ‰∏≠. <code>ONBUILD</code> Êåá‰ª§‰∏ç‰ºöÂΩ±ÂìçÂΩìÂâçÁöÑÊûÑÂª∫</li>
<li>Âú®ÊûÑÂª∫ÁªìÊùüÊó∂, ÊâÄÊúâËß¶ÂèëÂô®ÁöÑÂàóË°®Â≠òÂÇ®Âà∞ÈïúÂÉèÊ∏ÖÂçï (manifest) ‰∏≠, Âú® <code>ONBUILD</code> ÈîÆ‰∏ã. ÂÆÉ‰ª¨ÂèØ‰ª•‰ΩøÁî® <code>docker inspect</code> ÂëΩ‰ª§Êù•Ê£ÄÊü•</li>
<li>ÁÑ∂ÂêéËøô‰∏™ÈïúÂÉèÂèØËÉΩÁî®ÂÅö‰∏Ä‰∏™Êñ∞ÊûÑÂª∫ÁöÑÂü∫Á°ÄÈïúÂÉè, ‰ΩøÁî® <code>FROM</code> Êåá‰ª§. ‰Ωú‰∏∫Â§ÑÁêÜ <code>FROM</code> Êåá‰ª§ÁöÑ‰∏ÄÈÉ®ÂàÜ, ‰∏ãÊ∏∏ÊûÑÂª∫Âô®Êü•Êâæ <code>ONBUILD</code> triggers, Âπ∂ÊåâÂÆÉ‰ª¨Ê≥®ÂÜåÁöÑÁõ∏ÂêåÈ°∫Â∫èÊâßË°åÂÆÉ‰ª¨. Â¶ÇÊûú‰ªª‰ΩïËß¶ÂèëÂô®Â§±Ë¥•, <code>FROM</code> Êåá‰ª§Â∞ÜË¢´‰∏≠Ê≠¢, ËøôÂèçËøáÊù•ÂØºËá¥ÊûÑÂª∫Â§±Ë¥•. Â¶ÇÊûúÊâÄÊúâ triggers ÈÉΩÊâßË°åÊàêÂäü, Âàô <code>FROM</code> Êåá‰ª§ÂÆåÊàêÂπ∂‰∏îÊûÑÂª∫ÁÖßÂ∏∏ÁªßÁª≠ËøõË°å</li>
<li>Ëß¶ÂèëÂô®Âú®ÊâßË°åÂêé‰ºö‰ªéÊúÄÁªàÈïúÂÉè‰∏≠Ê∏ÖÈô§. Êç¢Âè•ËØùËØ¥, ÂÆÉ‰ª¨‰∏ç‰ºöË¢´‰∏ã‰∏ã‰∏™ÊûÑÂª∫ÁªßÊâø</li>
</ol>
<p>Example - ‰Ω†ÂèØ‰ª•Ê∑ªÂä†ËøôÊ†∑ÁöÑ‰∏úË•ø:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ONBUILD</span> <span class="keyword">ADD</span><span class="language-bash"> . /app/src</span></span><br><span class="line"><span class="keyword">ONBUILD</span> <span class="keyword">RUN</span><span class="language-bash"> /usr/local/bin/python-build --<span class="built_in">dir</span> /app/src</span></span><br></pre></td></tr></table></figure>

<p>Ë≠¶Âëä: ‰∏çÂÖÅËÆ∏‰ΩøÁî® <code>ONBUILD ONBUILD</code> ÁöÑÈìæÂºè <code>ONBUILD</code> Êåá‰ª§</p>
<p>Ë≠¶Âëä: <code>ONBUILD</code> Êåá‰ª§ÂèØËÉΩ‰∏ç‰ºöËß¶Âèë <code>FROM</code> Êàñ <code>MAINTAINER</code> Êåá‰ª§</p>
<h2 id="STOPSIGNAL-STOPSIGNAL-Êåá‰ª§"><a href="#STOPSIGNAL-STOPSIGNAL-Êåá‰ª§" class="headerlink" title="STOPSIGNAL (STOPSIGNAL Êåá‰ª§)"></a>STOPSIGNAL (STOPSIGNAL Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">STOPSIGNAL</span> signal</span><br></pre></td></tr></table></figure>

<p><code>STOPSIGNAL</code> Êåá‰ª§ËÆæÁΩÆÁ≥ªÁªüË∞ÉÁî®‰ø°Âè∑, Ëøô‰∏™‰ø°Âè∑Â∞ÜË¢´ÂèëÈÄÅÂà∞ÂÆπÂô®‰ª•ÈÄÄÂá∫</p>
<p>Ëøô‰∏™‰ø°Âè∑ÂèØ‰ª•ÊòØÊ†ºÂºè‰∏∫ <code>SIG&lt;NAME&gt;</code> ÁöÑ‰ø°Âè∑ÂêçÁß∞, ‰æãÂ¶Ç <code>SIGKILL</code>, ‰πüÂèØ‰ª•ÊòØÂåπÈÖçÂÜÖÊ†∏Á≥ªÁªüË∞ÉÁî®Ë°®‰∏≠Êüê‰∏™‰ΩçÁΩÆÁöÑÊó†Á¨¶Âè∑Êï∞ÂÄº, ‰æãÂ¶Ç <code>9</code>. Â¶ÇÊûúÊ≤°ÊúâÂÆö‰πâÂàôÈªòËÆ§ÂÄºÊòØ <code>SIGTERM</code></p>
<p>ÂèØ‰ª•Ë¶ÜÁõñÊØè‰∏™ÂÆπÂô®ÁöÑÈïúÂÉèÁöÑÈªòËÆ§ÂÅúÊ≠¢‰ø°Âè∑, Âú® <code>docker run</code> Âíå <code>docker create</code> ‰∏ä‰ΩøÁî® <code>--stop-signal</code> Ê†áÂøó</p>
<h2 id="HEALTHCHECK-HEALTHCHECK-Êåá‰ª§"><a href="#HEALTHCHECK-HEALTHCHECK-Êåá‰ª§" class="headerlink" title="HEALTHCHECK (HEALTHCHECK Êåá‰ª§)"></a>HEALTHCHECK (HEALTHCHECK Êåá‰ª§)</h2><p><code>HEALTHCHECK</code> Êåá‰ª§Êúâ‰∏§ÁßçÂΩ¢Âºè:</p>
<ul>
<li><code>HEALTHCHECK [OPTIONS] CMD command</code> (ÈÄöËøáÂú®ÂÆπÂô®‰∏≠ËøêË°å‰∏Ä‰∏™ÂëΩ‰ª§Êù•Ê£ÄÊü•ÂÆπÂô®ÂÅ•Â∫∑)</li>
<li><code>HEALTHCHECK NONE</code> (ÂÖ≥Èó≠ÊâÄÊúâ‰ªéÂü∫Á°ÄÈïúÂÉèÁªßÊâøÁöÑÂÅ•Â∫∑Ê£ÄÊü•)</li>
</ul>
<p><code>HEALTHCHECK</code> Êåá‰ª§ÂëäËØâ Docker ÊÄéÊ†∑ÊµãËØï‰∏Ä‰∏™ÂÆπÂô®, Ê£ÄÊü•ÂÆÉÊòØÂê¶ËøòÂ∑•‰Ωú. ËøôÂèØ‰ª•Ê£ÄÊµãËØ∏Â¶Ç Web ÊúçÂä°Âô®Èô∑ÂÖ•Êó†ÈôêÂæ™ÁéØÂπ∂‰∏îÊó†Ê≥ïÂ§ÑÁêÜÊñ∞ËøûÊé•ÁöÑÊÉÖÂÜµ, Âç≥‰ΩøÊúçÂä°Âô®ËøõÁ®ã‰ªçÂú®ËøêË°å</p>
<p>ÂΩìÂÆπÂô®ÊåáÂÆö‰∫ÜÂÅ•Â∫∑Ê£ÄÊü•Êó∂, Èô§‰∫ÜÊ≠£Â∏∏Áä∂ÊÄÅÂ§ñ, ÂÆÉËøòÂÖ∑ÊúâÂÅ•Â∫∑Áä∂ÊÄÅ. Ëøô‰∏™ÂÅ•Â∫∑Áä∂ÊÄÅ‰ª• <code>starting</code> ‰∏∫ÂàùÂßãÁä∂ÊÄÅ. ÊØèÂΩìÂÅ•Â∫∑Ê£ÄÊü•ÈÄöËøáÊó∂, ÂÆÉÂ∞±‰ºöÂèòÊàê <code>healthy</code> (Êó†ËÆ∫ÂÆÉ‰ª•ÂâçÂ§Ñ‰∫é‰ªÄ‰πàÁä∂ÊÄÅ). Âú®ËøûÁª≠Â§±Ë¥•‰∏ÄÂÆöÊ¨°Êï∞Âêé, ÂÆÉÂèòÊàê <code>unhealthy</code> Áä∂ÊÄÅ</p>
<p>ÂèØ‰ª•Âá∫Áé∞Âú® <code>CMD</code> ÂâçÁöÑÈÄâÈ°πÊòØ:</p>
<ul>
<li><code>--interval=DURATION</code> (ÈªòËÆ§: <code>30s</code>)</li>
<li><code>--timeout=DURATION</code> (ÈªòËÆ§: <code>30s</code>)</li>
<li><code>--start-period=DURATION</code> (ÈªòËÆ§: <code>0s</code>)</li>
<li><code>--retries=N</code> (ÈªòËÆ§: <code>3</code>)</li>
</ul>
<p>ÂÅ•Â∫∑Ê£ÄÊü•‰ºöÂú®ÂÆπÂô®ÂêØÂä®ÂêéÈó¥Èöî <strong>interval</strong> ÁßíÂêéÁ¨¨‰∏ÄÊ¨°ÊâßË°å, ÁÑ∂ÂêéÂú®ÊØèÊ¨°Ê£ÄÊü•ÁªìÊùüÂêéÂÜçÈó¥Èöî <strong>interval</strong> ÁßíÊâßË°å</p>
<p>Â¶ÇÊûúÂçï‰∏™Ê£ÄÊü•‰ªªÂä°ËøêË°åË∂ÖËøá <strong>timeout</strong> Áßí, ÂàôËÆ§‰∏∫Ê£ÄÊü•Â§±Ë¥•</p>
<p>ÂÆπÂô®ËøûÁª≠ÈáçËØï <strong>retries</strong> Ê¨°ÂÅ•Â∫∑Ê£ÄÊü•Â§±Ë¥•ÂàôÂÆπÂô®Ë¢´ËÆ§‰∏∫ÊòØ <code>unhealthy</code></p>
<p><code>start period</code> ‰∏∫ÈúÄË¶ÅÊó∂Èó¥ÂêØÂä®ÁöÑÂÆπÂô®Êèê‰æõÂàùÂßãÂåñÊó∂Èó¥. Âú®Ê≠§ÊúüÈó¥ÁöÑÊé¢ÊµãÂ§±Ë¥•‰∏ç‰ºöË¢´ËÆ°ÂÖ•ÊúÄÂ§ßÈáçËØïÊ¨°Êï∞</p>
<p>‰ΩÜÊòØ, Â¶ÇÊûúÂÅ•Â∫∑Ê£ÄÊü•Âú®ÂêØÂä®Èó¥ÈöîÊúüÈó¥ÊàêÂäü‰∫Ü, ÈÇ£‰πàÂÆπÂô®ÂàôË¢´ËÆ§‰∏∫ÊòØÂ∑≤ÁªèÂêØÂä®ÁöÑÂπ∂‰∏îÊâÄÊúâËøûÁª≠Â§±Ë¥•ÈÉΩËÆ°ÂÖ•ÊúÄÂ§ßÈáçËØïÊ¨°Êï∞</p>
<p>Âú® Dockerfile ‰∏≠Âè™ËÉΩÊúâ‰∏Ä‰∏™ <code>HEALTHCHECK</code> Êåá‰ª§. Â¶ÇÊûú‰Ω†ÊåáÂÆö‰∫ÜÂ§ö‰∏™ <code>HEALTHCHECK</code> Êåá‰ª§, ÈÇ£‰πàÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™ <code>HEALTHCHECK</code> Êåá‰ª§ÁîüÊïà</p>
<p><code>CMD</code> ÂÖ≥ÈîÆÂ≠óÂêéÈù¢ÁöÑÂëΩ‰ª§ÂèØ‰ª•ÊòØ‰∏Ä‰∏™ shell ÂëΩ‰ª§ (‰æãÂ¶Ç, <code>HEALTHCHECK CMD /bin/check-running</code>) ÊàñËÄÖ‰∏Ä‰∏™ <code>exec</code> Êï∞ÁªÑ</p>
<p>ÂëΩ‰ª§ÁöÑÈÄÄÂá∫Áä∂ÊÄÅÊåáÊòé‰∫ÜÂÆπÂô®ÁöÑÂÅ•Â∫∑Áä∂ÊÄÅ. ÂèØËÉΩÁöÑÂÄº:</p>
<ul>
<li><code>0</code>: ÊàêÂäü - ÂÆπÂô®ÊòØÂÅ•Â∫∑ÁöÑ‰∏îÂèØ‰ª•‰ΩøÁî®‰∫Ü</li>
<li><code>1</code>: ‰∏çÂÅ•Â∫∑ÁöÑ - ÂÆπÂô®Ê≤°ÊúâÊ≠£Á°ÆÂú∞Â∑•‰Ωú</li>
<li><code>2</code>: ‰øùÁïôÁöÑ - ‰∏çË¶Å‰ΩøÁî®Ëøô‰∏™ÈÄÄÂá∫Á†Å</li>
</ul>
<p>Example - ÊØè‰∫îÂàÜÈíüÊ£ÄÊü•‰∏ÄÊ¨°ÁΩëÁªúÊúçÂä°Âô®ÊòØÂê¶ËÉΩÂ§üÂú®‰∏âÁßíÂÜÖ‰∏∫ÁΩëÁ´ô‰∏ªÈ°µÊèê‰æõÊúçÂä°:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">HEALTHCHECK</span><span class="language-bash"> --interval=5m --<span class="built_in">timeout</span>=3s CMD curl -f http://localhost/ || <span class="built_in">exit</span> 1</span></span><br></pre></td></tr></table></figure>

<p>‰∏∫‰∫ÜÂ∏ÆÂä©Ë∞ÉËØïÂ§±Ë¥•ÁöÑÊé¢Èíà, ÂëΩ‰ª§ÂÜôÂà∞ stdout&#x2F;stderr ÁöÑ‰ªª‰ΩïËæìÂá∫ÊñáÊú¨ (UTF-8 ÁºñÁ†ÅÁöÑ)ÈÉΩ‰ºöË¢´Â≠òÂÇ®Âà∞ÂÅ•Â∫∑Áä∂ÊÄÅ‰∏≠, Âπ∂‰∏îÂèØ‰ª•‰ΩøÁî® <code>docker inspect</code> Êù•Êü•ËØ¢. ËøôÊ†∑ÁöÑËæìÂá∫ÊñáÊú¨Ë¶Å‰øùÂ≠òÁü≠Â∞è (ÂΩìÂâçÂè™ÊúâÂ§¥ 4096 Â≠óËäÇ‰ºöË¢´Â≠òÂÇ®)</p>
<p>ÂΩì‰∏Ä‰∏™ÂÆπÂô®ÁöÑÂÅ•Â∫∑Áä∂ÊÄÅÊîπÂèò‰∫Ü, Â∞Ü‰ºö‰∫ßÁîü‰∏Ä‰∏™Â∏¶ÊúâÊñ∞Áä∂ÊÄÅÁöÑ <code>health_status</code></p>
<h2 id="SHELL-SHELL-Êåá‰ª§"><a href="#SHELL-SHELL-Êåá‰ª§" class="headerlink" title="SHELL (SHELL Êåá‰ª§)"></a>SHELL (SHELL Êåá‰ª§)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHELL</span><span class="language-bash"> [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;parameters&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p><code>SHELL</code> Êåá‰ª§ÂÖÅËÆ∏Ë¶ÜÁõñÁî®‰∫éÂëΩ‰ª§ÁöÑ <code>shell</code> ÂΩ¢ÂºèÁöÑÈªòËÆ§ shell</p>
<p>Linux ‰∏äÁöÑÈªòËÆ§ shell ÊòØ <code>[&quot;/bin/sh&quot;, &quot;-c&quot;]</code>, Âú® Windows ‰∏äÊòØ <code>[&quot;cmd&quot;, &quot;/S&quot;, &quot;/C&quot;]</code></p>
<p>Âú® Dockerfile ‰∏≠ <code>SHELL</code> Êåá‰ª§ÂøÖÈ°ª‰ΩøÁî® JSON ÂΩ¢ÂºèÊù•ÁºñÂÜô</p>
<p><code>SHELL</code> Êåá‰ª§Âú® Windows ‰∏äÁâπÂà´ÊúâÁî®, Windows ‰∏äÊúâ‰∏§‰∏™Â∏∏Áî®‰∏îÈùûÂ∏∏‰∏çÂêåÁöÑÊú¨Âú∞ shell: <code>cmd</code> Âíå <code>powershell</code>, ‰ª•ÂèäÂåÖÊã¨ <code>sh</code> Âú®ÂÜÖÁöÑÂ§áÁî® shells</p>
<p><code>SHELL</code> Êåá‰ª§ÂèØ‰ª•Âá∫Áé∞Â§öÊ¨°. ÊØè‰∏™ <code>SHELL</code> Êåá‰ª§Ë¶ÜÁõñÂâçÈù¢ÊâÄÊúâÈ¢ù <code>SHELL</code> Êåá‰ª§, Âπ∂ÂΩ±ÂìçÊâÄÊúâÊé•‰∏ãÊù•ÁöÑÊåá‰ª§</p>
<p>Example:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> microsoft/windowsservercore</span><br><span class="line"><span class="comment"># Executed as cmd /S /C echo default</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> default</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Executed as cmd /S /C powershell -command Write-Host default</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> powershell -<span class="built_in">command</span> Write-Host default</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Executed as powershell -command Write-Host hello</span></span><br><span class="line"><span class="keyword">SHELL</span><span class="language-bash"> [<span class="string">&quot;powershell&quot;</span>, <span class="string">&quot;-command&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> Write-Host hello</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Executed as cmd /S /C echo hello</span></span><br><span class="line"><span class="keyword">SHELL</span><span class="language-bash"> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;/S&quot;</span>, <span class="string">&quot;/C&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> hello</span></span><br></pre></td></tr></table></figure>

<p>Ëøô‰∫õÊåá‰ª§Âú® Dockerfile ‰∏≠‰ΩøÁî®ÂÆÉ‰ª¨ÁöÑ <code>shell</code> ÂΩ¢ÂºèÊó∂‰ºöÂèóÂà∞ <code>SHELL</code> Êåá‰ª§ÁöÑÂΩ±Âìç: <code>RUN</code>,<code>CMD</code>,<code>ENTRYPOINT</code></p>
<p>‰ª•‰∏ãÁ§∫‰æãÊòØÂú® Windows ‰∏äÂèëÁé∞ÁöÑÂ∏∏ËßÅÊ®°Âºè, ÂèØ‰ª•‰ΩøÁî® <code>SHELL</code> Êåá‰ª§ËøõË°åÁÆÄÂåñ:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> powershell -<span class="built_in">command</span> Execute-MyCmdlet -param1 <span class="string">&quot;c:\foo.txt&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>Ë¢´ docker ÊâßË°åÁöÑÂëΩ‰ª§Â∞Ü‰ºöÊòØ: <code>cmd /S /C powershell -command Execute-MyCmdlet -param1 &quot;c:\foo.txt&quot;</code></p>
<p>ËøôÊ†∑ÂÅöÊúâ‰∏§‰∏™‰∏çÈ´òÊïàÁöÑÁêÜÁî±. È¶ñÂÖà, Ë∞ÉÁî®‰∫Ü‰∏Ä‰∏™Ê≤°ÊúâÂøÖË¶ÅÁöÑ cmd.ext ÂëΩ‰ª§ËøõÁ®ã (ÂèàÂêç shell). ÂÖ∂Ê¨°, ÊØè‰∏™‰ΩøÁî® <code>shell</code> ÂΩ¢ÂºèÁöÑ <code>RUN</code> Êåá‰ª§Ë¶ÅÊ±Ç‰∏Ä‰∏™È¢ùÂ§ñÁöÑ <code>powershell -command</code> ‰Ωú‰∏∫ÂëΩ‰ª§ÁöÑÂâçÁºÄ</p>
<p>‰∏∫‰∫ÜËÆ©ÂÖ∂Êõ¥Âä†È´òÊïà, ÂèØ‰ª•ÈááÁî®‰∏§ÁßçÊú∫Âà∂‰πã‰∏Ä. ‰∏ÄÁßçÊòØ‰ΩøÁî® JSON ÂΩ¢Âºè <code>RUN</code> ÂëΩ‰ª§:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> [<span class="string">&quot;powershell&quot;</span>, <span class="string">&quot;-command&quot;</span>, <span class="string">&quot;Execute-MyCmdlet&quot;</span>, <span class="string">&quot;-param1 \&quot;c:\\foo.txt\&quot;&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>ËôΩÁÑ∂ JSON Ê†ºÂºèÊòØÊòéÁ°ÆÁöÑÂπ∂‰∏îÊ≤°Êúâ‰ΩøÁî®‰∏çÂøÖË¶ÅÁöÑ cmd.exeÔºå‰ΩÜÂÆÉÁ°ÆÂÆûÈúÄË¶ÅÈÄöËøáÂèåÂºïÂè∑ÂíåËΩ¨‰πâÊù•Â¢ûÂä†ËØ¶ÁªÜ‰ø°ÊÅØ</p>
<p>Âè¶‰∏ÄÁßçÊú∫Âà∂ÊòØ‰ΩøÁî® <code>SHELL</code> Êåá‰ª§Âíå <code>shell</code> ÂΩ¢ÂºèÔºå‰∏∫ Windows Áî®Êà∑Êèê‰æõÊõ¥Ëá™ÁÑ∂ÁöÑËØ≠Ê≥ïÔºåÂ∞§ÂÖ∂ÊòØ‰∏é <code>escape</code> Ëß£ÊûêÂô®Êåá‰ª§ÁªìÂêà‰ΩøÁî®Êó∂:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># escape=`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> microsoft/nanoserver</span><br><span class="line"><span class="keyword">SHELL</span><span class="language-bash"> [<span class="string">&quot;powershell&quot;</span>, <span class="string">&quot;-command&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> New-Item -ItemType Directory C:\Example</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> Execute-MyCmdlet.ps1 c:\example\</span></span><br><span class="line"><span class="language-bash">RUN c:\example\Execute-MyCmdlet -sample <span class="string">&#x27;hello world&#x27;</span></span></span><br></pre></td></tr></table></figure>

<p><code>SHELL</code> Êåá‰ª§‰πüÂèØ‰ª•Áî®‰∫é‰øÆÊîπ shell ÁöÑÊìç‰ΩúÊñπÂºè. ‰æãÂ¶Ç, Âú® Windows ‰∏ä‰ΩøÁî® <code>SHELL cmd /S /C /V:ON|OFF</code>, ÂèØ‰ª•‰øÆÊîπÂª∂ËøüÁöÑÁéØÂ¢ÉÂèòÈáèÊâ©Â±ïËØ≠‰πâ</p>
<p>Â¶ÇÊûúÈúÄË¶ÅÂÖ∂‰ªñ shellÔºå‰æãÂ¶Ç <code>zsh</code>, <code>csh</code>, <code>tcsh</code> Á≠âÔºå‰πüÂèØ‰ª•Âú® Linux ‰∏ä‰ΩøÁî® <code>SHELL</code> Êåá‰ª§</p>
<h2 id="ÂèÇËÄÉ"><a href="#ÂèÇËÄÉ" class="headerlink" title="ÂèÇËÄÉ"></a>ÂèÇËÄÉ</h2><p><a class="link"   target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#expose" >Dockerfile reference<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Êú¨ÊñáÊ†áÈ¢òÔºöDockerfile reference</li>
        <li>Êú¨Êñá‰ΩúËÄÖÔºöÊûóÂ®ÅÁæΩ</li>
        <li>ÂàõÂª∫Êó∂Èó¥Ôºö2022-05-18 10:38:18</li>
        <li>
            Êú¨ÊñáÈìæÊé•Ôºöhttps://linweiyu21.github.io/docker/dockerfile-reference/
        </li>
        <li>
            ÁâàÊùÉÂ£∞ÊòéÔºöÊú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Docker/">#Docker</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Reference/">#Reference</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/docker/best-practices-for-writing-dockerfiles/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Best practices for writing Dockerfiles</span>
                                <span class="post-nav-item">‰∏ä‰∏ÄÁØá</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/elasticsearch/elasticsearch-guide/query-dsl/elasticsearch-match-all-query/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Elasticsearch Match all query</span>
                                <span class="post-nav-item">‰∏ã‰∏ÄÁØá</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;ËØÑËÆ∫</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: '8xWQ0WFbKUNN4h8ixIO12etk-gzGzoHsz',
                    appKey: '7cLjTvkIsF6aIuIVSd0um89m',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: 'ËØ∑ÂºÄÂßã‰Ω†ÁöÑË°®Êºî',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return 'Âçö‰∏ª';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'ÊûóÂ®ÅÁæΩ';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">ÊûóÂ®ÅÁæΩ</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        ËÆøÈóÆ‰∫∫Êï∞&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        ÊÄªËÆøÈóÆÈáè&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Áî± <a target="_blank" href="https://hexo.io">Hexo</a> È©±Âä®&nbsp;|&nbsp;‰∏ªÈ¢ò&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Usage-%E4%BD%BF%E7%94%A8"><span class="nav-number">1.</span> <span class="nav-text">Usage (‰ΩøÁî®)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BuildKit"><span class="nav-number">2.</span> <span class="nav-text">BuildKit</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Format-%E6%A0%BC%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">Format (Ê†ºÂºè)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Parser-directives-%E8%A7%A3%E6%9E%90%E5%99%A8%E6%8C%87%E4%BB%A4"><span class="nav-number">4.</span> <span class="nav-text">Parser directives (Ëß£ÊûêÂô®Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#syntax"><span class="nav-number">4.1.</span> <span class="nav-text">syntax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#escape"><span class="nav-number">4.2.</span> <span class="nav-text">escape</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Environment-replacement-%E7%8E%AF%E5%A2%83%E6%9B%B4%E6%8D%A2"><span class="nav-number">5.</span> <span class="nav-text">Environment replacement (ÁéØÂ¢ÉÊõ¥Êç¢)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dockerignore-file-dockerignore-%E6%96%87%E4%BB%B6"><span class="nav-number">6.</span> <span class="nav-text">.dockerignore file (.dockerignore Êñá‰ª∂)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FROM-FROM-%E6%8C%87%E4%BB%A4"><span class="nav-number">7.</span> <span class="nav-text">FROM (FROM Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Understanding-how-ARG-and-FROM-interact-%E7%90%86%E8%A7%A3-ARG-%E5%92%8C-FROM-%E6%80%8E%E6%A0%B7%E4%BA%A4%E4%BA%92"><span class="nav-number">7.1.</span> <span class="nav-text">Understanding how ARG and FROM interact (ÁêÜËß£ ARG Âíå FROM ÊÄéÊ†∑‰∫§‰∫í)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RUN-RUN-%E6%8C%87%E4%BB%A4"><span class="nav-number">8.</span> <span class="nav-text">RUN (RUN Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Know-issues-RUN-RUN-%E6%8C%87%E4%BB%A4%E7%9A%84%E5%B7%B2%E7%9F%A5%E9%97%AE%E9%A2%98"><span class="nav-number">8.1.</span> <span class="nav-text">Know issues (RUN) (RUN Êåá‰ª§ÁöÑÂ∑≤Áü•ÈóÆÈ¢ò)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CMD-CMD-%E6%8C%87%E4%BB%A4"><span class="nav-number">9.</span> <span class="nav-text">CMD (CMD Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LABEL-LABEL-%E6%8C%87%E4%BB%A4"><span class="nav-number">10.</span> <span class="nav-text">LABEL (LABEL Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MAINTAINER-deprecated-MAINTAINER-%E6%8C%87%E4%BB%A4-%E5%B7%B2%E8%BF%87%E6%97%B6"><span class="nav-number">11.</span> <span class="nav-text">MAINTAINER (deprecated) (MAINTAINER Êåá‰ª§ Â∑≤ËøáÊó∂)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EXPOSE-EXPOSE-%E6%8C%87%E4%BB%A4"><span class="nav-number">12.</span> <span class="nav-text">EXPOSE (EXPOSE Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ENV-ENV-%E6%8C%87%E4%BB%A4"><span class="nav-number">13.</span> <span class="nav-text">ENV (ENV Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%BF%E4%BB%A3%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="nav-number">13.1.</span> <span class="nav-text">Êõø‰ª£ÁöÑËØ≠Ê≥ï</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ADD-ADD-%E6%8C%87%E4%BB%A4"><span class="nav-number">14.</span> <span class="nav-text">ADD (ADD Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#COPY-COPY-%E6%8C%87%E4%BB%A4"><span class="nav-number">15.</span> <span class="nav-text">COPY (COPY Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ENTRYPOINT-ENTRYPOINT-%E6%8C%87%E4%BB%A4"><span class="nav-number">16.</span> <span class="nav-text">ENTRYPOINT (ENTRYPOINT Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Exec-form-ENTRYPOINT-example-Exec-%E5%BD%A2%E5%BC%8F-ENTRYPOINT-%E4%BE%8B%E5%AD%90"><span class="nav-number">16.1.</span> <span class="nav-text">Exec form ENTRYPOINT example (Exec ÂΩ¢Âºè ENTRYPOINT ‰æãÂ≠ê)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shell-form-ENTRYPOINT-example-Shell-%E5%BD%A2%E5%BC%8F-ENTRYPOINT-%E4%BE%8B%E5%AD%90"><span class="nav-number">16.2.</span> <span class="nav-text">Shell form ENTRYPOINT example (Shell ÂΩ¢Âºè ENTRYPOINT ‰æãÂ≠ê)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Understand-how-CMD-and-ENTRYPOINT-interact-%E7%90%86%E8%A7%A3-CMD-%E5%92%8C-ENTRYPOINT-%E6%98%AF%E6%80%8E%E6%A0%B7%E4%BA%A4%E4%BA%92%E7%9A%84"><span class="nav-number">16.3.</span> <span class="nav-text">Understand how CMD and ENTRYPOINT interact (ÁêÜËß£ CMD Âíå ENTRYPOINT ÊòØÊÄéÊ†∑‰∫§‰∫íÁöÑ)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VOLUME-VOLUME-%E6%8C%87%E4%BB%A4"><span class="nav-number">17.</span> <span class="nav-text">VOLUME (VOLUME Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Notes-about-specifying-volumes-%E5%85%B3%E4%BA%8E%E6%8C%87%E5%AE%9A%E5%8D%B7%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">17.1.</span> <span class="nav-text">Notes about specifying volumes (ÂÖ≥‰∫éÊåáÂÆöÂç∑ÁöÑÊ≥®ÊÑè‰∫ãÈ°π)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3"><span class="nav-number">17.2.</span> <span class="nav-text">ÁêÜËß£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#USER-USER-%E6%8C%87%E4%BB%A4"><span class="nav-number">18.</span> <span class="nav-text">USER (USER Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WORKDIR-WORKDIR-%E6%8C%87%E4%BB%A4"><span class="nav-number">19.</span> <span class="nav-text">WORKDIR (WORKDIR Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ARG-ARG-%E6%8C%87%E4%BB%A4"><span class="nav-number">20.</span> <span class="nav-text">ARG (ARG Êåá‰ª§)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Default-values-%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="nav-number">20.1.</span> <span class="nav-text">Default values (ÈªòËÆ§ÂÄº)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scope-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">20.2.</span> <span class="nav-text">Scope (‰ΩúÁî®Âüü)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-ARG-variables-%E4%BD%BF%E7%94%A8-ARG-%E5%8F%98%E9%87%8F"><span class="nav-number">20.3.</span> <span class="nav-text">Using ARG variables (‰ΩøÁî® ARG ÂèòÈáè)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Predefined-ARGs-%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84-ARGs"><span class="nav-number">20.4.</span> <span class="nav-text">Predefined ARGs (È¢ÑÂÆö‰πâÁöÑ ARGs)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Automatic-platform-ARGs-in-the-global-scope-%E5%85%A8%E5%B1%80%E8%8C%83%E5%9B%B4%E5%86%85%E7%9A%84%E8%87%AA%E5%8A%A8%E5%B9%B3%E5%8F%B0-ARGs"><span class="nav-number">20.5.</span> <span class="nav-text">Automatic platform ARGs in the global scope (ÂÖ®Â±ÄËåÉÂõ¥ÂÜÖÁöÑËá™Âä®Âπ≥Âè∞ ARGs)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Impact-on-build-caching-%E5%AF%B9%E6%9E%84%E5%BB%BA%E7%BC%93%E5%AD%98%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">20.6.</span> <span class="nav-text">Impact on build caching (ÂØπÊûÑÂª∫ÁºìÂ≠òÁöÑÂΩ±Âìç)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ONBUILD-ONBUILD-%E6%8C%87%E4%BB%A4"><span class="nav-number">21.</span> <span class="nav-text">ONBUILD (ONBUILD Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#STOPSIGNAL-STOPSIGNAL-%E6%8C%87%E4%BB%A4"><span class="nav-number">22.</span> <span class="nav-text">STOPSIGNAL (STOPSIGNAL Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HEALTHCHECK-HEALTHCHECK-%E6%8C%87%E4%BB%A4"><span class="nav-number">23.</span> <span class="nav-text">HEALTHCHECK (HEALTHCHECK Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SHELL-SHELL-%E6%8C%87%E4%BB%A4"><span class="nav-number">24.</span> <span class="nav-text">SHELL (SHELL Êåá‰ª§)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">25.</span> <span class="nav-text">ÂèÇËÄÉ</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="ÊêúÁ¥¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
