<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Micronaut,Groovy,Gradle,Java,æ–‡æ¡£,ä¸­æ–‡">
    <meta name="description" content="Micronaut Groovy Gradle Java æ–‡æ¡£ ä¸­æ–‡">
    <meta name="author" content="æ—å¨ç¾½">
    
    <title>
        
            Micronaut ä¸­æ–‡æ–‡æ¡£ Inversion of Control |
        
        æ—å¨ç¾½çš„ç¬”è®°
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"rgb(153,153,0)","avatar":"/images/avatar.jpg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"400px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":null,"description":"def containsğŸš€ = ['Micronaut', 'Groovy', 'Gradle', 'etc']"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
  </script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                æ—å¨ç¾½çš„ç¬”è®°
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

    <a target="_blank" rel="noopener" href="https://github.com/linweiyu21/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80"
        viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
        aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg></a>
    <style>
      .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }

      @keyframes octocat-wave {

        0%,
        100% {
          transform: rotate(0)
        }

        20%,
        60% {
          transform: rotate(-25deg)
        }

        40%,
        80% {
          transform: rotate(10deg)
        }
      }

      @media (max-width:500px) {
        .github-corner:hover .octo-arm {
          animation: none
        }

        .github-corner .octo-arm {
          animation: octocat-wave 560ms ease-in-out
        }
      }
    </style>
</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Micronaut ä¸­æ–‡æ–‡æ¡£ Inversion of Control</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">æ—å¨ç¾½</span>
                        
                            <span class="author-label">Lv8</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-04-29 09:25:59</span>
        <span class="mobile">2022-04-29 09:25</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Micronaut-%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/">Micronaut ä¸­æ–‡æ–‡æ¡£</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Micronaut/">Micronaut</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Groovy/">Groovy</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E4%B8%AD%E6%96%87/">ä¸­æ–‡</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <!-- TOC -->

<ul>
<li><a href="#inversion-of-control">Inversion of Control</a><ul>
<li><a href="#injectable-container-types-%E5%8F%AF%E4%BB%A5%E6%B3%A8%E5%85%A5%E7%9A%84%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B">Injectable Container Types (å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹)</a><ul>
<li><a href="#collection-ordering-%E5%AE%B9%E5%99%A8%E4%B8%AD-bean-%E7%9A%84%E9%A1%BA%E5%BA%8F">Collection Ordering (å®¹å™¨ä¸­ Bean çš„é¡ºåº)</a></li>
<li><a href="#injecting-a-bean-by-order-%E6%8C%89%E9%A1%BA%E5%BA%8F%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AA-bean">Injecting a Bean by Order (æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª Bean)</a></li>
</ul>
</li>
<li><a href="#bean-qualifiers-bean-%E9%99%90%E5%AE%9A%E7%AC%A6">Bean Qualifiers Bean (é™å®šç¬¦)</a><ul>
<li><a href="#qualifying-by-name-%E9%80%9A%E8%BF%87%E5%90%8D%E5%AD%97%E6%9D%A5%E9%99%90%E5%AE%9A">Qualifying By Name (é€šè¿‡åå­—æ¥é™å®š)</a></li>
<li><a href="#qualifying-by-annotation-%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E6%9D%A5%E9%99%90%E5%AE%9A">Qualifying By Annotation (é€šè¿‡æ³¨è§£æ¥é™å®š)</a></li>
<li><a href="#qualifier-by-annotation-members-%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%B1%9E%E6%80%A7%E6%88%90%E5%91%98%E6%9D%A5%E9%99%90%E5%AE%9A">Qualifier By Annotation Members (é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š)</a></li>
<li><a href="#qualifying-by-generic-type-arguments-%E9%80%9A%E8%BF%87%E6%B3%9B%E5%9E%8B%E5%8F%82%E6%95%B0%E6%9D%A5%E9%99%90%E5%AE%9A">Qualifying by Generic Type Arguments (é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š)</a></li>
<li><a href="#primary-and-secondary-beans-%E4%B8%BB%E8%A6%81%E7%9A%84%E5%92%8C%E6%AC%A1%E8%A6%81%E7%9A%84-bean">Primary and Secondary Beans (ä¸»è¦çš„å’Œæ¬¡è¦çš„ Bean)</a></li>
<li><a href="#injecting-any-bean-%E6%B3%A8%E5%85%A5%E4%BB%BB%E6%84%8F-bean">Injecting Any Bean (æ³¨å…¥ä»»æ„ Bean)</a></li>
</ul>
</li>
<li><a href="#limiting-injectable-types-%E9%99%90%E5%88%B6%E6%B3%A8%E5%85%A5%E7%9A%84%E7%B1%BB%E5%9E%8B">Limiting Injectable Types (é™åˆ¶æ³¨å…¥çš„ç±»å‹)</a></li>
<li><a href="#scopes-%E4%BD%9C%E7%94%A8%E5%9F%9F">Scopes (ä½œç”¨åŸŸ)</a><ul>
<li><a href="#built-in-scopes-%E5%86%85%E5%BB%BA%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F">Built-In Scopes (å†…å»ºçš„ä½œç”¨åŸŸ)</a><ul>
<li><a href="#eager-initialization-of-singletons-%E5%8D%95%E4%BE%8B%E7%9A%84%E9%A5%BF%E5%BC%8F%E5%88%9D%E5%A7%8B%E5%8C%96">Eager Initialization of Singletons (å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–)</a></li>
</ul>
</li>
<li><a href="#refreshable-scope-%E5%8F%AF%E5%88%B7%E6%96%B0%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F">Refreshable Scope (å¯åˆ·æ–°çš„ä½œç”¨åŸŸ)</a></li>
<li><a href="#scopes-on-meta-annotations-%E5%85%83%E6%B3%A8%E8%A7%A3%E4%B8%8A%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F">Scopes on Meta Annotations (å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ)</a></li>
</ul>
</li>
<li><a href="#bean-factories-bean-%E5%B7%A5%E5%8E%82">Bean Factories Bean (å·¥å‚)</a><ul>
<li><a href="#programmatically-disabling-beans-%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E6%9D%A5%E6%97%A0%E6%95%88%E5%8C%96-beans">Programmatically Disabling Beans (ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ– Beans)</a></li>
<li><a href="#injection-point-%E6%B3%A8%E5%85%A5%E7%82%B9">Injection Point (æ³¨å…¥ç‚¹)</a></li>
<li><a href="#beans-from-fields-%E5%9C%A8%E5%AD%97%E6%AE%B5%E4%B8%AD%E5%A3%B0%E6%98%8E-beans">Beans from Fields (åœ¨å­—æ®µä¸­å£°æ˜ Beans)</a></li>
<li><a href="#primitive-beans-and-arrays-%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%92%8C%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E7%9A%84-bean">Primitive Beans and Arrays (åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„ Bean)</a></li>
</ul>
</li>
<li><a href="#conditional-beans-%E6%9D%A1%E4%BB%B6%E5%8C%96%E5%8A%A0%E8%BD%BD-beans">Conditional Beans (æ¡ä»¶åŒ–åŠ è½½ Beans)</a><ul>
<li><a href="#configuration-requirements-%E9%85%8D%E7%BD%AE%E8%A6%81%E6%B1%82">Configuration Requirements (é…ç½®è¦æ±‚)</a><ul>
<li><a href="#additional-notes-on-property-requirements-%E5%B1%9E%E6%80%A7%E8%A6%81%E6%B1%82%E4%B8%8A%E9%A2%9D%E5%A4%96%E7%9A%84%E4%BF%A1%E6%81%AF">Additional Notes on Property Requirements (å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯)</a></li>
<li><a href="#referencing-bean-properties-in-requires-%E5%9C%A8-requires-%E6%B3%A8%E8%A7%A3%E4%B8%AD%E5%BC%95%E7%94%A8-bean-%E5%B1%9E%E6%80%A7">Referencing bean properties in @Requires (åœ¨ @Requires æ³¨è§£ä¸­å¼•ç”¨ Bean å±æ€§)</a></li>
</ul>
</li>
<li><a href="#debugging-conditional-beans-%E8%B0%83%E8%AF%95%E6%9D%A1%E4%BB%B6%E5%8C%96%E7%9A%84-beans">Debugging Conditional Beans (è°ƒè¯•æ¡ä»¶åŒ–çš„ Beans)</a></li>
</ul>
</li>
<li><a href="#bean-replacement-bean-%E6%9B%BF%E4%BB%A3">Bean Replacement (Bean æ›¿ä»£)</a><ul>
<li><a href="#factory-replacement-factory-%E6%9B%BF%E4%BB%A3">Factory Replacement (Factory æ›¿ä»£)</a></li>
<li><a href="#default-implementation-%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0">Default Implementation (é»˜è®¤å®ç°)</a></li>
</ul>
</li>
<li><a href="#bean-configurations-bean-%E9%85%8D%E7%BD%AE">Bean Configurations (Bean é…ç½®)</a></li>
<li><a href="#life-cycle-methods-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95">Life-Cycle Methods (ç”Ÿå‘½å‘¨æœŸæ–¹æ³•)</a><ul>
<li><a href="#when-the-context-starts-context-%E5%90%AF%E5%8A%A8%E6%97%B6">When The Context Starts (Context å¯åŠ¨æ—¶)</a></li>
<li><a href="#when-the-context-closes-context-%E5%85%B3%E9%97%AD%E6%97%B6">When The Context Closes (Context å…³é—­æ—¶)</a></li>
</ul>
</li>
<li><a href="#context-events-context-%E4%BA%8B%E4%BB%B6">Context Events (Context äº‹ä»¶)</a><ul>
<li><a href="#publishing-events-%E5%8F%91%E5%B8%83%E4%BA%8B%E4%BB%B6">Publishing Events (å‘å¸ƒäº‹ä»¶)</a></li>
<li><a href="#listening-for-events-%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6">Listening for Events (ç›‘å¬äº‹ä»¶)</a></li>
</ul>
</li>
<li><a href="#bean-events-bean-%E4%BA%8B%E4%BB%B6">Bean Events (Bean äº‹ä»¶)</a></li>
<li><a href="#bean-introspection-bean-%E5%86%85%E7%9C%81">Bean Introspection (Bean å†…çœ)</a><ul>
<li><a href="#making-a-bean-available-for-introspection-%E8%AE%A9%E4%B8%80%E4%B8%AA-bean-%E5%8F%AF%E7%94%A8%E4%BA%8E%E5%8F%8D%E5%B0%84">Making a Bean Available for Introspection (è®©ä¸€ä¸ª Bean å¯ç”¨äºåå°„)</a></li>
<li><a href="#use-the-introspected-annotation-%E4%BD%BF%E7%94%A8-introspected-%E6%B3%A8%E8%A7%A3">Use the <code>@Introspected</code> Annotation (ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£)</a></li>
<li><a href="#bean-fields-bean-%E5%AD%97%E6%AE%B5">Bean Fields (Bean å­—æ®µ)</a></li>
<li><a href="#constructor-methods-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95">Constructor Methods (æ„é€ æ–¹æ³•)</a></li>
<li><a href="#static-creator-methods-%E9%9D%99%E6%80%81%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95">Static Creator Methods (é™æ€æ„é€ æ–¹æ³•)</a></li>
<li><a href="#enums-%E6%9E%9A%E4%B8%BE">Enums (æšä¸¾)</a></li>
<li><a href="#use-the-introspected-annotation-on-a-configuration-class-%E5%9C%A8%E4%B8%80%E4%B8%AA%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%B8%8A%E4%BD%BF%E7%94%A8-introspected-%E6%B3%A8%E8%A7%A3">Use the <code>@Introspected</code> Annotation on a Configuration Class (åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨ <code>@Introspected</code> æ³¨è§£)</a></li>
<li><a href="#write-an-annotationmapper-to-introspect-existing-annotations-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA-annotationmapper-%E6%9D%A5%E5%86%85%E7%9C%81%E4%B8%80%E4%B8%AA%E5%B7%B2%E5%AD%98%E5%9C%A8%E7%9A%84%E6%B3%A8%E8%A7%A3">Write an <code>AnnotationMapper</code> to Introspect Existing Annotations (ç¼–å†™ä¸€ä¸ª <code>AnnotationMapper</code> æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£)</a></li>
<li><a href="#the-beanwrapper-api-beanwrapper-api">The BeanWrapper API (BeanWrapper API)</a></li>
<li><a href="#jackson-and-bean-introspection-jackson-%E5%92%8C-bean-%E5%86%85%E7%9C%81">Jackson and Bean Introspection (Jackson å’Œ Bean å†…çœ)</a></li>
</ul>
</li>
<li><a href="#bean-validation-bean-%E6%A0%A1%E9%AA%8C">Bean Validation (Bean æ ¡éªŒ)</a><ul>
<li><a href="#validating-bean-methods-%E6%A3%80%E9%AA%8C-bean-%E7%9A%84%E6%96%B9%E6%B3%95">Validating Bean Methods (æ£€éªŒ Bean çš„æ–¹æ³•)</a></li>
<li><a href="#validating-data-classes-%E6%A0%A1%E9%AA%8C%E6%95%B0%E6%8D%AE%E7%B1%BB">Validating Data Classes (æ ¡éªŒæ•°æ®ç±»)</a></li>
<li><a href="#validation-configuration-properties-%E6%A0%A1%E9%AA%8C%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE">Validation Configuration Properties (æ ¡éªŒå±æ€§é…ç½®)</a></li>
<li><a href="#defining-additional-constraints-%E5%AE%9A%E4%B9%89%E9%A2%9D%E5%A4%96%E7%9A%84%E7%BA%A6%E6%9D%9F">Defining Additional Constraints (å®šä¹‰é¢å¤–çš„çº¦æŸ)</a></li>
<li><a href="#validating-annotations-at-compile-time-%E5%9C%A8%E7%BC%96%E8%AF%91%E6%97%B6%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3">Validating Annotations at Compile Time (åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£)</a></li>
</ul>
</li>
<li><a href="#bean-annotation-metadata-bean-%E6%B3%A8%E8%A7%A3%E5%85%83%E6%95%B0%E6%8D%AE">Bean Annotation Metadata (Bean æ³¨è§£å…ƒæ•°æ®)</a><ul>
<li><a href="#annotation-inheritance-%E6%B3%A8%E8%A7%A3%E7%BB%A7%E6%89%BF">Annotation Inheritance (æ³¨è§£ç»§æ‰¿)</a></li>
<li><a href="#aliasing-or-mapping-annotations-%E5%8F%96%E5%88%AB%E5%90%8Dor%E6%98%A0%E5%B0%84%E6%B3%A8%E8%A7%A3">Aliasing or Mapping Annotations (å–åˆ«åoræ˜ å°„æ³¨è§£)</a></li>
</ul>
</li>
<li><a href="#importing-beans-from-libraries-%E4%BB%8E%E4%B8%80%E4%B8%AA%E5%BA%93%E4%B8%AD%E5%AF%BC%E5%85%A5-beans">Importing Beans from Libraries (ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥ Beans)</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="Inversion-of-Control"><a href="#Inversion-of-Control" class="headerlink" title="Inversion of Control"></a>Inversion of Control</h1><p><strong>å£°æ˜</strong>:</p>
<ul>
<li>æœ¬æ–‡ç”±æœ¬äººç¿»è¯‘è‡ª<a class="link"   target="_blank" rel="noopener" href="https://docs.micronaut.io/latest/guide" >å®˜æ–¹æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a></li>
<li>éƒ¨åˆ†å†…å®¹å¯èƒ½ä¼šæœ‰ä¿®æ”¹æˆ–åˆ å‡, ä¸€åˆ‡ä»¥å®˜æ–¹æ–‡æ¡£ä¸ºå‡†.</li>
<li>æœ¬æ–‡ç¿»è¯‘æ—¶ Micronaut ç‰ˆæœ¬ä¸º 3.4.2</li>
</ul>
<p>Micronaut ä½¿ç”¨ç¼–è¯‘æ—¶æ•°æ®æ¥å®ç°ä¾èµ–æ³¨å…¥</p>
<h2 id="Injectable-Container-Types-å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹"><a href="#Injectable-Container-Types-å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹" class="headerlink" title="Injectable Container Types (å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹)"></a>Injectable Container Types (å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹)</h2><p>Table 1.Injectable Container Types - å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹:</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>java.util.Optional</code></td>
<td align="left">An <code>Optional</code> of a bean. <code>empty()</code> is injected if the bean is doesnâ€™t exist</td>
<td align="left"><code>Optional&lt;Engine&gt;</code></td>
</tr>
<tr>
<td align="left"><code>java.lang.Collection</code></td>
<td align="left">An <code>Collection</code> or subtype of <code>Collection</code></td>
<td align="left"><code>Collection&lt;Engine&gt;</code></td>
</tr>
<tr>
<td align="left"><code>java.util.stream.Stream</code></td>
<td align="left">A lazy <code>Stream</code> of beans</td>
<td align="left"><code>Stream&lt;Engine&gt;</code></td>
</tr>
<tr>
<td align="left"><code>Array</code></td>
<td align="left">A native array of beans of a given type</td>
<td align="left"><code>Engine[]</code></td>
</tr>
<tr>
<td align="left"><code>Provider</code></td>
<td align="left">A <code>javax.inject.Provider</code> if a circular dependency requires it, or to instantiate a prototype for each <code>get</code> call</td>
<td align="left"><code>Provider&lt;Engine&gt;</code></td>
</tr>
<tr>
<td align="left"><code>Provider</code></td>
<td align="left">A <code>jakarta.inject.Provider</code> if a circular dependency requires it or to instantiate a prototype for each <code>get</code> call</td>
<td align="left"><code>Provider&lt;Engine&gt;</code></td>
</tr>
<tr>
<td align="left"><code>BeanProvider</code></td>
<td align="left">A <code>io.micronaut.context.BeanProvider</code> if a circular dependency requires it or to instantiate a prototype for each <code>get</code> call</td>
<td align="left"><code>BeanProvider&lt;Engine&gt;</code></td>
</tr>
</tbody></table>
<p>æ¨èä½¿ç”¨ <code>BeanProvider</code></p>
<p>å½“ä½¿ç”¨ <code>java.lang.Collection</code>,<code>java.util.stream.Stream</code>,<code>Array</code> æ¥æ³¨å…¥ Beans æ—¶, å½“å‰ç±»ä¸ä¼šè¢«æ³¨å…¥åˆ°è¿™äº›é›†åˆä¸­:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AggregateEngine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    List&lt;Engine&gt; engines    <span class="comment">// engines ä¸­ä¸ä¼šåŒ…å«å½“å‰ç±» AggregateEngine çš„å®ä¾‹ Bean</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">void</span> start() &#123;</span><br><span class="line">        engines.forEach(<span class="attr">Engine:</span>:start)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>A prototype bean will have one instance created per place the bean is injected.</p>
</blockquote>
<p>ä¸€ä¸ª prototype bean å°†ä¼šåœ¨æ¯ä¸ªæ³¨å…¥çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªå®ä¾‹</p>
<blockquote>
<p>When a prototype bean is injected as a provider, each call to get() creates a new instance.</p>
</blockquote>
<p>å½“ä¸€ä¸ª prototype bean ä½œä¸ºä¸€ä¸ª provider æ¥è¿›è¡Œæ³¨å…¥æ—¶, æ¯æ¬¡è°ƒç”¨ <code>get()</code> æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹</p>
<h3 id="Collection-Ordering-å®¹å™¨ä¸­-Bean-çš„é¡ºåº"><a href="#Collection-Ordering-å®¹å™¨ä¸­-Bean-çš„é¡ºåº" class="headerlink" title="Collection Ordering (å®¹å™¨ä¸­ Bean çš„é¡ºåº)"></a>Collection Ordering (å®¹å™¨ä¸­ Bean çš„é¡ºåº)</h3><p>ä½¿ç”¨é›†åˆæ¥æ³¨å…¥ Beans æ—¶, é»˜è®¤æ˜¯æ²¡æœ‰å¯¹ Beans è¿›è¡Œæ’åºçš„</p>
<p>Beans å¯ä»¥å®ç° <code>Ordered</code> æ¥å£æ¥è¿›è¡Œæ’åºæ³¨å…¥</p>
<p>æˆ–è€…ä½¿ç”¨ <code>@Order</code> æ³¨è§£æ¥å£°æ˜æ³¨å…¥é¡ºåº, åœ¨é€šè¿‡ Factory æ¥åˆ›å»º Class ä½äºç¬¬ä¸‰æ–¹åº“çš„ Beans æ—¶éå¸¸æœ‰ç”¨:</p>
<p>Example - Factory with <code>@Order</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Factory</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Order</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"><span class="keyword">import</span> java.time.Duration</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RateLimitsFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Order</span>(<span class="number">20</span>)</span><br><span class="line">    LowRateLimit rateLimit2() &#123;</span><br><span class="line">        <span class="keyword">new</span> LowRateLimit(Duration.ofMinutes(<span class="number">50</span>), <span class="number">100</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Order</span>(<span class="number">10</span>)</span><br><span class="line">    HighRateLimit rateLimit1() &#123;</span><br><span class="line">        <span class="keyword">new</span> HighRateLimit(Duration.ofMinutes(<span class="number">50</span>), <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ³¨å…¥ä¸€ä¸ª <code>RateLimit</code> é›†åˆçš„ Beans æ—¶, å°†ä¼šä½¿ç”¨ <code>@Order</code> ä¸­çš„ value å€¼çš„ æ­£åº(asc) æ¥è¿›è¡Œæ’åº</p>
<h3 id="Injecting-a-Bean-by-Order-æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª-Bean"><a href="#Injecting-a-Bean-by-Order-æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª-Bean" class="headerlink" title="Injecting a Bean by Order (æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª Bean)"></a>Injecting a Bean by Order (æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª Bean)</h3><p>åœ¨æ³¨å…¥å•ä¸ª Bean å®ä¾‹æ—¶, <code>@Order</code> æ³¨è§£å¯ä»¥ç”¨æ¥å£°æ˜å“ªä¸ª Bean å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§</p>
<h2 id="Bean-Qualifiers-Bean-é™å®šç¬¦"><a href="#Bean-Qualifiers-Bean-é™å®šç¬¦" class="headerlink" title="Bean Qualifiers Bean (é™å®šç¬¦)"></a>Bean Qualifiers Bean (é™å®šç¬¦)</h2><p>å½“ä½ éœ€è¦æ³¨å…¥ä¸€ä¸ªæœ‰å¤šä¸ªå®ç°çš„æ¥å£çš„ Bean æ—¶, ä½ éœ€è¦ä½¿ç”¨ä¸€ä¸ª <code>qualifier</code>(é™å®šè¯, é™å®šè¯­)</p>
<h3 id="Qualifying-By-Name-é€šè¿‡åå­—æ¥é™å®š"><a href="#Qualifying-By-Name-é€šè¿‡åå­—æ¥é™å®š" class="headerlink" title="Qualifying By Name (é€šè¿‡åå­—æ¥é™å®š)"></a>Qualifying By Name (é€šè¿‡åå­—æ¥é™å®š)</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Engine</span> &#123; <span class="comment">// </span></span><br><span class="line">    <span class="type">int</span> getCylinders()</span><br><span class="line">    String start()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V6Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123; <span class="comment">// </span></span><br><span class="line">    <span class="type">int</span> cylinders = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="string">&quot;Starting V6&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123; <span class="comment">// </span></span><br><span class="line">    <span class="type">int</span> cylinders = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="string">&quot;Starting V8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Engine engine</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span> Vehicle(<span class="meta">@Named</span>(<span class="string">&#x27;v8&#x27;</span>) Engine engine) &#123; <span class="comment">// </span></span><br><span class="line">        <span class="variable language_">this</span>.engine = engine</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String start() &#123;</span><br><span class="line">        engine.start() <span class="comment">// </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Named</code> <code>qualifier</code> çš„å€¼ <code>v8</code> åŠ ä¸Š ç±»<code>Engine</code> æ„æˆ <code>v8Engine</code>, å†ä½¿ç”¨å¤§å°å†™ä¸æ•æ„Ÿçš„åˆ¤æ–­: <code>v8Engine</code> &#x3D;&#x3D; <code>V8Engine</code>, æ‰€ä»¥æ³¨å…¥çš„æ˜¯ <code>Engine</code> çš„ <code>V8Engine</code> å®ç°</p>
<p>è¿˜å¯ä»¥åœ¨ç±»ä¸Šä½¿ç”¨ <code>@Named</code> æ¥æ˜ç¡®å£°æ˜è¿™ä¸ª Bean çš„åç§°, ä»¥ä¾¿åœ¨æ³¨å…¥æ—¶ä½¿ç”¨è¿™ä¸ªåç§°</p>
<h3 id="Qualifying-By-Annotation-é€šè¿‡æ³¨è§£æ¥é™å®š"><a href="#Qualifying-By-Annotation-é€šè¿‡æ³¨è§£æ¥é™å®š" class="headerlink" title="Qualifying By Annotation (é€šè¿‡æ³¨è§£æ¥é™å®š)"></a>Qualifying By Annotation (é€šè¿‡æ³¨è§£æ¥é™å®š)</h3><p>é€šè¿‡ä½¿ç”¨ <code>@Qualifier</code> æ³¨è§£æ¥å£°æ˜è‡ªå®šä¹‰çš„æ³¨è§£æ¥è¿›è¡Œ qualify</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.inject.Qualifier</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME</span><br><span class="line"></span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> V8 &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Inject</span> Vehicle(<span class="meta">@V</span>8 Engine engine) &#123; <span class="variable language_">this</span>.engine = engine &#125;</span><br></pre></td></tr></table></figure>

<h3 id="Qualifier-By-Annotation-Members-é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š"><a href="#Qualifier-By-Annotation-Members-é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š" class="headerlink" title="Qualifier By Annotation Members (é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š)"></a>Qualifier By Annotation Members (é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š)</h3><p>ä½¿ç”¨æ³¨è§£ä¸­çš„å€¼æ¥è¿›è¡Œ qualify</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.NonBinding</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Qualifier</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME</span><br><span class="line"></span><br><span class="line"><span class="meta">@Qualifier</span> <span class="comment">// </span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> Cylinders &#123;</span><br><span class="line">    <span class="type">int</span> value();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NonBinding</span> <span class="comment">// </span></span><br><span class="line">    String description() <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Cylinders</code> æ³¨è§£ä¸­å£°æ˜äº† <code>value</code> å’Œ <code>description</code> å±æ€§</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Cylinders</span>(value = <span class="number">6</span>, description = <span class="string">&quot;6-cylinder V6 engine&quot;</span>)  <span class="comment">// </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V6Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123; <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">int</span> getCylinders() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">6</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Starting V6&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Cylinders</span>(value = <span class="number">8</span>, description = <span class="string">&quot;8-cylinder V8 engine&quot;</span>) <span class="comment">// </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123; <span class="comment">// </span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">int</span> getCylinders() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">8</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Starting V8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Inject</span> Vehicle(<span class="meta">@Cylinders</span>(<span class="number">8</span>) Engine engine) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.engine = engine</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ <code>@Cylinders(8)</code> ä¸­çš„å±æ€§å€¼ 8 æ¥æŒ‡æ˜ä½¿ç”¨ <code>V8Engine</code> å®ç°</p>
<h3 id="Qualifying-by-Generic-Type-Arguments-é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š"><a href="#Qualifying-by-Generic-Type-Arguments-é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š" class="headerlink" title="Qualifying by Generic Type Arguments (é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š)"></a>Qualifying by Generic Type Arguments (é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š)</h3><p>å¯ä»¥é€šè¿‡æ³›å‹æ¥è¿›è¡Œ qualify</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">CylinderProvider</span> &#123;</span><br><span class="line">    <span class="type">int</span> getCylinders()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Engine</span>&lt;T <span class="keyword">extends</span> <span class="title class_">CylinderProvider</span>&gt; &#123; <span class="comment">// </span></span><br><span class="line">    <span class="keyword">default</span> <span class="type">int</span> getCylinders() &#123; cylinderProvider.cylinders &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> String start() &#123; <span class="string">&quot;Starting $&#123;cylinderProvider.class.simpleName&#125;&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">    T getCylinderProvider()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8</span> <span class="keyword">implements</span> <span class="title class_">CylinderProvider</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">int</span> getCylinders() &#123; <span class="number">8</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span>&lt;V8&gt; &#123;  <span class="comment">// </span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    V8 getCylinderProvider() &#123; <span class="keyword">new</span> V8() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Inject</span></span><br><span class="line">Vehicle(Engine&lt;V8&gt; engine) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.engine = engine</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Primary-and-Secondary-Beans-ä¸»è¦çš„å’Œæ¬¡è¦çš„-Bean"><a href="#Primary-and-Secondary-Beans-ä¸»è¦çš„å’Œæ¬¡è¦çš„-Bean" class="headerlink" title="Primary and Secondary Beans (ä¸»è¦çš„å’Œæ¬¡è¦çš„ Bean)"></a>Primary and Secondary Beans (ä¸»è¦çš„å’Œæ¬¡è¦çš„ Bean)</h3><p>åœ¨æ¥å£æœ‰å¤šä¸ªå®ç° Bean æ—¶, ä½¿ç”¨ <code>@Primary</code> æ³¨è§£æ¥å£°æ˜å…¶ä¸­ä¸€ä¸ª Bean æ˜¯ä¸»è¦ Bean, ä¼˜å…ˆçº§æœ€é«˜</p>
<p>ä½¿ç”¨ <code>@Secondary</code> æ³¨è§£æ¥å£°æ˜å…¶ä¸­ä¸€ä¸ª Bean æ˜¯æ¬¡è¦ Bean</p>
<h3 id="Injecting-Any-Bean-æ³¨å…¥ä»»æ„-Bean"><a href="#Injecting-Any-Bean-æ³¨å…¥ä»»æ„-Bean" class="headerlink" title="Injecting Any Bean (æ³¨å…¥ä»»æ„ Bean)"></a>Injecting Any Bean (æ³¨å…¥ä»»æ„ Bean)</h3><p>æ³¨å…¥ä»»æ„ä¸€ä¸ª Bean å®ç°</p>
<p><code>@Any</code> <code>qualifier</code> é€šå¸¸å’Œ <code>BeanProvider</code> æ¥ä¸€èµ·ä½¿ç”¨, ç”¨äºä¸€äº›åŠ¨æ€çš„åˆ¤æ–­åœºæ™¯</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.BeanProvider</span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Any</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> BeanProvider&lt;Engine&gt; engineProvider</span><br><span class="line"></span><br><span class="line">    Vehicle(<span class="meta">@Any</span> BeanProvider&lt;Engine&gt; engineProvider) &#123; <span class="comment">// </span></span><br><span class="line">        <span class="variable language_">this</span>.engineProvider = engineProvider</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">void</span> start() &#123;</span><br><span class="line">        engineProvider.ifPresent(<span class="attr">Engine:</span>:start) <span class="comment">// </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>engineProvider.ifPresent(Engine::start)</code> ä¼šåœ¨ Bean å­˜åœ¨çš„æ—¶å€™æ‰è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨</p>
<p>è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„ Bean:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> startAll() &#123;</span><br><span class="line">    <span class="keyword">if</span> (engineProvider.isPresent()) &#123;</span><br><span class="line">        engineProvider.each &#123; it.start() &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Limiting-Injectable-Types-é™åˆ¶æ³¨å…¥çš„ç±»å‹"><a href="#Limiting-Injectable-Types-é™åˆ¶æ³¨å…¥çš„ç±»å‹" class="headerlink" title="Limiting Injectable Types (é™åˆ¶æ³¨å…¥çš„ç±»å‹)"></a>Limiting Injectable Types (é™åˆ¶æ³¨å…¥çš„ç±»å‹)</h2><p>ä½¿ç”¨ <code>@Bean</code> æ³¨è§£æ¥é™å®šå…è®¸æ³¨å…¥çš„æ¥å£æˆ–ç±», è€Œä¸æ˜¯å…·ä½“çš„ç±»å‹</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Bean</span>(typed = Engine) <span class="comment">// </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123;  <span class="comment">// </span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123; <span class="string">&quot;Starting V8&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">int</span> getCylinders() &#123; <span class="number">8</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Bean(typed = Engine)</code> é™å®šäº†åªèƒ½ä½¿ç”¨ <code>Engine</code> æ¥å£æ¥è¿›è¡Œä¾èµ–æ³¨å…¥, è€Œä¸èƒ½ä½¿ç”¨ <code>V8Engine</code> ç±»æ¥è¿›è¡Œä¾èµ–æ³¨å…¥</p>
<p><code>V8Engine</code> ç±»å¿…é¡»å®ç° <code>@Bean</code> æ³¨è§£ä¸­å£°æ˜çš„ç±»æˆ–æ¥å£, å¦åˆ™å°†ä¼šäº§ç”Ÿç¼–è¯‘æ—¶å¼‚å¸¸</p>
<h2 id="Scopes-ä½œç”¨åŸŸ"><a href="#Scopes-ä½œç”¨åŸŸ" class="headerlink" title="Scopes (ä½œç”¨åŸŸ)"></a>Scopes (ä½œç”¨åŸŸ)</h2><h3 id="Built-In-Scopes-å†…å»ºçš„ä½œç”¨åŸŸ"><a href="#Built-In-Scopes-å†…å»ºçš„ä½œç”¨åŸŸ" class="headerlink" title="Built-In Scopes (å†…å»ºçš„ä½œç”¨åŸŸ)"></a>Built-In Scopes (å†…å»ºçš„ä½œç”¨åŸŸ)</h3><p>Table - Micronaut Built-in Scopes</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>@Singleton</code></td>
<td align="left">Singleton scope indicates only one instance of the bean will exist</td>
</tr>
<tr>
<td align="left"><code>@Context</code></td>
<td align="left">Context scope indicates that the bean will be created at the same time as the ApplicationContext (eager initialization)</td>
</tr>
<tr>
<td align="left"><code>@Prototype</code></td>
<td align="left">Prototype scope indicates that a new instance of the bean is created each time it is injected</td>
</tr>
<tr>
<td align="left"><code>@Infrastructure</code></td>
<td align="left">Infrastructure scope represents a bean that cannot be override or replaced using <code>@Replaces</code> because it is critical to the functioning of the system</td>
</tr>
<tr>
<td align="left"><code>@ThreadLocal</code></td>
<td align="left"><code>@ThreadLocal</code> scope is a custom scope that associates a bean per thread via a ThreadLocal</td>
</tr>
<tr>
<td align="left"><code>@Refreshable</code></td>
<td align="left"><code>@Refreshable</code> scope is a custom scope that allows a beanâ€™s state to be refreshed via the <code>/refresh</code> endpoint</td>
</tr>
<tr>
<td align="left"><code>@RequestScope</code></td>
<td align="left"><code>@RequestScope</code> scope is a custom scope that indicates a new instance of the bean is created and associated with each HTTP request</td>
</tr>
</tbody></table>
<p><code>@Prototype</code> æ³¨è§£æ˜¯ <code>@Bean</code> æ³¨è§£çš„åŒä¹‰è¯, å› ä¸ºé»˜è®¤çš„ scope æ˜¯ prototype çš„</p>
<p>å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ªå®ç°äº† <code>CustomScope</code> æ¥å£çš„ <code>@Singleton</code> Bean æ¥æ·»åŠ é¢å¤–çš„ scope</p>
<p>é»˜è®¤æƒ…å†µä¸‹, åœ¨å¯åŠ¨ä¸€ä¸ª <code>ApplicationContext</code> æ—¶, å°†ä¼šå»¶è¿Ÿä¸æŒ‰éœ€åˆ›å»º <code>@Singleton</code> scope çš„ Bean</p>
<p>å¯ä»¥ä½¿ç”¨ <code>@Context</code> æ³¨è§£æ¥å°† Bean çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåˆ° <code>ApplicationContext</code> ä¸Š, æ¢å¥è¯è¯´, å°±æ˜¯åœ¨ <code>ApplicationContext</code> å¯åŠ¨çš„æ—¶å€™åˆ›å»ºè¿™ä¸ª Bean</p>
<p>æˆ–è€…, ä½¿ç”¨ <code>@Parallel</code> æ³¨è§£æ¥ä¿®é¥°ä¸€ä¸ª <code>@Singleton</code> scope çš„ Bean, å…è®¸å¹¶è¡Œåˆå§‹åŒ–è¿™ä¸ª Bean</p>
<p>å¦‚æœä½ çš„ Bean åœ¨å¹¶è¡Œåˆå§‹åŒ–çš„æ—¶å€™å¤±è´¥äº†, é‚£ä¹ˆæ•´ä¸ª Application å°†ä¼šè‡ªåŠ¨å…³é—­</p>
<h4 id="Eager-Initialization-of-Singletons-å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–"><a href="#Eager-Initialization-of-Singletons-å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–" class="headerlink" title="Eager Initialization of Singletons (å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–)"></a>Eager Initialization of Singletons (å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–)</h4><p>é€šè¿‡ <code>ApplicationContextBuilder</code> æ¥å£æ¥è¿›è¡Œé…ç½®</p>
<p>Example - Enabling Eager Initialization of Singletons:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Micronaut.build(args)</span><br><span class="line">                 .eagerInitSingletons(<span class="literal">true</span>)</span><br><span class="line">                 .mainClass(Application.class)</span><br><span class="line">                 .start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>Serverless Functions</code> ä¸­:</p>
<p>Example - Override of newApplicationContextBuilder():</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFunctionHandler</span> <span class="keyword">extends</span> <span class="title class_">MicronautRequestHandler</span>&lt;APIGatewayProxyRequestEvent, APIGatewayProxyResponseEvent&gt; &#123;</span><br><span class="line">    <span class="meta">@Nonnull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> ApplicationContextBuilder <span class="title function_">newApplicationContextBuilder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContextBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="built_in">super</span>.newApplicationContextBuilder();</span><br><span class="line">        builder.eagerInitSingletons(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> builder;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@ConfigurationReader</code> Beans ä¾‹å¦‚ <code>@EachProperty</code>,<code>@ConfigurationProperties</code> æ˜¯ Singleton Beans. ä¸ºäº† é¥¥é¥¿åœ°åˆå§‹åŒ–(<code>eagerly init configuration</code>) è¿™äº›é…ç½® Beans ä½†ä¿æŒå…¶ä»– Singleton Beans å»¶è¿Ÿåˆå§‹åŒ–, ä½¿ç”¨ <code>eagerInitConfiguration</code>:</p>
<p>Example - Enabling Initialization of Configuration:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Micronaut.build(args)</span><br><span class="line">                 .eagerInitConfiguration(<span class="literal">true</span>)</span><br><span class="line">                 .mainClass(Application.class)</span><br><span class="line">                 .start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Refreshable-Scope-å¯åˆ·æ–°çš„ä½œç”¨åŸŸ"><a href="#Refreshable-Scope-å¯åˆ·æ–°çš„ä½œç”¨åŸŸ" class="headerlink" title="Refreshable Scope (å¯åˆ·æ–°çš„ä½œç”¨åŸŸ)"></a>Refreshable Scope (å¯åˆ·æ–°çš„ä½œç”¨åŸŸ)</h3><p><code>Refreshable</code> scope æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ scope, å…è®¸ Bean çš„çŠ¶æ€é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥è¿›è¡Œåˆ·æ–°:</p>
<ul>
<li><code>/refresh</code> endpoint</li>
<li>å‘å¸ƒä¸€ä¸ª <code>RefreshEvent</code> äº‹ä»¶</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Refreshable</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WeatherService</span> &#123;</span><br><span class="line">    String forecast</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="type">void</span> init() &#123;</span><br><span class="line">        forecast = <span class="string">&quot;Scattered Clouds $&#123;new SimpleDateFormat(&#x27;dd/MMM/yy HH:mm:ss.SSS&#x27;).format(new Date())&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String latestForecast() &#123; forecast &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“è°ƒç”¨ <code>/refresh</code> endpoint æˆ–è€…è§¦å‘ä¸€ä¸ª <code>RefreshEvent</code> äº‹ä»¶æ—¶, å½“å‰çš„ <code>WeatherService</code> å®ä¾‹å°†ä¼šå¤±æ•ˆ, ä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡å°†ä¼šåœ¨ä¸‹æ¬¡è¯·æ±‚è¿™ä¸ªå®ä¾‹æ—¶åˆ›å»º</p>
<p>è§¦å‘ <code>RefreshEvent</code> äº‹ä»¶: <code>applicationContext.publishEvent(new RefreshEvent())</code></p>
<h3 id="Scopes-on-Meta-Annotations-å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ"><a href="#Scopes-on-Meta-Annotations-å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ" class="headerlink" title="Scopes on Meta Annotations (å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ)"></a>Scopes on Meta Annotations (å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ)</h3><p>å¯ä»¥åœ¨å…ƒæ³¨è§£ä¸Šå£°æ˜ Scope, å…ƒæ³¨è§£ä¸Šå£°æ˜çš„ Scope å°†ä¼šåº”ç”¨åˆ°æ‰€æœ‰è¢«è¿™ä¸ªæ³¨è§£ä¿®é¥°çš„ç±»ä¸Š</p>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Requires</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME</span><br><span class="line"></span><br><span class="line"><span class="meta">@Requires(classes = Car.class)</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="meta">@interface</span> Driver &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Example - ä½¿ç”¨è¿™ä¸ªå…ƒæ³¨è§£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Driver</span></span><br><span class="line"><span class="meta">@Prototype</span>      <span class="comment">// è¿™ä¸ªä¾‹å¤–å£°æ˜çš„ Scope å°†ä¸ä¼šç”Ÿæ•ˆ, Foo ç±»çš„ Scope ä¸º @Driver ä¸­å£°æ˜çš„ Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ä½¿å¾— Scope å¯ä»¥è¢«è¦†ç›–, ä½¿ç”¨ <code>@DefaultScope</code> æ³¨è§£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Requires(classes = Car.class)</span></span><br><span class="line"><span class="meta">@DefaultScope(Singleton.class)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="meta">@interface</span> Driver &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Bean-Factories-Bean-å·¥å‚"><a href="#Bean-Factories-Bean-å·¥å‚" class="headerlink" title="Bean Factories Bean (å·¥å‚)"></a>Bean Factories Bean (å·¥å‚)</h2><p>ä¸€ä¸ª Factory æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>@Factory</code> æ³¨è§£ä¿®é¥°çš„ç±», è¿™ä¸ªç±»æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªä½¿ç”¨ Scope æ³¨è§£ä¿®é¥°çš„æ–¹æ³•, æ‰€ä»¥è¿™ä¸ªç±»æ˜¯ç”¨æ¥å£°æ˜ Bean çš„, é€šå¸¸ç”¨äºå°†ç¬¬ä¸‰æ–¹åº“ä¸­çš„ç±»å£°æ˜ä¸º Bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    Engine <span class="title function_">v8Engine</span><span class="params">(CrankShaft crankShaft)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">V8Engine</span>(crankShaft)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Factory ä¸­çš„æ–¹æ³•çš„å‚æ•°è¢«è§£æä¸º Bean å¹¶è¿›è¡Œäº†æ³¨å…¥, ä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ <code>CrankShaft crankShaft</code></p>
<p>åœ¨ Factory ä¸­åº”è¯¥ä½¿ç”¨æ–¹æ³•å‚æ•°æ¥æ³¨å…¥è¿™ä¸ª Factory ä¸­çš„å…¶ä»– Bean, è€Œä¸æ˜¯è°ƒç”¨ Factory ä¸­çš„æ–¹æ³•</p>
<p>ä¸ºäº†ä½¿å¾— Factory ä¸­çš„ Bean å¯ä»¥å‚ä¸åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å…³é—­è¿‡ç¨‹, åº”è¯¥ä½¿ç”¨ <code>@Bean</code> æ³¨è§£å¹¶é…ç½® <code>@Bean</code> æ³¨è§£çš„ <code>preDestroy</code> å‚æ•°æ¥æŒ‡æ˜å…³é—­æ—¶è¦æ‰§è¡Œçš„æ–¹æ³•</p>
<h3 id="Programmatically-Disabling-Beans-ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ–-Beans"><a href="#Programmatically-Disabling-Beans-ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ–-Beans" class="headerlink" title="Programmatically Disabling Beans (ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ– Beans)"></a>Programmatically Disabling Beans (ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ– Beans)</h3><p>Factory æ–¹æ³•å¯ä»¥æŠ›å‡ºä¸€ä¸ª <code>DisabledBeanException</code> æ¥æœ‰æ¡ä»¶åœ°æ— æ•ˆåŒ– Beans</p>
<p>å»ºè®®ä½¿ç”¨ <code>@Requires</code> æ¥æ¡ä»¶åŒ–åˆ›å»º Beans</p>
<p>åªæœ‰åœ¨ <code>@Requires</code> æ— æ³•ä½¿ç”¨çš„æ—¶å€™æ‰é€šè¿‡åœ¨ Factory æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼æ¥æ¡ä»¶åŒ–åˆ›å»º Beans</p>
<p>Example:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Engine</span> &#123;</span><br><span class="line">    Integer getCylinders()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EachProperty</span>(<span class="string">&quot;engines&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineConfiguration</span> <span class="keyword">implements</span> <span class="title class_">Toggleable</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> enabled = <span class="literal">true</span></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    Integer cylinders</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineFactory</span> &#123;</span><br><span class="line">    <span class="meta">@EachBean</span>(EngineConfiguration)</span><br><span class="line">    Engine buildEngine(EngineConfiguration engineConfiguration) &#123;</span><br><span class="line">        <span class="keyword">if</span> (engineConfiguration.enabled) &#123;</span><br><span class="line">            (Engine)&#123;-&gt; engineConfiguration.cylinders&#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> DisabledBeanException(<span class="string">&quot;Engine configuration disabled&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Injection-Point-æ³¨å…¥ç‚¹"><a href="#Injection-Point-æ³¨å…¥ç‚¹" class="headerlink" title="Injection Point (æ³¨å…¥ç‚¹)"></a>Injection Point (æ³¨å…¥ç‚¹)</h3><p>åœ¨æ³¨å…¥ä¸€ä¸ª Bean æ—¶, é€šè¿‡è¿™ä¸ª Bean ä¸Šçš„æ³¨è§£çš„å€¼æ¥å†³å®šå“ªä¸ª Bean éœ€è¦è¿›è¡Œå®ä¾‹åŒ–</p>
<p>Example - å£°æ˜ä¸€ä¸ªæœ‰å€¼çš„æ³¨è§£:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.PARAMETER)</span><br><span class="line"><span class="meta">@interface</span> Cylinders &#123;</span><br><span class="line">    <span class="type">int</span> value() <span class="keyword">default</span> <span class="number">8</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The above annotation could be used to customize the type of engine we want to inject into a vehicle at the point at which the injection point is defined:</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Engine engine</span><br><span class="line"></span><br><span class="line">    Vehicle(<span class="meta">@Cylinders</span>(<span class="number">6</span>) Engine engine) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.engine = engine</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="keyword">return</span> engine.start()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>To implement this use case, define a factory that accepts the InjectionPoint instance to analyze the defined annotation values:</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Prototype</span></span><br><span class="line">    Engine v8Engine(InjectionPoint&lt;?&gt; injectPoint, CrankShaft crankShaft) &#123;</span><br><span class="line">        final int cylinders = injectPoint.getAnnotationMetadata()</span><br><span class="line">                                         .intValue(Cylinders.class)</span><br><span class="line">                                         .orElse(<span class="number">8</span>)</span><br><span class="line">        switch (cylinders) &#123;</span><br><span class="line">            case <span class="number">6</span>: <span class="keyword">return</span> <span class="keyword">new</span> V6Engine(crankShaft)</span><br><span class="line">            <span class="keyword">case</span> <span class="number">8</span>: <span class="keyword">return</span> <span class="keyword">new</span> V8Engine(crankShaft)</span><br><span class="line">            <span class="symbol">default:</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Unsupported number of cylinders specified: $cylinders&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>@Prototype</code> æ³¨è§£æ¥ä½¿å¾—æ–¹æ³•åœ¨æ¯ä¸€ä¸ª æ³¨å…¥ç‚¹(<code>injection point</code>) éƒ½ä¼šè¢«è°ƒç”¨; å¦‚æœ <code>V8Engine</code> å’Œ <code>V6Engine</code> éœ€è¦æ˜¯ Singleton çš„, é‚£ä¹ˆè¦åœ¨ Factory ä¸­ä½¿ç”¨ Map æ¥ä¿è¯å®ä¾‹åªåˆ›å»ºäº†ä¸€æ¬¡</p>
<h3 id="Beans-from-Fields-åœ¨å­—æ®µä¸­å£°æ˜-Beans"><a href="#Beans-from-Fields-åœ¨å­—æ®µä¸­å£°æ˜-Beans" class="headerlink" title="Beans from Fields (åœ¨å­—æ®µä¸­å£°æ˜ Beans)"></a>Beans from Fields (åœ¨å­—æ®µä¸­å£°æ˜ Beans)</h3><p>åœ¨ Micronaut 3.0 æˆ–ä»¥ä¸Šç‰ˆæœ¬ä¸­, å¯ä»¥é€šè¿‡åœ¨å­—æ®µ(fields)ä¸Šå£°æ˜ <code>@Bean</code> æ³¨è§£æ¥ä»å­—æ®µ(fields)ä¸­æä¾› Bean</p>
<p>æ›´æ¨èçš„åšæ³•æ˜¯ä½¿ç”¨ Factory æ¥åˆ›å»º Bean, ä½†é€šè¿‡å­—æ®µæ¥æä¾› Bean å¯ä»¥æä¾›æ›´å¤§çš„çµæ´»æ€§æ¥ç®€åŒ–æµ‹è¯•ä»£ç ç¼–å†™:</p>
<p>Example - é€šè¿‡ Bean å­—æ®µæ¥æä¾› Mock Bean:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.*</span><br><span class="line"><span class="keyword">import</span> io.micronaut.test.extensions.spock.annotation.MicronautTest</span><br><span class="line"><span class="keyword">import</span> spock.lang.Specification</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Inject</span><br><span class="line"></span><br><span class="line"><span class="meta">@MicronautTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">VehicleMockSpec</span> <span class="keyword">extends</span> <span class="title class_">Specification</span> &#123;</span><br><span class="line">    <span class="meta">@Requires</span>(beans = VehicleMockSpec.<span class="keyword">class</span>)</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Replaces</span>(Engine.<span class="keyword">class</span>)</span><br><span class="line">    Engine mockEngine = &#123;-&gt; <span class="string">&quot;Mock Started&quot;</span>&#125; <span class="keyword">as</span> Engine   <span class="comment">// A bean is defined from a field that replaces the existing Engine</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Vehicle vehicle</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="string">&quot;test start engine&quot;</span>() &#123;</span><br><span class="line">        <span class="symbol">given:</span></span><br><span class="line">            <span class="keyword">final</span> String result = vehicle.start()</span><br><span class="line">        <span class="symbol">expect:</span></span><br><span class="line">            result == <span class="string">&#x27;Mock Started&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åªæ”¯æŒ non-primitive ç±»å‹çš„ public æˆ–è€… package protected çš„ fields</p>
<h3 id="Primitive-Beans-and-Arrays-åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„-Bean"><a href="#Primitive-Beans-and-Arrays-åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„-Bean" class="headerlink" title="Primitive Beans and Arrays (åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„ Bean)"></a>Primitive Beans and Arrays (åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„ Bean)</h3><p>ä» Micronaut 3.1 å¼€å§‹æ”¯æŒä» Factory ä¸­å®šä¹‰å’Œæ³¨å…¥åŸå§‹ç±»å‹å’Œæ•°ç»„ç±»å‹</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Bean</span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Factory</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Named</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CylinderFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">&#x27;V8&#x27;</span>)</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> v8 = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">&#x27;V6&#x27;</span>)</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> v6 = <span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">v8Engine</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> cylinders</span><br><span class="line"></span><br><span class="line">    V8Engine(<span class="meta">@Named</span>(<span class="string">&#x27;V8&#x27;</span>) <span class="type">int</span> cylinders) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.cylinders = cylinders</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> getCylinders() &#123; cylinders &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸå§‹ç±»å‹å’Œæ•°ç»„ç±»å‹ Bean æœ‰å¦‚ä¸‹é™åˆ¶:</p>
<ul>
<li>AOP advice æ— æ³•åº”ç”¨åœ¨åŸå§‹ç±»å‹æˆ–å…¶åŒ…è£…ç±»å‹ä¸Š</li>
<li><blockquote>
<p>Due to the above custom scopes that proxy are not supported</p>
</blockquote>
</li>
<li><blockquote>
<p>The @Bean(preDestroy&#x3D;..) member is not supported</p>
</blockquote>
</li>
</ul>
<h2 id="Conditional-Beans-æ¡ä»¶åŒ–åŠ è½½-Beans"><a href="#Conditional-Beans-æ¡ä»¶åŒ–åŠ è½½-Beans" class="headerlink" title="Conditional Beans (æ¡ä»¶åŒ–åŠ è½½ Beans)"></a>Conditional Beans (æ¡ä»¶åŒ–åŠ è½½ Beans)</h2><p>æœ‰æ—¶å€™ä½ å¸Œæœ›æœ‰æ¡ä»¶åœ°åŠ è½½ä¸€ä¸ª Bean, ä¾‹å¦‚åŸºäº classpath, configuration, bean çš„ä¼˜å…ˆçº§</p>
<p><code>@Requires</code> æ³¨è§£æä¾›äº†åœ¨ Bean ä¸Šå®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶çš„èƒ½åŠ›</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Requires</span>(beans = DataSource)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;datasource.url&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JdbcBookService</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    DataSource datasource</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰å¤šä¸ª Bean è¦æ±‚ç›¸åŒçš„æ¡ä»¶, å¯ä»¥ä½¿ç”¨å…ƒæ³¨è§£æ¥å£°æ˜è¿™äº›æ¡ä»¶:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Requires</span>(beans = DataSource)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;datasource.url&#x27;</span>)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>([ElementType.PACKAGE, ElementType.TYPE])</span><br><span class="line"><span class="meta">@interface</span> RequiresJdbc &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequiresJdbc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcBookService</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Configuration-Requirements-é…ç½®è¦æ±‚"><a href="#Configuration-Requirements-é…ç½®è¦æ±‚" class="headerlink" title="Configuration Requirements (é…ç½®è¦æ±‚)"></a>Configuration Requirements (é…ç½®è¦æ±‚)</h3><p>Table - Using <code>@Requires</code></p>
<table>
<thead>
<tr>
<th align="left">Requirement</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Require the presence of one or more classes</td>
<td align="left"><code>@Requires(classes=javax.servlet.Servlet)</code></td>
</tr>
<tr>
<td align="left">Require the absence of one or more classes</td>
<td align="left"><code>@Requires(missing=javax.servlet.Servlet)</code></td>
</tr>
<tr>
<td align="left">Require the presence of one or more beans</td>
<td align="left"><code>@Requires(beans=javax.servlet.DataSource)</code></td>
</tr>
<tr>
<td align="left">Require the absence of one or more beans</td>
<td align="left"><code>@Requires(missingBeans=javax.servlet.DataSource)</code></td>
</tr>
<tr>
<td align="left">Require the environment to be applied</td>
<td align="left"><code>@Requires(env=&quot;test&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the environment not to be applied</td>
<td align="left"><code>@Requires(notEnv=&quot;test&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the presence of another configuration package</td>
<td align="left"><code>@Requires(configuration=&quot;foo.bar&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the absence of another configuration package</td>
<td align="left"><code>@Requires(missingConfiguration=&quot;foo.bar&quot;)</code></td>
</tr>
<tr>
<td align="left">Require particular SDK version</td>
<td align="left"><code>@Requires(sdk=Sdk.JAVA, value=&quot;1.8&quot;)</code></td>
</tr>
<tr>
<td align="left">Requires classes annotated with the given annotations to be available to the application via package scanning</td>
<td align="left"><code>@Requires(entities=javax.persistence.Entity)</code></td>
</tr>
<tr>
<td align="left">Require a property with an optional value</td>
<td align="left"><code>@Requires(property=&quot;data-source.url&quot;)</code></td>
</tr>
<tr>
<td align="left">Require a property to not be part of the configuration</td>
<td align="left"><code>@Requires(missingProperty=&quot;data-source.url&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the presence of one or more files in the file system</td>
<td align="left"><code>@Requires(resources=&quot;file:/path/to/file&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the presence of one or more classpath resouces</td>
<td align="left"><code>@Requires(resources=&quot;classpath:myFile.properties&quot;)</code></td>
</tr>
<tr>
<td align="left">Require the current operating system to be in the list</td>
<td align="left"><code>@Requires(os=&#123;Requires.Family.WINDOWS&#125;)</code></td>
</tr>
<tr>
<td align="left">Require the current operating system to not be in the list</td>
<td align="left"><code>@Requires(notOs=&#123;Requires.Family.WINDOWS&#125;)</code></td>
</tr>
<tr>
<td align="left">Requires bean to be present in case no beanProperty specified</td>
<td align="left"><code>@Requires(bean=Config.class)</code></td>
</tr>
<tr>
<td align="left">Requires the specified property of bean to be present</td>
<td align="left"><code>@Requires(bean=Config.class, beanProperty=&quot;enabled&quot;)</code></td>
</tr>
</tbody></table>
<h4 id="Additional-Notes-on-Property-Requirements-å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯"><a href="#Additional-Notes-on-Property-Requirements-å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯" class="headerlink" title="Additional Notes on Property Requirements (å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯)"></a>Additional Notes on Property Requirements (å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯)</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;foo&#x27;</span>, value = <span class="string">&#x27;John&#x27;</span>)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;foo&#x27;</span>, value = <span class="string">&#x27;John&#x27;</span>, defaultValue = <span class="string">&#x27;John&#x27;</span>)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&#x27;foo&#x27;</span>, notEquals=<span class="string">&#x27;Sally&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Referencing-bean-properties-in-Requires-åœ¨-Requires-æ³¨è§£ä¸­å¼•ç”¨-Bean-å±æ€§"><a href="#Referencing-bean-properties-in-Requires-åœ¨-Requires-æ³¨è§£ä¸­å¼•ç”¨-Bean-å±æ€§" class="headerlink" title="Referencing bean properties in @Requires (åœ¨ @Requires æ³¨è§£ä¸­å¼•ç”¨ Bean å±æ€§)"></a>Referencing bean properties in @Requires (åœ¨ @Requires æ³¨è§£ä¸­å¼•ç”¨ Bean å±æ€§)</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Requires</span>(bean=Config.<span class="keyword">class</span>, beanProperty=<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"><span class="meta">@Requires</span>(bean=Config.<span class="keyword">class</span>, beanProperty=<span class="string">&#x27;foo&#x27;</span>, value = <span class="string">&#x27;John&#x27;</span>)</span><br><span class="line"><span class="meta">@Requires</span>(bean=Config.<span class="keyword">class</span>, beanProperty=<span class="string">&#x27;foo&#x27;</span>, notEquals = <span class="string">&#x27;Sally&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ getter æ–¹æ³•æ¥è¯»å– Bean å±æ€§</p>
<p>åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥</p>
<p>ä¼šæ£€æŸ¥ Bean å±æ€§æ˜¯å¦ä¸º null</p>
<h3 id="Debugging-Conditional-Beans-è°ƒè¯•æ¡ä»¶åŒ–çš„-Beans"><a href="#Debugging-Conditional-Beans-è°ƒè¯•æ¡ä»¶åŒ–çš„-Beans" class="headerlink" title="Debugging Conditional Beans (è°ƒè¯•æ¡ä»¶åŒ–çš„ Beans)"></a>Debugging Conditional Beans (è°ƒè¯•æ¡ä»¶åŒ–çš„ Beans)</h3><p>å¼€å¯ <code>io.micronaut.context.condition</code> åŒ…çš„æ—¥å¿— DEBUG è¾“å‡ºæ¥è§‚å¯Ÿ Beans å› ä¸ºä»€ä¹ˆåŸå› è€Œæ²¡æœ‰è¢«åŠ è½½</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// logback.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;io.micronaut.context.condition&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG /&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="Bean-Replacement-Bean-æ›¿ä»£"><a href="#Bean-Replacement-Bean-æ›¿ä»£" class="headerlink" title="Bean Replacement (Bean æ›¿ä»£)"></a>Bean Replacement (Bean æ›¿ä»£)</h2><p>Micronaut çš„ä¾èµ–æ³¨å…¥æ²¡æœ‰ Beanåç§° å’Œ åŠ è½½é¡ºåº çš„æ¦‚å¿µ</p>
<p>Micronaut çš„ Bean æœ‰ä¸€ä¸ª ç±»å‹ å’Œ Qualifier</p>
<p>ä½ ä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå®Œå…¨ä¸åŒç±»å‹çš„ Bean æ¥è¦†ç›–ä¸€ä¸ª Bean</p>
<p>Micronaut æä¾› <code>@Replaces</code> æ³¨è§£æ¥è¿›è¡Œ Bean è¦†ç›–</p>
<p>Example - é€šè¿‡åœ¨ä¸€ä¸ª Bean ä¸Šå£°æ˜ <code>@Replaces</code> æ³¨è§£æ¥è¦†ç›–ä¸€ä¸ªå·²å­˜åœ¨çš„ Bean:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¦è¢« replace çš„ç±»</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Requires</span>(beans = DataSource)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&quot;datasource.url&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JdbcBookService</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºäº†è¿›è¡Œæµ‹è¯•, åœ¨ src/test/groovy ä¸­è¿™ä¸ª JdbcBookService ç±»</span></span><br><span class="line"><span class="meta">@Replaces</span>(JdbcBookService.<span class="keyword">class</span>)</span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MockBookService</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    Map&lt;String, Book&gt; bookMap = [:]</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    Book findBook(String title) &#123; bookMap[title] &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Factory-Replacement-Factory-æ›¿ä»£"><a href="#Factory-Replacement-Factory-æ›¿ä»£" class="headerlink" title="Factory Replacement (Factory æ›¿ä»£)"></a>Factory Replacement (Factory æ›¿ä»£)</h3><p>è¦†ç›– Factory ä¸­ç”Ÿæˆçš„ Bean</p>
<p>Example - è¦è¢«è¦†ç›–çš„ Factory:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    Book novel() &#123; <span class="keyword">new</span> Book(<span class="string">&#x27;A Great Novel&#x27;</span>) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    TextBook textBook() &#123; <span class="keyword">new</span> TextBook(<span class="string">&#x27;Learning 101&#x27;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Example - è¦†ç›– Factory ä¸­çš„ Bean:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TextBookFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Replaces</span>(value = TextBook, factory = BookFactory)</span><br><span class="line">    TextBook textBook() &#123; <span class="keyword">new</span> TextBook(<span class="string">&#x27;Learning 305&#x27;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>BookFactory</code> ä¸­çš„ <code>novel()</code> æ–¹æ³•æ²¡æœ‰è¢«è¦†ç›–</p>
<h3 id="Default-Implementation-é»˜è®¤å®ç°"><a href="#Default-Implementation-é»˜è®¤å®ç°" class="headerlink" title="Default Implementation (é»˜è®¤å®ç°)"></a>Default Implementation (é»˜è®¤å®ç°)</h3><p>å½“æš´éœ²ä¸€ä¸ª API æ—¶, å¯èƒ½ä¸å¸Œæœ›å°†ä¸€ä¸ª interface çš„é»˜è®¤å®ç°ä½œä¸ºå…¬å¼€ API çš„ä¸€éƒ¨åˆ†. è¿™æ ·åšå¯ä»¥é˜²æ­¢ç”¨æˆ·å»æ›¿æ¢é»˜è®¤çš„å®ç°ç±», å› ä¸ºç”¨æˆ·ä¸èƒ½å¼•ç”¨åˆ°è¿™ä¸ªç±»</p>
<p>è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ <code>@DefaultImplementation</code> æ³¨è§£ä¿®é¥°ä¸€ä¸ªæ¥å£, æŒ‡æ˜ç”¨æˆ·ä½¿ç”¨ <code>@Replaces(YourInterface.class)</code> æ—¶è¦†ç›–äº†å“ªä¸ªæ¥å£å®ç°</p>
<p>Example:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.DefaultImplementation</span><br><span class="line"></span><br><span class="line"><span class="meta">@DefaultImplementation</span>(DefaultResponseStrategy)</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ResponseStrategy</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The default implementation</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DefaultResponseStrategy</span> <span class="keyword">implements</span> <span class="title class_">ResponseStrategy</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Example - The custom implementation:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Replaces</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Replaces</span>(ResponseStrategy)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomResponseStrategy</span> <span class="keyword">implements</span> <span class="title class_">ResponseStrategy</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Bean-Configurations-Bean-é…ç½®"><a href="#Bean-Configurations-Bean-é…ç½®" class="headerlink" title="Bean Configurations (Bean é…ç½®)"></a>Bean Configurations (Bean é…ç½®)</h2><p>åœ¨åŒ…çº§åˆ«ä¸Šè¿›è¡Œé…ç½®, ä½¿å¾—é…ç½®ä½œç”¨äºåŒ…ä¸­æ‰€æœ‰çš„ Bean</p>
<p>Example:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package-info.groovy</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Requires</span>(beans = javax.sql.Datasource)</span><br><span class="line"><span class="keyword">package</span> my.<span class="keyword">package</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­, æŒ‡æ˜äº† <code>my.package</code> ä¸­çš„æ‰€æœ‰çš„ Bean åªæœ‰åœ¨ <code>javax.sql.DataSource</code> ç±»å­˜åœ¨æ—¶æ‰è¿›è¡ŒåŠ è½½</p>
<h2 id="Life-Cycle-Methods-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"><a href="#Life-Cycle-Methods-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" class="headerlink" title="Life-Cycle Methods (ç”Ÿå‘½å‘¨æœŸæ–¹æ³•)"></a>Life-Cycle Methods (ç”Ÿå‘½å‘¨æœŸæ–¹æ³•)</h2><h3 id="When-The-Context-Starts-Context-å¯åŠ¨æ—¶"><a href="#When-The-Context-Starts-Context-å¯åŠ¨æ—¶" class="headerlink" title="When The Context Starts (Context å¯åŠ¨æ—¶)"></a>When The Context Starts (Context å¯åŠ¨æ—¶)</h3><p>ä½¿ç”¨ <code>jakarta.annotation.PostConstruct</code> æ³¨è§£æ¥åœ¨ Bean æ„é€ ä¹‹åè°ƒç”¨ä¸€ä¸ªæ–¹æ³•:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.annotation.PostConstruct</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123;</span><br><span class="line">    <span class="type">int</span> cylinders = <span class="number">8</span></span><br><span class="line">    <span class="type">boolean</span> initialized = <span class="literal">false</span> <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="keyword">if</span> (!initialized) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;Engine not initialized!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Starting V8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="type">void</span> initialize() &#123;</span><br><span class="line">        initialized = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>A method is annotated with @PostConstruct and will be invoked once the object is constructed and fully injected.</p>
</blockquote>
<h3 id="When-The-Context-Closes-Context-å…³é—­æ—¶"><a href="#When-The-Context-Closes-Context-å…³é—­æ—¶" class="headerlink" title="When The Context Closes (Context å…³é—­æ—¶)"></a>When The Context Closes (Context å…³é—­æ—¶)</h3><p>ä½¿ç”¨ <code>javax.annotation.PreDestroy</code> æ³¨è§£æ¥åœ¨ä¸€ä¸ª Context å…³é—­ä¹‹åè°ƒç”¨ä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.annotation.PreDestroy</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"><span class="keyword">import</span>. java.util.concurrent.atomic.AtomicBoolean</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PreDestroyBean</span> <span class="keyword">implements</span> <span class="title class_">AutoCloseable</span> &#123;</span><br><span class="line"></span><br><span class="line">    AtomicBoolean stopped = <span class="keyword">new</span> AtomicBoolean(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">void</span> close() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        stopped.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>A method is annotated with @PreDestroy and will be invoked when the context is closed.</p>
</blockquote>
<p>åœ¨ Factory ç±»ä¸­, <code>@Bean</code> æ³¨è§£ä¸­çš„ <code>preDestroy</code> å€¼å‘Šè¯‰ Micronaut å»æ‰§è¡Œå“ªä¸ªæ–¹æ³•:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Bean</span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Factory</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConnectionFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span>(preDestroy = <span class="string">&#x27;stop&#x27;</span>)</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    Connection connection() &#123; <span class="keyword">new</span> Connection() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The Connection Bean</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Connection</span> &#123;</span><br><span class="line"></span><br><span class="line">    AtomicBoolean stopped = <span class="keyword">new</span> AtomicBoolean(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> stop() &#123; </span><br><span class="line">        stopped.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ Context æ¥å…³é—­ä¸€ä¸ª Bean, ç®€å•åœ°å®ç° <code>Closeable</code> æˆ– <code>AutoCloseable</code> æ¥å£æ˜¯ä¸å¤Ÿçš„, å¿…é¡»ä½¿ç”¨ä¸Šé¢æåˆ°çš„å…¶ä¸­ä¸€ä¸ªæ–¹æ³•</p>
<h2 id="Context-Events-Context-äº‹ä»¶"><a href="#Context-Events-Context-äº‹ä»¶" class="headerlink" title="Context Events (Context äº‹ä»¶)"></a>Context Events (Context äº‹ä»¶)</h2><p>Micronaut é€šè¿‡ Context æ¥æä¾›ä¸€ä¸ªé€šç”¨äº‹ä»¶ç³»ç»Ÿ</p>
<p><code>ApplicationEventPublisher</code> API ç”¨æ¥å‘å¸ƒäº‹ä»¶</p>
<p><code>ApplicationEventListener</code> API ç”¨æ¥ç›‘å¬äº‹ä»¶</p>
<p>ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰äº‹ä»¶</p>
<h3 id="Publishing-Events-å‘å¸ƒäº‹ä»¶"><a href="#Publishing-Events-å‘å¸ƒäº‹ä»¶" class="headerlink" title="Publishing Events (å‘å¸ƒäº‹ä»¶)"></a>Publishing Events (å‘å¸ƒäº‹ä»¶)</h3><p>Example - Publishing an Event:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEvent</span> &#123;</span><br><span class="line">    String message = <span class="string">&#x27;Something happened&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.event.ApplicationEventPublisher</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Inject</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventEmitterBean</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    ApplicationEventPublisher&lt;SampleEvent&gt; eventPublisher</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> publishSampleEvent() &#123;</span><br><span class="line">        eventPublisher.publishEvent(<span class="keyword">new</span> SampleEvent())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ä¸€ä¸ª <code>ApplicationEventPublisher</code> Bean æ¥è¿›è¡Œäº‹ä»¶å‘å¸ƒ</p>
<p><code>ApplicationEventPublisher</code> çš„æ³›å‹ä»£è¡¨äº†è¦å‘å¸ƒçš„äº‹ä»¶ç±»å‹</p>
<p>ä½¿ç”¨ <code>ApplicationEventPublisher.#publishEvent</code> æ–¹æ³•æ¥å‘å¸ƒå¯¹åº”ç±»å‹çš„äº‹ä»¶</p>
<p>å‘å¸ƒäº‹ä»¶é»˜è®¤æ˜¯åŒæ­¥çš„(<code>synchronous</code>)</p>
<blockquote>
<p>The <code>publishEvent</code> method will not return until all listeners have been executed. Move this work off to a thread pool if it is time-intensive</p>
</blockquote>
<p><code>publishEvent</code> æ–¹æ³•åœ¨æ‰€æœ‰ç›‘å¬å™¨æ‰§è¡Œå®Œä¹‹å‰ä¸ä¼šè¿”å›. å¦‚æœè¿™ä¸ªå·¥ä½œæ˜¯æ—¶é—´æ•æ„Ÿå‹çš„, å°†è¿™ä¸ªå·¥ä½œç§»åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ä¸­æ‰§è¡Œ</p>
<h3 id="Listening-for-Events-ç›‘å¬äº‹ä»¶"><a href="#Listening-for-Events-ç›‘å¬äº‹ä»¶" class="headerlink" title="Listening for Events (ç›‘å¬äº‹ä»¶)"></a>Listening for Events (ç›‘å¬äº‹ä»¶)</h3><p>è¦ç›‘å¬ä¸€ä¸ªäº‹ä»¶, æ³¨å†Œä¸€ä¸ªå®ç°äº† <code>ApplicationEventListener</code> æ¥å£çš„ Bean, <code>ApplicatoinEventListener</code> çš„æ³›å‹ä»£è¡¨äº†è¦ç›‘å¬çš„äº‹ä»¶ç±»å‹</p>
<p>Example - Listening for Events with <code>ApplicationEventListener</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.event.ApplicationEventListener</span><br><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEvent <span class="comment">// è‡ªå®šä¹‰çš„äº‹ä»¶</span></span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventListener</span> <span class="keyword">implements</span> <span class="title class_">ApplicationEventListener</span>&lt;SampleEvent&gt; &#123;</span><br><span class="line">    <span class="type">int</span> invocationCounter = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">void</span> onApplicationEvent(SampleEvent event) &#123;</span><br><span class="line">        invocationCounter++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Example - æµ‹è¯•äº‹ä»¶å‘å¸ƒæ¥æ”¶:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.ApplicationContext</span><br><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEventEmitterBean</span><br><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEventListener</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> spock.lang.Specification</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventListenerSpec</span> <span class="keyword">extends</span> <span class="title class_">Specification</span> &#123;</span><br><span class="line">    <span class="type">void</span> <span class="string">&#x27;test event listener is notified&#x27;</span>() &#123;</span><br><span class="line">        <span class="symbol">given:</span></span><br><span class="line">            ApplicationContext context = ApplicationContext.run()</span><br><span class="line">            SampleEventEmitterBean emitter = context.getBean(SampleEventEmitterBean)</span><br><span class="line">            SampleEventListener listener = context.getBean(SampleEventListener)</span><br><span class="line">        </span><br><span class="line">        <span class="symbol">expect:</span></span><br><span class="line">            listener.invocationCounter == <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="symbol">when:</span></span><br><span class="line">            emitter.publishSampleEvent()</span><br><span class="line"></span><br><span class="line">        <span class="symbol">then:</span></span><br><span class="line">            listener.invocationCounter == <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="symbol">cleanup:</span></span><br><span class="line">            context.close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨ <code>ApplicationEventListener.#supports</code> æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªäº‹ä»¶æ˜¯å¦å¯ä»¥å¤„ç†</p>
<p>å¦‚æœä½ ä¸æƒ³å®ç°ä¸€ä¸ªæ¥å£, æˆ–è€…åˆ©ç”¨å…¶ä¸­ä¸€ä¸ªå†…å»ºäº‹ä»¶å¦‚ <code>StartupEvent</code> å’Œ <code>ShutdownEvent</code> , é‚£ä¹ˆä½¿ç”¨ <code>@EventListener</code> æ³¨è§£</p>
<p>Example - Listening for Events with <code>@EventListener</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEvent</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.event.StartupEvent</span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.event.ShutdownEvent</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.micronaut.runtime.event.annotation.EventListener</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventListener</span> &#123;</span><br><span class="line">    <span class="type">int</span> invocationCounter = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="type">void</span> onSampleEvent(SampleEvent event) &#123;</span><br><span class="line">        invocationCounter++</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="type">void</span> onStartupEvent(StartupEvent event) &#123;</span><br><span class="line">        <span class="comment">// startup logic here</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="type">void</span> onShutdownEvent(ShutdownEvent event) &#123;</span><br><span class="line">        <span class="comment">// shutdown logic here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœäº‹ä»¶ç›‘å¬å™¨éœ€è¦æ‰§è¡Œä¸€æ®µæ—¶é—´, å¯ä»¥ä½¿ç”¨ <code>@Async</code> æ³¨è§£æ¥å°†æ“ä½œè¿è¡Œåœ¨ä¸€ä¸ªä¸åŒçš„çº¿ç¨‹ä¸Šé¢:</p>
<p>Example - Asynchronously listening for Events with <code>@EventListener</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEvent</span><br><span class="line"><span class="keyword">import</span> io.micronaut.runtime.event.annotation.EventListener</span><br><span class="line"><span class="keyword">import</span> io.micronaut.scheduling.annotation.Async</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventListener</span> &#123;</span><br><span class="line">    AtomicInteger invocationCounter = <span class="keyword">new</span> AtomicInteger(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="type">void</span> onSampleEvent(SampleEvent event) &#123; invocationCounter.getAndIncrement() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.ApplicationContext</span><br><span class="line"><span class="keyword">import</span> io.micronaut.docs.context.events.SampleEventEmitterBean</span><br><span class="line"><span class="keyword">import</span> spock.lang.Specification</span><br><span class="line"><span class="keyword">import</span> spock.util.concurrent.PollingConditions</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleEventListenerSpec</span> <span class="keyword">extends</span> <span class="title class_">Specification</span> &#123;</span><br><span class="line">    <span class="type">void</span> <span class="string">&#x27;test event listener is notified&#x27;</span>() &#123;</span><br><span class="line">        <span class="symbol">given:</span></span><br><span class="line">            <span class="keyword">def</span> context = ApplicationContext.run()</span><br><span class="line">            <span class="keyword">def</span> emitter = context.getBean(SampleEventEmitterBean)</span><br><span class="line">            <span class="keyword">def</span> listener = context.getBean(SampleEventListener)</span><br><span class="line"></span><br><span class="line">        <span class="symbol">expect:</span></span><br><span class="line">            listener.invocationCounter.get() == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="symbol">when:</span></span><br><span class="line">            emitter.publishSampleEvent()</span><br><span class="line">        </span><br><span class="line">        <span class="symbol">then:</span></span><br><span class="line">            <span class="keyword">new</span> PollingConditions(<span class="attr">timeout:</span> <span class="number">5</span>).eventually &#123;</span><br><span class="line">                listener.invocationCounter.get() == <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="symbol">cleanup:</span></span><br><span class="line">            context.close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äº‹ä»¶ç›‘å¬å™¨é»˜è®¤è¿è¡Œåœ¨ <code>scheduled executor</code> ä¸Š, å¯ä»¥åœ¨ <code>application.yml</code> ä¸Šé…ç½®è¿™ä¸ªçº¿ç¨‹æ± :</p>
<p>Example - Configuring Scheduled Task Thread Pool:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">micronaut:</span></span><br><span class="line">    <span class="attr">executors:</span></span><br><span class="line">        <span class="attr">scheduled:</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">scheduled</span></span><br><span class="line">            <span class="attr">core-pool-size:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure>

<h2 id="Bean-Events-Bean-äº‹ä»¶"><a href="#Bean-Events-Bean-äº‹ä»¶" class="headerlink" title="Bean Events (Bean äº‹ä»¶)"></a>Bean Events (Bean äº‹ä»¶)</h2><p>ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ¥å£æ¥æŒ‚æ¥(<code>hook</code>)åˆ° Beans çš„åˆ›å»ºä¸­:</p>
<ul>
<li><code>BeanInitializedEventListener</code> : å…è®¸å±æ€§éƒ½è®¾ç½®åä¹‹å, åœ¨ <code>@PostConstruct</code> äº‹ä»¶ hooks ä¹‹å‰ä¿®æ”¹å’Œæ›¿ä»£ä¸€ä¸ª Bean</li>
<li><code>BeanCreatedEventListener</code> : å…è®¸åœ¨ Bean å®Œå…¨åˆå§‹åŒ–äº†ä¸æ‰€æœ‰çš„ <code>@PostConstruct</code> hooks éƒ½æ‰§è¡Œäº†ä¹‹åä¿®æ”¹å’Œæ›¿ä»£ä¸€ä¸ª Bean</li>
</ul>
<p><code>BeanInitializedEventListener</code> æ¥å£é€šå¸¸å’Œ <code>Factory Bean</code> ç»“åˆä½¿ç”¨</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">V8Engine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> cylinders = <span class="number">8</span></span><br><span class="line">    <span class="type">double</span> rodLength </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    String start() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Starting V$cylinders [rodLength=$rodLength]&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> V8Engine engine</span><br><span class="line">    <span class="type">double</span> rodLength = <span class="number">5.7</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="type">void</span> initialize() &#123;</span><br><span class="line">        engine = <span class="keyword">new</span> V8Engine(<span class="attr">rodLength:</span> rodLength)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    Engine v8Engine() &#123; engine &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EngineInitializer</span> <span class="keyword">implements</span> <span class="title class_">BeanInitializedEventListener</span>&lt;EngineFactory&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    EngineFactory onInitialized(BeanInitializingEvent&lt;EngineFactory&gt; event) &#123;</span><br><span class="line">        EngineFactory engineFactory = event.bean</span><br><span class="line">        engineFactory.rodLength = <span class="number">6.6</span></span><br><span class="line">        engineFactory</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>BeanCreatedEventListener</code> æ¥å£æ›´å…¸å‹çš„ä½¿ç”¨æ˜¯ç”¨æ¥è£…é¥°æˆ–å¢å¼ºä¸€ä¸ªå®Œå…¨åˆå§‹åŒ–å¥½çš„ Bean, ä¾‹å¦‚åˆ›å»ºä¸€ä¸ª Proxy</p>
<p>Bean äº‹ä»¶ç›‘å¬å™¨åœ¨ ç±»å‹è½¬æ¢å™¨(<code>type converters</code>) ä¹‹å‰è¿›è¡Œåˆå§‹åŒ–. å¦‚æœä½ çš„ç›‘å¬å™¨ä¾èµ–ç±»å‹è½¬æ¢, æˆ–è€…ä¾èµ–é…ç½®å±æ€§Bean, æˆ–å…¶ä»–ä»»ä½•æœºåˆ¶, ä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå…³äºç±»å‹è½¬æ¢çš„å¼‚å¸¸</p>
<h2 id="Bean-Introspection-Bean-å†…çœ"><a href="#Bean-Introspection-Bean-å†…çœ" class="headerlink" title="Bean Introspection (Bean å†…çœ)"></a>Bean Introspection (Bean å†…çœ)</h2><p>ä» Micronaut 1.1 å¼€å§‹, åŒ…å«äº†ä¸€ä¸ªå…³äº JDK çš„ <code>Introspector</code> çš„ç¼–è¯‘æ—¶æ›¿ä»£å“</p>
<p><code>BeanIntrospector</code> å’Œ <code>BeanIntrospection</code> æ¥å£å…è®¸ä¸ä½¿ç”¨åå°„æˆ–ç¼“å­˜çš„åå°„å…ƒæ•°æ®æ¥æŸ¥æ‰¾ Bean çš„å†…çœä¿¡æ¯æ¥å®ä¾‹åŒ– Bean å’Œè¯»å†™ Bean çš„å±æ€§, åå°„æˆ–ç¼“å­˜çš„åå°„å…ƒæ•°æ®ä¼šåœ¨å¤§å‹ Beans ä¸­æ¶ˆè€—å¤§é‡çš„å†…å­˜</p>
<h3 id="Making-a-Bean-Available-for-Introspection-è®©ä¸€ä¸ª-Bean-å¯ç”¨äºåå°„"><a href="#Making-a-Bean-Available-for-Introspection-è®©ä¸€ä¸ª-Bean-å¯ç”¨äºåå°„" class="headerlink" title="Making a Bean Available for Introspection (è®©ä¸€ä¸ª Bean å¯ç”¨äºåå°„)"></a>Making a Bean Available for Introspection (è®©ä¸€ä¸ª Bean å¯ç”¨äºåå°„)</h3><p>ä¸åƒ JDK çš„ <code>Introspector</code>, æ¯ä¸ªç±»ä¸æ˜¯è‡ªåŠ¨åœ°å¯ç”¨äºåå°„çš„</p>
<p>ä¸ºäº†è®©ä¸€ä¸ªç±»å¯ç”¨äºåå°„, ä½ å¿…é¡»è‡³å°‘è¦åœ¨ä½ çš„æ„å»ºä¸­å¼€å¯ Micronaut çš„æ³¨è§£å¤„ç†å™¨(<code>micronaut-inject-java</code>&#x2F;<code>micronaut-inject-groovy</code>), å¹¶ç¡®ä¿è¿è¡Œæ—¶æœ‰ä¸€ä¸ª <code>micronaut-core</code> çš„ä¾èµ–</p>
<p>Example - For Java:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotationProcessor(<span class="string">&quot;io.micronaut:micronaut-inject-java:3.4.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Example - For Groovy:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compileOnly(<span class="string">&quot;io.micronaut:micronaut-inject-groovy:3.4.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Example - <code>micronaut-core</code> ä¾èµ–:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runtimeOnly(<span class="string">&quot;io.micronaut:micronaut-core:3.4.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Use-the-Introspected-Annotation-ä½¿ç”¨-Introspected-æ³¨è§£"><a href="#Use-the-Introspected-Annotation-ä½¿ç”¨-Introspected-æ³¨è§£" class="headerlink" title="Use the @Introspected Annotation (ä½¿ç”¨ @Introspected æ³¨è§£)"></a>Use the <code>@Introspected</code> Annotation (ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£)</h3><p><code>@Introspected</code> æ³¨è§£å¯ä»¥åœ¨ä»»ä½•ç±»ä¸Š, ä½¿å¾—è¿™ä¸ªç±»å¯ç”¨äºå†…çœ(<code>introspection</code>)</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> groovy.transform.Canonical</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span></span><br><span class="line"><span class="meta">@Canonical</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">    <span class="type">int</span> age = <span class="number">18</span></span><br><span class="line"></span><br><span class="line">    Person(String name) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦åœ¨ç¼–è¯‘æ—¶æä¾›äº†å†…çœæ•°æ®, å°±å¯ä»¥ä½¿ç”¨ <code>BeanIntrospection</code> API æ¥è¿›è¡Œè·å–:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> introspection = BeanIntrospection.getIntrospection(Person)</span><br><span class="line">Person person = introspection.instantiate(<span class="string">&quot;John&quot;</span>)</span><br><span class="line">println(<span class="string">&quot;Hello $person.name&quot;</span>)</span><br><span class="line"></span><br><span class="line">BeanProperty&lt;Person, String&gt; property = introspection.getRequiredProperty(<span class="string">&quot;name&quot;</span>, String)</span><br><span class="line">property.set(person, <span class="string">&quot;Fred&quot;</span>)</span><br><span class="line">String name = property.get(person)</span><br><span class="line">println(<span class="string">&quot;Hello $person.name&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ­é… <code>io.micronaut.core.annotation.AccessorsStyle</code> æ³¨è§£æ¥ä¿®æ”¹å±æ€§çš„è¯»å†™æ–¹æ³•å‰ç¼€: <code>@AccessorsStyle(readPrefixes = &quot;&quot;, writePrefixes = &quot;&quot;)</code></p>
<h3 id="Bean-Fields-Bean-å­—æ®µ"><a href="#Bean-Fields-Bean-å­—æ®µ" class="headerlink" title="Bean Fields (Bean å­—æ®µ)"></a>Bean Fields (Bean å­—æ®µ)</h3><p>é»˜è®¤æƒ…å†µä¸‹ Java å†…çœåªä¼šå°† JavaBean çš„ getter&#x2F;setter æˆ– Java 16 record components çœ‹ä½œæ˜¯ Bean å±æ€§</p>
<p>å¯ä»¥åœ¨ç±»ä¸­ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£çš„ <code>accessKind</code> æˆå‘˜æ¥å®šä¹‰ public æˆ– package protected fields:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span>(accesskind = Introspected.AccessKind.FIELD)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String name    <span class="comment">// Final fields are treated like read-only properties</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age = <span class="number">18</span>         <span class="comment">// Mutable fields are treated like read-write properties</span></span><br><span class="line"></span><br><span class="line">    User(String name) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Constructor-Methods-æ„é€ æ–¹æ³•"><a href="#Constructor-Methods-æ„é€ æ–¹æ³•" class="headerlink" title="Constructor Methods (æ„é€ æ–¹æ³•)"></a>Constructor Methods (æ„é€ æ–¹æ³•)</h3><p>å¯¹äºæœ‰å¤šä¸ªæ„é€ æ–¹æ³•çš„ç±»æ¥è¯´, åœ¨è¦ä½¿ç”¨çš„æ„é€ æ–¹æ³•ä¸Šæ·»åŠ  <code>@Creator</code> æ³¨è§£</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Creator</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.concurrent.Immutable</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span></span><br><span class="line"><span class="meta">@Immutable</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> String name</span><br><span class="line">    <span class="keyword">final</span> String model</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> axles</span><br><span class="line"></span><br><span class="line">    Vehicle(String make, String model) &#123;</span><br><span class="line">        <span class="variable language_">this</span>(make, model, <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Creator</span>        <span class="comment">// The @Creator annotation denotes which constructor to use</span></span><br><span class="line">    Vehicle(String make, String model, <span class="type">int</span> axles) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.make = make</span><br><span class="line">        <span class="variable language_">this</span>.model = model</span><br><span class="line">        <span class="variable language_">this</span>.axles = axles</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç±»æ²¡æœ‰é»˜è®¤çš„æ„é€ æ–¹æ³•, æ‰€ä»¥ä¸ä½¿ç”¨å‚æ•°è°ƒç”¨ <code>instantiate</code> æ–¹æ³•å°†ä¼šæŠ›å‡º <code>InstantiationException</code></p>
<h3 id="Static-Creator-Methods-é™æ€æ„é€ æ–¹æ³•"><a href="#Static-Creator-Methods-é™æ€æ„é€ æ–¹æ³•" class="headerlink" title="Static Creator Methods (é™æ€æ„é€ æ–¹æ³•)"></a>Static Creator Methods (é™æ€æ„é€ æ–¹æ³•)</h3><p><code>@Creator</code> æ³¨è§£å¯ä»¥ç”¨åœ¨é™æ€æ–¹æ³•ä¸Šæ¥åˆ›å»ºç±»å®ä¾‹</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Creator</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.concurrent.Immutable</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span></span><br><span class="line"><span class="meta">@Immutable</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Business</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> String name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Business(String name) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Creator</span>        <span class="comment">// The @Creator annotation is applied to the static method which instantiates the class</span></span><br><span class="line">    <span class="keyword">static</span> Business forName(String name) &#123;</span><br><span class="line">        <span class="keyword">new</span> Business(name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Enums-æšä¸¾"><a href="#Enums-æšä¸¾" class="headerlink" title="Enums (æšä¸¾)"></a>Enums (æšä¸¾)</h3><p>å†…çœä¸€ä¸ªæšä¸¾ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<p>æ·»åŠ  <code>@Introspected</code> æ³¨è§£åˆ°æšä¸¾ç±»ä¸Š, ç„¶åè¿™ä¸ªæšä¸¾ç±»å°±å¯ä»¥é€šè¿‡æ ‡å‡†çš„ <code>valueOf()</code> æ–¹æ³•æ¥è¿›è¡Œæ„é€ </p>
<h3 id="Use-the-Introspected-Annotation-on-a-Configuration-Class-åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨-Introspected-æ³¨è§£"><a href="#Use-the-Introspected-Annotation-on-a-Configuration-Class-åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨-Introspected-æ³¨è§£" class="headerlink" title="Use the @Introspected Annotation on a Configuration Class (åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨ @Introspected æ³¨è§£)"></a>Use the <code>@Introspected</code> Annotation on a Configuration Class (åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨ <code>@Introspected</code> æ³¨è§£)</h3><p>å¦‚æœä½ æƒ³è¦å†…çœçš„ç±»æ˜¯å·²ç»ç¼–è¯‘å¥½çš„, æˆ–è€…æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„ç±», ä¸€ä¸ªæ›¿ä»£çš„é€‰é¡¹æ˜¯å®šä¹‰ä¸€ä¸ªé…ç½®ç±», å¹¶ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£çš„ <code>classes</code> æˆå‘˜å±æ€§</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span>(classes = Person)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonConfiguration</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>PersonConfiguration</code> ç±»ä¸º <code>Person</code> ç±»ç”Ÿæˆäº†å†…çœä¿¡æ¯</p>
<p>è¿˜å¯ä»¥ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£çš„ <code>packages</code> å±æ€§æ¥ä¸ºæŸä¸ªåŒ…ä¸‹æ‰€æœ‰çš„ç±»ç”Ÿæˆå†…çœä¿¡æ¯, æ³¨æ„è¿™è¿˜æ˜¯ä¸€ä¸ªå®éªŒç‰¹æ€§</p>
<h3 id="Write-an-AnnotationMapper-to-Introspect-Existing-Annotations-ç¼–å†™ä¸€ä¸ª-AnnotationMapper-æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£"><a href="#Write-an-AnnotationMapper-to-Introspect-Existing-Annotations-ç¼–å†™ä¸€ä¸ª-AnnotationMapper-æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£" class="headerlink" title="Write an AnnotationMapper to Introspect Existing Annotations (ç¼–å†™ä¸€ä¸ª AnnotationMapper æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£)"></a>Write an <code>AnnotationMapper</code> to Introspect Existing Annotations (ç¼–å†™ä¸€ä¸ª <code>AnnotationMapper</code> æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£)</h3><p>å¦‚æœä½ æƒ³é»˜è®¤ä¸ºä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£è¿›è¡Œå†…çœ, ä½ å¯ä»¥ç¼–å†™ä¸€ä¸ª <code>AnnotationMapper</code></p>
<p>ä¸€ä¸ªä¾‹å­æ˜¯ <code>EntityIntrospectedAnnotationMapper</code>, è¿™ä¸ª Mapper ç¡®ä¿äº†æ‰€æœ‰ä½¿ç”¨ <code>@javax.persistence.Entity</code> æ³¨è§£çš„ Beans éƒ½é»˜è®¤è¢«å†…çœäº†</p>
<p><code>AnnotationMapper</code> å¿…é¡»å­˜åœ¨äº annotation processor classpath</p>
<h3 id="The-BeanWrapper-API-BeanWrapper-API"><a href="#The-BeanWrapper-API-BeanWrapper-API" class="headerlink" title="The BeanWrapper API (BeanWrapper API)"></a>The BeanWrapper API (BeanWrapper API)</h3><p>ä¸€ä¸ª <code>BeanProperty</code> æä¾›äº†è¯»å†™ç±»ä¸­ä¸€ä¸ªå±æ€§å€¼çš„åŸå§‹è®¿é—®æ–¹å¼, æ²¡æœ‰æä¾›ä»»ä½•è‡ªåŠ¨ç±»å‹è½¬æ¢</p>
<p>ä¼ é€’ç»™ set&#x2F;get æ–¹æ³•çš„å€¼åº”è¯¥ä¸åº•å±‚å±æ€§ç±»å‹ç›¸åŒ¹é…, å¦åˆ™ä¼šå‘ç”Ÿå¼‚å¸¸</p>
<p>ä¸ºäº†æä¾›é¢å¤–çš„ç±»å‹è½¬æ¢æ™ºèƒ½, <code>BeanWrapper</code> æ¥å£å…è®¸åŒ…è£…ç°æœ‰çš„ Bean å®ä¾‹, è¯»å†™ Bean å±æ€§, å¹¶åœ¨å¿…è¦æ—¶æ‰§è¡Œç±»å‹è½¬æ¢</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> BeanWrapper&lt;Person&gt; wrapper = BeanWrapper.getWrapper(<span class="keyword">new</span> Person(<span class="string">&quot;Fred&quot;</span>))</span><br><span class="line"></span><br><span class="line">wrapper.setProperty(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;20&quot;</span>)</span><br><span class="line"><span class="type">int</span> newAge = wrapper.getRequiredProperty(<span class="string">&quot;age&quot;</span>, Integer)</span><br><span class="line"></span><br><span class="line">println(<span class="string">&quot;Person&#x27;s age now $newAge&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Jackson-and-Bean-Introspection-Jackson-å’Œ-Bean-å†…çœ"><a href="#Jackson-and-Bean-Introspection-Jackson-å’Œ-Bean-å†…çœ" class="headerlink" title="Jackson and Bean Introspection (Jackson å’Œ Bean å†…çœ)"></a>Jackson and Bean Introspection (Jackson å’Œ Bean å†…çœ)</h3><p>Jackson è¢«é…ç½®ä¸ºä½¿ç”¨ <code>BeanIntrospection</code> API æ¥è¯»å†™å±æ€§å€¼ä¸æ„é€ å¯¹è±¡, ç»“æœå°±æ˜¯æ— åå°„çš„åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–</p>
<p>ä»æ€§èƒ½çš„è§’åº¦æ¥çœ‹, è¿™æ˜¯æœ‰ç›Šçš„, å¹¶ä¸”éœ€è¦æ›´å°‘çš„é…ç½®æ¥æ­£ç¡®åœ°ä¸è¿è¡Œæ—¶æ“ä½œ, ä¾‹å¦‚ GraalVM native</p>
<h2 id="Bean-Validation-Bean-æ ¡éªŒ"><a href="#Bean-Validation-Bean-æ ¡éªŒ" class="headerlink" title="Bean Validation (Bean æ ¡éªŒ)"></a>Bean Validation (Bean æ ¡éªŒ)</h2><p>ä» Micronaut 1.2 å¼€å§‹, Micronaut å†…ç½®äº†æ ¡éªŒé‚£äº›ä½¿ç”¨äº† <code>javax.validation</code> æ³¨è§£ä¿®é¥°çš„ Beans çš„æ”¯æŒ</p>
<p>æœ€å°åŒ–çš„é…ç½®æ˜¯åŒ…å« <code>micronaut-validation</code> æ¨¡å—ä½œä¸ºç¼–è¯‘æ—¶ä¾èµ–:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">&quot;io.micronaut:micronaut-validation&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Micronaut ç°åœ¨çš„å®ç°ä¸æ˜¯å®Œå…¨éµå¾ª Bean Validator è§„èŒƒçš„, å› ä¸ºè¿™ä¸ªè§„èŒƒé‡åº¦ä¾èµ–åŸºäºåå°„çš„ APIs</p>
<p>ç°åœ¨è¿˜ä¸æ”¯æŒå¦‚ä¸‹ç‰¹æ€§:</p>
<ul>
<li>æ³›å‹å‚æ•°ç±»å‹ä¸Šçš„æ³¨è§£, å› ä¸ºç°åœ¨åªæœ‰ Java æ”¯æŒè¿™ä¸ªç‰¹æ€§</li>
<li>ä»»ä½•ä¸ <code>constraint metadata API</code> çš„äº¤äº’, å› ä¸º Micronaut ä½¿ç”¨ç¼–è¯‘æ—¶ç”Ÿæˆçš„å…ƒæ•°æ®</li>
<li>åŸºäº XML çš„é…ç½®</li>
<li>ä½¿ç”¨ <code>io.micronaut.validation.validator.constraints.ConstraintValidator</code> æ¥ä»£æ›¿ <code>javax.validation.ConstraintValidator</code>, Micronaut çš„ <code>ConstraintValidator</code> æ”¯æŒç¼–è¯‘æ—¶çš„æ ¡éªŒæ³¨è§£</li>
</ul>
<p>å¦‚æœéœ€è¦å®Œå…¨çš„ Bean Validator 2.0 è§„èŒƒ, æ·»åŠ  <code>micronaut-hibernate-validator</code> æ¨¡å—åˆ°ä½ çš„æ„å»ºä¸­, ä»£æ›¿ Micronaut çš„å®ç°:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">&quot;io.micronaut.beanvalidation:micronaut-hibernate-validator&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Validating-Bean-Methods-æ£€éªŒ-Bean-çš„æ–¹æ³•"><a href="#Validating-Bean-Methods-æ£€éªŒ-Bean-çš„æ–¹æ³•" class="headerlink" title="Validating Bean Methods (æ£€éªŒ Bean çš„æ–¹æ³•)"></a>Validating Bean Methods (æ£€éªŒ Bean çš„æ–¹æ³•)</h3><p>åœ¨æ–¹æ³•å‚æ•°ä¸Šä½¿ç”¨ <code>javax.validation</code> æ³¨è§£, å¯ä»¥æ£€éªŒä»»ä½•å£°æ˜ä¸º Micronaut Bean çš„ç±»çš„æ–¹æ³•</p>
<p>Example - Validating Methods:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotBlank</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonService</span> &#123;</span><br><span class="line">    <span class="type">void</span> sayHello(<span class="meta">@NotBlank</span> String name) &#123;</span><br><span class="line">        println <span class="string">&quot;Hello $name&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸€ä¸ªæ ¡éªŒé”™è¯¯äº§ç”Ÿ, å°†ä¼šæŠ›å‡ºä¸€ä¸ª <code>javax.validation.ConstraintViolationException</code></p>
<h3 id="Validating-Data-Classes-æ ¡éªŒæ•°æ®ç±»"><a href="#Validating-Data-Classes-æ ¡éªŒæ•°æ®ç±»" class="headerlink" title="Validating Data Classes (æ ¡éªŒæ•°æ®ç±»)"></a>Validating Data Classes (æ ¡éªŒæ•°æ®ç±»)</h3><p>ä¸ºäº†æ ¡éªŒæ•°æ®ç±», ä¾‹å¦‚ POJOs (é€šå¸¸ç”¨äº JSON äº¤æ¢), è¿™ä¸ªç±»å¿…é¡»ä½¿ç”¨ <code>@Introspected</code> æ³¨è§£è¿›è¡Œä¿®é¥°</p>
<p>å¦‚æœè¿™ä¸ªç±»æ˜¯å¤–éƒ¨çš„, åˆ™é€šè¿‡ <code>@Introspected</code> æ³¨è§£è¿›è¡Œ import</p>
<p>Example - POJO Validation:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Introspected</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Min</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotBlank</span><br><span class="line"></span><br><span class="line"><span class="meta">@Introspected</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    String name</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min</span>(<span class="number">19</span>L)</span><br><span class="line">    <span class="type">int</span> age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¦æ‰‹åŠ¨æ ¡éªŒè¿™ä¸ªç±», ä½¿ç”¨æ³¨å…¥çš„ <code>Validator</code> å®ä¾‹:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span> Validator validator</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="string">&#x27;test person is validated with validator&#x27;</span>() &#123;</span><br><span class="line">    <span class="symbol">when:</span> <span class="string">&#x27;The person is validated&#x27;</span></span><br><span class="line">        <span class="keyword">def</span> constraintViolation = validator.validate(<span class="keyword">new</span> Person(<span class="attr">name:</span> <span class="string">&#x27;&#x27;</span>, <span class="attr">age:</span> <span class="number">10</span>))</span><br><span class="line">    <span class="symbol">then:</span> <span class="string">&#x27;A validation error occurs&#x27;</span></span><br><span class="line">        constraintViolations.size() == <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…åœ¨ Bean æ–¹æ³•ä¸Š, ä½¿ç”¨ <code>javax.validation.Valid</code> æ¥è§¦å‘çº§è”æ ¡éªŒ:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonService</span> &#123;</span><br><span class="line">    <span class="type">void</span> sayHello(<span class="meta">@Valid</span> Person person) &#123;</span><br><span class="line">        println <span class="string">&quot;Hello $person.name&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Validation-Configuration-Properties-æ ¡éªŒå±æ€§é…ç½®"><a href="#Validation-Configuration-Properties-æ ¡éªŒå±æ€§é…ç½®" class="headerlink" title="Validation Configuration Properties (æ ¡éªŒå±æ€§é…ç½®)"></a>Validation Configuration Properties (æ ¡éªŒå±æ€§é…ç½®)</h3><p>è¿˜å¯ä»¥æ ¡éªŒä½¿ç”¨äº† <code>@ConfigurationProperties</code> æ³¨è§£ä¿®é¥°çš„ç±»çš„å±æ€§æ¥ç¡®ä¿é…ç½®æ­£ç¡®</p>
<p>æ¨èå°† <code>@ConfigurationProperties</code> æ³¨è§£å’Œ <code>@Context</code> æ³¨è§£ä¸€èµ·ä½¿ç”¨æ¥ç¡®ä¿æ ¡éªŒåœ¨å¯åŠ¨æ—¶è¿›è¡Œ</p>
<h3 id="Defining-Additional-Constraints-å®šä¹‰é¢å¤–çš„çº¦æŸ"><a href="#Defining-Additional-Constraints-å®šä¹‰é¢å¤–çš„çº¦æŸ" class="headerlink" title="Defining Additional Constraints (å®šä¹‰é¢å¤–çš„çº¦æŸ)"></a>Defining Additional Constraints (å®šä¹‰é¢å¤–çš„çº¦æŸ)</h3><p>ä¸ºäº†å®šä¹‰é¢å¤–çš„çº¦æŸ, åˆ›å»ºä¸€ä¸ªæ–°çš„æ³¨è§£:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.validation.Constraint</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@Constraint</span>(validatedBy = [])   <span class="comment">// è¿™ä¸ªæ³¨è§£è¦ä½¿ç”¨ `javax.validation.Constraint` ç±»ä¿®é¥°</span></span><br><span class="line"><span class="meta">@interface</span> DurationPattern &#123;</span><br><span class="line">    String message() <span class="keyword">default</span> <span class="string">&quot;invalid duration (&#123;validatedValue&#125;)&quot;</span>  <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>2</code> : A message template can be provided in a hard-coded manner as above. If none is specified, Micronaut tries to find a message using ClassName.message using the MessageSource interface (optional)</p>
<p>ä¸€æ—¦ä½ å®šä¹‰äº†ä¸€ä¸ªæ³¨è§£, é‚£ä¹ˆå®ç°ä¸€ä¸ª <code>ConstraintValidator</code> æ¥æ ¡éªŒè¿™ä¸ªæ³¨è§£</p>
<p>ä½ å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ª Bean æ¥ç›´æ¥å®ç°è¿™ä¸ªæ¥å£, æˆ–è€…åˆ›å»ºä¸€ä¸ª Factory æ¥è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªæ ¡éªŒå™¨</p>
<p>æ¨èä½¿ç”¨ Factory çš„æ–¹å¼æ¥å®šä¹‰å¤šä¸ªæ ¡éªŒå™¨:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Factory</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.AnnotationValue</span><br><span class="line"><span class="keyword">import</span> io.micronaut.validation.validator.constraints.ConstraintValidator</span><br><span class="line"><span class="keyword">import</span> io.micronaut.validation.validator.constraints.ConstraintValidatorContext</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="meta">@Factory</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyValidatorFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    ConstraintValidator&lt;DurationPattern, CharSequence&gt; durationPatternValidator() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; CharSequence value,</span><br><span class="line">                 AnnotationValue&lt;DurationPattern&gt; annotation,</span><br><span class="line">                 ConstraintValidatorContext context -&gt;</span><br><span class="line">            context.messageTemplate(<span class="string">&quot;invalid duration (&#123;validatedValue&#125;), additional custom message&quot;</span>)   <span class="comment">// 1</span></span><br><span class="line">            <span class="keyword">return</span> value == <span class="literal">null</span> || value.toString() ==~ <span class="regexp">/^PT?[\d]+[SMHD]&#123;1&#125;$/</span></span><br><span class="line">        &#125; <span class="keyword">as</span> ConstraintValidator&lt;DurationPattern, CharSequence&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>1</code> : Override the default message template with an inline call for more control over the validation error message. (Since 2.5.0)</p>
<p>ä½¿ç”¨è¿™ä¸ªæ³¨è§£:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HolidayService</span> &#123;</span><br><span class="line"></span><br><span class="line">    String startHoliday(<span class="meta">@NotBlank</span> String person,</span><br><span class="line">                        <span class="meta">@DurationPattern</span> String duration) &#123;</span><br><span class="line">        <span class="keyword">final</span> Duration d = Duration.parse(duration)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person $person is off on holiday for $&#123;d.toMinutes()&#125; minutes&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Validating-Annotations-at-Compile-Time-åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£"><a href="#Validating-Annotations-at-Compile-Time-åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£" class="headerlink" title="Validating Annotations at Compile Time (åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£)"></a>Validating Annotations at Compile Time (åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£)</h3><p>é€šè¿‡æ·»åŠ  <code>micronaut-validation</code> åˆ°æ³¨è§£å¤„ç†å™¨ç±»è·¯å¾„ä¸Š ,ä½ å¯ä»¥ä½¿ç”¨ Micronaut çš„æ ¡éªŒå™¨æ¥åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£å…ƒç´ </p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotationProcessor(<span class="string">&quot;io.micronaut:micronaut-validation&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Micronaut ä¼šåœ¨ç¼–è¯‘æ—¶æ ¡éªŒä½¿ç”¨äº† <code>javax.validation</code> ä¿®é¥°çš„æ³¨è§£å€¼:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@interface</span> TimeOff &#123;</span><br><span class="line">    <span class="meta">@DurationPattern</span></span><br><span class="line">    String duration()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ <code>duration</code> æ˜¯ä¸€ä¸ªå±æ€§å ä½ç¬¦, ä¾‹å¦‚  <code>@TimeOff(duration=&quot;$&#123;my.value&#125;&quot;)</code>, æ ¡éªŒå°†ä¼šåœ¨è¿è¡Œæ—¶è¿›è¡Œ</p>
<p>ä¸ºäº†åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>ConstraintValidator</code>, ä½ å¿…é¡»å°†æ ¡éªŒå™¨å®šä¹‰ä¸ºä¸€ä¸ªç±»:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.NonNull</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.Nullable</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.AnnotationValue</span><br><span class="line"><span class="keyword">import</span> io.micronaut.validation.validator.constraints.ConstraintValidator</span><br><span class="line"><span class="keyword">import</span> io.micronaut.validation.validator.constraints.ConstraintValidatorContext</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DurationPatternValidator</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;DurationPattern, CharSequence&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">boolean</span> isValid(</span><br><span class="line">            <span class="meta">@Nullable</span> CharSequence value,</span><br><span class="line">            <span class="meta">@NonNull</span> AnnotationValue&lt;DurationPattern&gt; annotationMetadata,</span><br><span class="line">            <span class="meta">@NonNull</span> ConstraintValidatorContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> value == <span class="literal">null</span> || value.toString() ==~ <span class="regexp">/^PT?[\d]+[SMHD]&#123;1&#125;$/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–:</p>
<ul>
<li>Define a META-INF&#x2F;services&#x2F;io.micronaut.validation.validator.constraints.ConstraintValidator file that references the class.</li>
<li>The class must be public and have a public no-argument constructor</li>
<li>The class must be on the annotation processor classpath of the project to be validated.</li>
</ul>
<h2 id="Bean-Annotation-Metadata-Bean-æ³¨è§£å…ƒæ•°æ®"><a href="#Bean-Annotation-Metadata-Bean-æ³¨è§£å…ƒæ•°æ®" class="headerlink" title="Bean Annotation Metadata (Bean æ³¨è§£å…ƒæ•°æ®)"></a>Bean Annotation Metadata (Bean æ³¨è§£å…ƒæ•°æ®)</h2><p><code>BeanContext</code> API å¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå®ç°äº† <code>AnnotationMetadata</code> æ¥å£çš„ <code>BeanDefinition</code> çš„å¼•ç”¨</p>
<p>Example - è·å–æ‰€æœ‰ä½¿ç”¨äº†ä¸€ä¸ªç‰¹å®šæ³¨è§£ä¿®é¥°çš„ Bean å®šä¹‰ - Lookup Bean Definitions by Stereotype:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BeanContext beanContext = ... <span class="comment">// obtain the bean context</span></span><br><span class="line">Collection&lt;BeanDefinition&gt; definitions = beanContext.getBeanDefinitions(Qualifiers.byStereotype(Controller.<span class="keyword">class</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (BeanDefinition <span class="attr">definition :</span> definitions) &#123;</span><br><span class="line">    AnnotationValue&lt;Controller&gt; controllerAnn = definition.getAnnotation(Controller.<span class="keyword">class</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­è·å–åˆ°äº†æ‰€æœ‰ç›´æ¥æˆ–é—´æ¥ä½¿ç”¨ <code>@Controller</code> æ³¨è§£ä¿®é¥°çš„ <code>BeanDefinition</code> å®ä¾‹</p>
<h3 id="Annotation-Inheritance-æ³¨è§£ç»§æ‰¿"><a href="#Annotation-Inheritance-æ³¨è§£ç»§æ‰¿" class="headerlink" title="Annotation Inheritance (æ³¨è§£ç»§æ‰¿)"></a>Annotation Inheritance (æ³¨è§£ç»§æ‰¿)</h3><p>Example - Defining Inherited Meta Annotations:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.AliasFor</span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Requires</span><br><span class="line"><span class="keyword">import</span> io.micronaut.core.annotation.AnnotationMeta</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Named</span><br><span class="line"><span class="keyword">import</span> jakarta.inject.Singleton</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Inherited</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy</span><br><span class="line"></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Requires</span>(property = <span class="string">&quot;datasource.url&quot;</span>)</span><br><span class="line"><span class="meta">@Named</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@interface</span> SqlRepository &#123;</span><br><span class="line">    <span class="meta">@AliasFor</span>(annotation = Named.<span class="keyword">class</span>, member = AnnotationMetadata.VALUE_MEMBER)</span><br><span class="line">    String value() <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Example - Using Inherited Meta Annotations on a Super Class:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SqlRepository</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseSqlRepository</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Example - Inheriting Annotations in s Child Class:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jakarta.inject.Named</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource</span><br><span class="line"></span><br><span class="line"><span class="meta">@Named</span>(<span class="string">&quot;bookRepository&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookRepository</span> <span class="keyword">extends</span> <span class="title class_">BaseSqlRepository</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DataSource dataSource</span><br><span class="line"></span><br><span class="line">    BookRepository(DataSource dataSource) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.dataSource = dataSource</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>A child class must at least have one bean definition annotation such as a scope or qualifier.</p>
</blockquote>
<h3 id="Aliasing-or-Mapping-Annotations-å–åˆ«åoræ˜ å°„æ³¨è§£"><a href="#Aliasing-or-Mapping-Annotations-å–åˆ«åoræ˜ å°„æ³¨è§£" class="headerlink" title="Aliasing or Mapping Annotations (å–åˆ«åoræ˜ å°„æ³¨è§£)"></a>Aliasing or Mapping Annotations (å–åˆ«åoræ˜ å°„æ³¨è§£)</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Client &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @return The URL or service ID of the remote service</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AliasFor</span>(member = <span class="string">&quot;id&quot;</span>) </span><br><span class="line">    String value() <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @return The ID of the client</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AliasFor</span>(member = <span class="string">&quot;value&quot;</span>) </span><br><span class="line">    String id() <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>With these aliases in place, whether you define @Client(â€œfooâ€) or @Client(id&#x3D;â€fooâ€), both the value and id members will be set, making it easier to parse and work with the annotation.</p>
</blockquote>
<h2 id="Importing-Beans-from-Libraries-ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥-Beans"><a href="#Importing-Beans-from-Libraries-ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥-Beans" class="headerlink" title="Importing Beans from Libraries (ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥ Beans)"></a>Importing Beans from Libraries (ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥ Beans)</h2><p>å¯ä»¥ä½¿ç”¨ <code>@Import</code> æ³¨è§£æ¥å¯¼å…¥å¤–éƒ¨åº“ä¸­,å·²ç¼–è¯‘çš„ä½¿ç”¨äº† JSR-330 æ³¨è§£çš„ Bean</p>
<p>Bean å¯¼å…¥ç°åœ¨åªæ”¯æŒ Java è¯­è¨€</p>
<p>ä¾‹å¦‚, ä¸ºäº†å¯¼å…¥ JSR-330 TCK åˆ°åº”ç”¨ä¸­, æ·»åŠ  TCK çš„ä¾èµ–:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation(<span class="string">&quot;io.micronaut:jakarta.inject&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨ <code>Applicatoin</code> ç±»ä¸Šå®šä¹‰ <code>@Import</code> æ³¨è§£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.micronaut.context.annotation.Import;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Import(</span></span><br><span class="line"><span class="meta">    packages = &#123;</span></span><br><span class="line"><span class="meta">        &quot;org.atinject.tck.auto&quot;,</span></span><br><span class="line"><span class="meta">        &quot;org.atinject.tck.auto.accessories&quot;</span></span><br><span class="line"><span class="meta">    &#125;,</span></span><br><span class="line"><span class="meta">    annotated = &quot;*&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Applicatoin</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>packages</code> ä¸ä¼šè¿›è¡Œé€’å½’æ‰«æ, å› æ­¤éœ€è¦æ‰‹åŠ¨æŒ‡å®šå­åŒ…</p>
<p>é»˜è®¤æƒ…å†µä¸‹, Micronaut åªä¼šå¯¼å…¥ä¸€ä¸ª scope æˆ– qulifier çš„ç±», æ‰€ä»¥è¦åœ¨ <code>annotated</code> ä¸Šä½¿ç”¨ <code>*</code> æ¥å¯¼å…¥æ‰€æœ‰ç±»å‹çš„ Bean</p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>æœ¬æ–‡æ ‡é¢˜ï¼šMicronaut ä¸­æ–‡æ–‡æ¡£ Inversion of Control</li>
        <li>æœ¬æ–‡ä½œè€…ï¼šæ—å¨ç¾½</li>
        <li>åˆ›å»ºæ—¶é—´ï¼š2022-04-29 09:25:59</li>
        <li>
            æœ¬æ–‡é“¾æ¥ï¼šhttps://linweiyu21.github.io/micronaut/micronaut-inversion-of-control/
        </li>
        <li>
            ç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Micronaut/">#Micronaut</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Groovy/">#Groovy</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/%E4%B8%AD%E6%96%87/">#ä¸­æ–‡</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/micronaut/micronaut-application-configuration/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Micronaut ä¸­æ–‡æ–‡æ¡£ Application Configuration</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/micronaut/micronaut-quick-start/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Micronaut ä¸­æ–‡æ–‡æ¡£ Quick Start</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;è¯„è®º</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: '8xWQ0WFbKUNN4h8ixIO12etk-gzGzoHsz',
                    appKey: '7cLjTvkIsF6aIuIVSd0um89m',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: 'è¯·å¼€å§‹ä½ çš„è¡¨æ¼”',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return 'åšä¸»';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'æ—å¨ç¾½';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">æ—å¨ç¾½</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Inversion-of-Control"><span class="nav-number">1.</span> <span class="nav-text">Inversion of Control</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Injectable-Container-Types-%E5%8F%AF%E4%BB%A5%E6%B3%A8%E5%85%A5%E7%9A%84%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.</span> <span class="nav-text">Injectable Container Types (å¯ä»¥æ³¨å…¥çš„å®¹å™¨ç±»å‹)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Collection-Ordering-%E5%AE%B9%E5%99%A8%E4%B8%AD-Bean-%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.1.1.</span> <span class="nav-text">Collection Ordering (å®¹å™¨ä¸­ Bean çš„é¡ºåº)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Injecting-a-Bean-by-Order-%E6%8C%89%E9%A1%BA%E5%BA%8F%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AA-Bean"><span class="nav-number">1.1.2.</span> <span class="nav-text">Injecting a Bean by Order (æŒ‰é¡ºåºæ³¨å…¥ä¸€ä¸ª Bean)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Qualifiers-Bean-%E9%99%90%E5%AE%9A%E7%AC%A6"><span class="nav-number">1.2.</span> <span class="nav-text">Bean Qualifiers Bean (é™å®šç¬¦)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Qualifying-By-Name-%E9%80%9A%E8%BF%87%E5%90%8D%E5%AD%97%E6%9D%A5%E9%99%90%E5%AE%9A"><span class="nav-number">1.2.1.</span> <span class="nav-text">Qualifying By Name (é€šè¿‡åå­—æ¥é™å®š)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Qualifying-By-Annotation-%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E6%9D%A5%E9%99%90%E5%AE%9A"><span class="nav-number">1.2.2.</span> <span class="nav-text">Qualifying By Annotation (é€šè¿‡æ³¨è§£æ¥é™å®š)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Qualifier-By-Annotation-Members-%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%B1%9E%E6%80%A7%E6%88%90%E5%91%98%E6%9D%A5%E9%99%90%E5%AE%9A"><span class="nav-number">1.2.3.</span> <span class="nav-text">Qualifier By Annotation Members (é€šè¿‡æ³¨è§£çš„å±æ€§æˆå‘˜æ¥é™å®š)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Qualifying-by-Generic-Type-Arguments-%E9%80%9A%E8%BF%87%E6%B3%9B%E5%9E%8B%E5%8F%82%E6%95%B0%E6%9D%A5%E9%99%90%E5%AE%9A"><span class="nav-number">1.2.4.</span> <span class="nav-text">Qualifying by Generic Type Arguments (é€šè¿‡æ³›å‹å‚æ•°æ¥é™å®š)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Primary-and-Secondary-Beans-%E4%B8%BB%E8%A6%81%E7%9A%84%E5%92%8C%E6%AC%A1%E8%A6%81%E7%9A%84-Bean"><span class="nav-number">1.2.5.</span> <span class="nav-text">Primary and Secondary Beans (ä¸»è¦çš„å’Œæ¬¡è¦çš„ Bean)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Injecting-Any-Bean-%E6%B3%A8%E5%85%A5%E4%BB%BB%E6%84%8F-Bean"><span class="nav-number">1.2.6.</span> <span class="nav-text">Injecting Any Bean (æ³¨å…¥ä»»æ„ Bean)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Limiting-Injectable-Types-%E9%99%90%E5%88%B6%E6%B3%A8%E5%85%A5%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">Limiting Injectable Types (é™åˆ¶æ³¨å…¥çš„ç±»å‹)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Scopes-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.4.</span> <span class="nav-text">Scopes (ä½œç”¨åŸŸ)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Built-In-Scopes-%E5%86%85%E5%BB%BA%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.4.1.</span> <span class="nav-text">Built-In Scopes (å†…å»ºçš„ä½œç”¨åŸŸ)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Eager-Initialization-of-Singletons-%E5%8D%95%E4%BE%8B%E7%9A%84%E9%A5%BF%E5%BC%8F%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">Eager Initialization of Singletons (å•ä¾‹çš„é¥¿å¼åˆå§‹åŒ–)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Refreshable-Scope-%E5%8F%AF%E5%88%B7%E6%96%B0%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.4.2.</span> <span class="nav-text">Refreshable Scope (å¯åˆ·æ–°çš„ä½œç”¨åŸŸ)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scopes-on-Meta-Annotations-%E5%85%83%E6%B3%A8%E8%A7%A3%E4%B8%8A%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.4.3.</span> <span class="nav-text">Scopes on Meta Annotations (å…ƒæ³¨è§£ä¸Šçš„ä½œç”¨åŸŸ)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Factories-Bean-%E5%B7%A5%E5%8E%82"><span class="nav-number">1.5.</span> <span class="nav-text">Bean Factories Bean (å·¥å‚)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Programmatically-Disabling-Beans-%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E6%9D%A5%E6%97%A0%E6%95%88%E5%8C%96-Beans"><span class="nav-number">1.5.1.</span> <span class="nav-text">Programmatically Disabling Beans (ç¼–ç¨‹æ–¹å¼æ¥æ— æ•ˆåŒ– Beans)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Injection-Point-%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="nav-number">1.5.2.</span> <span class="nav-text">Injection Point (æ³¨å…¥ç‚¹)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Beans-from-Fields-%E5%9C%A8%E5%AD%97%E6%AE%B5%E4%B8%AD%E5%A3%B0%E6%98%8E-Beans"><span class="nav-number">1.5.3.</span> <span class="nav-text">Beans from Fields (åœ¨å­—æ®µä¸­å£°æ˜ Beans)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Primitive-Beans-and-Arrays-%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%92%8C%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E7%9A%84-Bean"><span class="nav-number">1.5.4.</span> <span class="nav-text">Primitive Beans and Arrays (åŸå§‹ç±»å‹çš„å’Œæ•°ç»„ç±»å‹çš„ Bean)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conditional-Beans-%E6%9D%A1%E4%BB%B6%E5%8C%96%E5%8A%A0%E8%BD%BD-Beans"><span class="nav-number">1.6.</span> <span class="nav-text">Conditional Beans (æ¡ä»¶åŒ–åŠ è½½ Beans)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration-Requirements-%E9%85%8D%E7%BD%AE%E8%A6%81%E6%B1%82"><span class="nav-number">1.6.1.</span> <span class="nav-text">Configuration Requirements (é…ç½®è¦æ±‚)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Additional-Notes-on-Property-Requirements-%E5%B1%9E%E6%80%A7%E8%A6%81%E6%B1%82%E4%B8%8A%E9%A2%9D%E5%A4%96%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">Additional Notes on Property Requirements (å±æ€§è¦æ±‚ä¸Šé¢å¤–çš„ä¿¡æ¯)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Referencing-bean-properties-in-Requires-%E5%9C%A8-Requires-%E6%B3%A8%E8%A7%A3%E4%B8%AD%E5%BC%95%E7%94%A8-Bean-%E5%B1%9E%E6%80%A7"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">Referencing bean properties in @Requires (åœ¨ @Requires æ³¨è§£ä¸­å¼•ç”¨ Bean å±æ€§)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Debugging-Conditional-Beans-%E8%B0%83%E8%AF%95%E6%9D%A1%E4%BB%B6%E5%8C%96%E7%9A%84-Beans"><span class="nav-number">1.6.2.</span> <span class="nav-text">Debugging Conditional Beans (è°ƒè¯•æ¡ä»¶åŒ–çš„ Beans)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Replacement-Bean-%E6%9B%BF%E4%BB%A3"><span class="nav-number">1.7.</span> <span class="nav-text">Bean Replacement (Bean æ›¿ä»£)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Factory-Replacement-Factory-%E6%9B%BF%E4%BB%A3"><span class="nav-number">1.7.1.</span> <span class="nav-text">Factory Replacement (Factory æ›¿ä»£)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Default-Implementation-%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.7.2.</span> <span class="nav-text">Default Implementation (é»˜è®¤å®ç°)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Configurations-Bean-%E9%85%8D%E7%BD%AE"><span class="nav-number">1.8.</span> <span class="nav-text">Bean Configurations (Bean é…ç½®)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Life-Cycle-Methods-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95"><span class="nav-number">1.9.</span> <span class="nav-text">Life-Cycle Methods (ç”Ÿå‘½å‘¨æœŸæ–¹æ³•)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#When-The-Context-Starts-Context-%E5%90%AF%E5%8A%A8%E6%97%B6"><span class="nav-number">1.9.1.</span> <span class="nav-text">When The Context Starts (Context å¯åŠ¨æ—¶)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#When-The-Context-Closes-Context-%E5%85%B3%E9%97%AD%E6%97%B6"><span class="nav-number">1.9.2.</span> <span class="nav-text">When The Context Closes (Context å…³é—­æ—¶)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Context-Events-Context-%E4%BA%8B%E4%BB%B6"><span class="nav-number">1.10.</span> <span class="nav-text">Context Events (Context äº‹ä»¶)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Publishing-Events-%E5%8F%91%E5%B8%83%E4%BA%8B%E4%BB%B6"><span class="nav-number">1.10.1.</span> <span class="nav-text">Publishing Events (å‘å¸ƒäº‹ä»¶)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Listening-for-Events-%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6"><span class="nav-number">1.10.2.</span> <span class="nav-text">Listening for Events (ç›‘å¬äº‹ä»¶)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Events-Bean-%E4%BA%8B%E4%BB%B6"><span class="nav-number">1.11.</span> <span class="nav-text">Bean Events (Bean äº‹ä»¶)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Introspection-Bean-%E5%86%85%E7%9C%81"><span class="nav-number">1.12.</span> <span class="nav-text">Bean Introspection (Bean å†…çœ)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Making-a-Bean-Available-for-Introspection-%E8%AE%A9%E4%B8%80%E4%B8%AA-Bean-%E5%8F%AF%E7%94%A8%E4%BA%8E%E5%8F%8D%E5%B0%84"><span class="nav-number">1.12.1.</span> <span class="nav-text">Making a Bean Available for Introspection (è®©ä¸€ä¸ª Bean å¯ç”¨äºåå°„)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Use-the-Introspected-Annotation-%E4%BD%BF%E7%94%A8-Introspected-%E6%B3%A8%E8%A7%A3"><span class="nav-number">1.12.2.</span> <span class="nav-text">Use the @Introspected Annotation (ä½¿ç”¨ @Introspected æ³¨è§£)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bean-Fields-Bean-%E5%AD%97%E6%AE%B5"><span class="nav-number">1.12.3.</span> <span class="nav-text">Bean Fields (Bean å­—æ®µ)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constructor-Methods-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="nav-number">1.12.4.</span> <span class="nav-text">Constructor Methods (æ„é€ æ–¹æ³•)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Static-Creator-Methods-%E9%9D%99%E6%80%81%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="nav-number">1.12.5.</span> <span class="nav-text">Static Creator Methods (é™æ€æ„é€ æ–¹æ³•)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enums-%E6%9E%9A%E4%B8%BE"><span class="nav-number">1.12.6.</span> <span class="nav-text">Enums (æšä¸¾)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Use-the-Introspected-Annotation-on-a-Configuration-Class-%E5%9C%A8%E4%B8%80%E4%B8%AA%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%B8%8A%E4%BD%BF%E7%94%A8-Introspected-%E6%B3%A8%E8%A7%A3"><span class="nav-number">1.12.7.</span> <span class="nav-text">Use the @Introspected Annotation on a Configuration Class (åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Šä½¿ç”¨ @Introspected æ³¨è§£)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Write-an-AnnotationMapper-to-Introspect-Existing-Annotations-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA-AnnotationMapper-%E6%9D%A5%E5%86%85%E7%9C%81%E4%B8%80%E4%B8%AA%E5%B7%B2%E5%AD%98%E5%9C%A8%E7%9A%84%E6%B3%A8%E8%A7%A3"><span class="nav-number">1.12.8.</span> <span class="nav-text">Write an AnnotationMapper to Introspect Existing Annotations (ç¼–å†™ä¸€ä¸ª AnnotationMapper æ¥å†…çœä¸€ä¸ªå·²å­˜åœ¨çš„æ³¨è§£)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-BeanWrapper-API-BeanWrapper-API"><span class="nav-number">1.12.9.</span> <span class="nav-text">The BeanWrapper API (BeanWrapper API)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Jackson-and-Bean-Introspection-Jackson-%E5%92%8C-Bean-%E5%86%85%E7%9C%81"><span class="nav-number">1.12.10.</span> <span class="nav-text">Jackson and Bean Introspection (Jackson å’Œ Bean å†…çœ)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Validation-Bean-%E6%A0%A1%E9%AA%8C"><span class="nav-number">1.13.</span> <span class="nav-text">Bean Validation (Bean æ ¡éªŒ)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Validating-Bean-Methods-%E6%A3%80%E9%AA%8C-Bean-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">1.13.1.</span> <span class="nav-text">Validating Bean Methods (æ£€éªŒ Bean çš„æ–¹æ³•)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Validating-Data-Classes-%E6%A0%A1%E9%AA%8C%E6%95%B0%E6%8D%AE%E7%B1%BB"><span class="nav-number">1.13.2.</span> <span class="nav-text">Validating Data Classes (æ ¡éªŒæ•°æ®ç±»)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Validation-Configuration-Properties-%E6%A0%A1%E9%AA%8C%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="nav-number">1.13.3.</span> <span class="nav-text">Validation Configuration Properties (æ ¡éªŒå±æ€§é…ç½®)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Defining-Additional-Constraints-%E5%AE%9A%E4%B9%89%E9%A2%9D%E5%A4%96%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.13.4.</span> <span class="nav-text">Defining Additional Constraints (å®šä¹‰é¢å¤–çš„çº¦æŸ)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Validating-Annotations-at-Compile-Time-%E5%9C%A8%E7%BC%96%E8%AF%91%E6%97%B6%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3"><span class="nav-number">1.13.5.</span> <span class="nav-text">Validating Annotations at Compile Time (åœ¨ç¼–è¯‘æ—¶æ ¡éªŒæ³¨è§£)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean-Annotation-Metadata-Bean-%E6%B3%A8%E8%A7%A3%E5%85%83%E6%95%B0%E6%8D%AE"><span class="nav-number">1.14.</span> <span class="nav-text">Bean Annotation Metadata (Bean æ³¨è§£å…ƒæ•°æ®)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Annotation-Inheritance-%E6%B3%A8%E8%A7%A3%E7%BB%A7%E6%89%BF"><span class="nav-number">1.14.1.</span> <span class="nav-text">Annotation Inheritance (æ³¨è§£ç»§æ‰¿)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Aliasing-or-Mapping-Annotations-%E5%8F%96%E5%88%AB%E5%90%8Dor%E6%98%A0%E5%B0%84%E6%B3%A8%E8%A7%A3"><span class="nav-number">1.14.2.</span> <span class="nav-text">Aliasing or Mapping Annotations (å–åˆ«åoræ˜ å°„æ³¨è§£)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Importing-Beans-from-Libraries-%E4%BB%8E%E4%B8%80%E4%B8%AA%E5%BA%93%E4%B8%AD%E5%AF%BC%E5%85%A5-Beans"><span class="nav-number">1.15.</span> <span class="nav-text">Importing Beans from Libraries (ä»ä¸€ä¸ªåº“ä¸­å¯¼å…¥ Beans)</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
