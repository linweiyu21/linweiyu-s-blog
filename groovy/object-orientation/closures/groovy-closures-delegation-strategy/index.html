<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Micronaut,Groovy,Gradle,Java,ÊñáÊ°£,‰∏≠Êñá">
    <meta name="description" content="Micronaut Groovy Gradle Java ÊñáÊ°£ ‰∏≠Êñá">
    <meta name="author" content="ÊûóÂ®ÅÁæΩ">
    
    <title>
        
            Groovy Closures Delegation strategy |
        
        ÊûóÂ®ÅÁæΩÁöÑÁ¨îËÆ∞
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"rgb(153,153,0)","avatar":"/images/avatar.jpg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"400px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":null,"description":"def containsüöÄ = ['Micronaut', 'Groovy', 'Gradle', 'etc']"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ÁßíÂâç","minute":"%s ÂàÜÈíüÂâç","hour":"%s Â∞èÊó∂Ââç","day":"%s Â§©Ââç","week":"%s Âë®Ââç","month":"%s ‰∏™ÊúàÂâç","year":"%s Âπ¥Ââç"};
  </script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                ÊûóÂ®ÅÁæΩÁöÑÁ¨îËÆ∞
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                È¶ñÈ°µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                ÂàÜÁ±ª
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                Ê†áÁ≠æ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ÂΩíÊ°£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ÂÖ≥‰∫é
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">È¶ñÈ°µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">ÂàÜÁ±ª</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">Ê†áÁ≠æ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ÂΩíÊ°£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ÂÖ≥‰∫é</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

    <a target="_blank" rel="noopener" href="https://github.com/linweiyu21/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80"
        viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
        aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor" class="octo-body"></path>
      </svg></a>
    <style>
      .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }

      @keyframes octocat-wave {

        0%,
        100% {
          transform: rotate(0)
        }

        20%,
        60% {
          transform: rotate(-25deg)
        }

        40%,
        80% {
          transform: rotate(10deg)
        }
      }

      @media (max-width:500px) {
        .github-corner:hover .octo-arm {
          animation: none
        }

        .github-corner .octo-arm {
          animation: octocat-wave 560ms ease-in-out
        }
      }
    </style>
</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Groovy Closures Delegation strategy</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">ÊûóÂ®ÅÁæΩ</span>
                        
                            <span class="author-label">Lv8</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-04-29 17:17:42</span>
        <span class="mobile">2022-04-29 17:17</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Groovy-Object-Orientation-Closures/">Groovy Object Orientation - Closures</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Groovy/">Groovy</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Object-Orientation/">Object Orientation</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Closures/">Closures</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <!-- TOC -->

<ul>
<li><a href="#groovy-closures-delegation-strategy">Groovy Closures Delegation strategy</a><ul>
<li><a href="#groovy-closure-vs-lambda-expressions">Groovy closure vs lambda expressions</a></li>
<li><a href="#owner-delegate-and-this">Owner, delegate and this</a><ul>
<li><a href="#the-meaning-of-this">The meaning of this</a></li>
<li><a href="#owner-of-a-closure">Owner of a closure</a></li>
<li><a href="#delegate-of-a-closure">Delegate of a closure</a></li>
<li><a href="#delegation-strategy">Delegation strategy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="Groovy-Closures-Delegation-strategy"><a href="#Groovy-Closures-Delegation-strategy" class="headerlink" title="Groovy Closures Delegation strategy"></a>Groovy Closures Delegation strategy</h1><h2 id="Groovy-closure-vs-lambda-expressions"><a href="#Groovy-closure-vs-lambda-expressions" class="headerlink" title="Groovy closure vs lambda expressions"></a>Groovy closure vs lambda expressions</h2><p>Groovy Â∞Ü closures ÂÆö‰πâ‰∏∫ Closure Á±ªÁöÑÂÆû‰æãÔºåËøô‰ΩøÂæó Closure Âíå Java 8 ‰∏≠ÁöÑ <code>lambda expressions</code> ÈùûÂ∏∏Âú∞‰∏çÂêå</p>
<p>Âú® Groovy ÁöÑ Closure ‰∏≠ÂßîÊâòÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÊ¶ÇÂøµÔºåËÄå lambdas ‰∏≠Âπ∂Ê≤°ÊúâÂßîÊâò</p>
<p>‰æùÊâò‰øÆÊîπÂßîÊâòÊàñËÄÖÂßîÊâòÁ≠ñÁï•ÁöÑËÉΩÂäõÔºåÂú® Groovy ‰∏≠ÈùûÂ∏∏ÂÆπÊòìÂÆûÁé∞ÊºÇ‰∫ÆÁöÑÈ¢ÜÂüüÂÆö‰πâËØ≠Ë®Ä</p>
<h2 id="Owner-delegate-and-this"><a href="#Owner-delegate-and-this" class="headerlink" title="Owner, delegate and this"></a>Owner, delegate and this</h2><p>‰∏Ä‰∏™ Closure ÂÆö‰πâ‰∫Ü 3 ‰∏™ÊòéÁ°ÆÁöÑ‰∏úË•øÔºö</p>
<ul>
<li><code>this</code> : corresponds to the ++enclosing class++ where the closure is defined</li>
<li><code>owner</code> : corresponds to the ++enclosing object++ where the closure is defined, which may be either a class or a closure</li>
<li><code>delegate</code> : corresponds to ++a third party object++ where methods calls or properties are resolved whenever the receiver of the message is not defined</li>
</ul>
<h3 id="The-meaning-of-this"><a href="#The-meaning-of-this" class="headerlink" title="The meaning of this"></a>The meaning of this</h3><p>Á¶ª Closure ÊúÄËøëÁöÑÁ±ªÔºà‰∏çÂåÖÊã¨ ClosureÔºâÔºåÂ∞±ÊòØ <code>this</code></p>
<p>In a closure, calling <code>getThisObject</code> will return the enclosing class where the closure is defined.</p>
<p>It is equivalent to using an explict <code>this</code> :</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Enclosing</span> &#123;</span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> whatIsThisObject = &#123; getThisObject() &#125;</span><br><span class="line">        <span class="keyword">assert</span> whatIsThisObject() == <span class="variable language_">this</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> whatIsThis = &#123; <span class="variable language_">this</span> &#125;</span><br><span class="line">        <span class="keyword">assert</span> whatIsThis == <span class="variable language_">this</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EnclosedInInnerClass</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Inner</span> &#123;</span><br><span class="line">        Closure c1 = &#123; <span class="variable language_">this</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> inner = <span class="keyword">new</span> Inner()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">assert</span> inner.c1() == inner          <span class="comment">// `this` in the closure will return the inner class, not the top-level one</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NestedClosures</span> &#123;</span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> nestedClosures = &#123;</span><br><span class="line">            <span class="keyword">def</span> c1 = &#123; <span class="variable language_">this</span> &#125;</span><br><span class="line">            c1()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">assert</span> nestedClosures() == <span class="variable language_">this</span>     <span class="comment">// then `this` corresponds to the closest outer class, not the enclosing closure!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>It is of course possible to call methods from the enclosing class this way:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">    Integer age</span><br><span class="line">    </span><br><span class="line">    String toString() &#123; <span class="string">&quot;$name is $age years old&quot;</span> &#125;</span><br><span class="line">    </span><br><span class="line">    String dump() &#123;</span><br><span class="line">        <span class="keyword">def</span> cl = &#123;</span><br><span class="line">            String msg = <span class="variable language_">this</span>.toString()    <span class="comment">// Ë∞ÉÁî®ÁöÑÊòØË∑ùÁ¶ªÊúÄËøëÁöÑ Person Á±ªÁöÑÂÆû‰æãÁöÑ toString() ÊñπÊ≥ï</span></span><br><span class="line">            println msg</span><br><span class="line">            msg</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        cl()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="attr">name:</span> <span class="string">&quot;lin&quot;</span>, <span class="attr">age:</span> <span class="number">28</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> p.dump() == <span class="string">&#x27;lin is 28 years old&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Owner-of-a-closure"><a href="#Owner-of-a-closure" class="headerlink" title="Owner of a closure"></a>Owner of a closure</h3><p>Âíå <code>this</code> ÂæàÁ±ª‰ººÔºå‰∏çÂêåÁöÑÊòØÂÆÉËøîÂõûÁöÑÊòØ ÊúÄËøëÁöÑÂØπË±°Ôºå‰∏Ä‰∏™ closure ÊàñËÄÖ‰∏Ä‰∏™ class</p>
<p>The owner of a closure is very similar to the definition of <code>this</code> in a closure with a subtle difference: it will return the direct enclosing object, be it a ++closure++ or a class:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Enclosing</span> &#123;</span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> whatIsOwnerMethod = &#123; getOwner() &#125;</span><br><span class="line">        <span class="keyword">assert</span> whatIsOwnerMethod == <span class="variable language_">this</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> whatIsOwner = &#123; owner &#125;</span><br><span class="line">        <span class="keyword">assert</span> whatIsOwner == <span class="variable language_">this</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EnclosedInInnerClass</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Inner</span> &#123;</span><br><span class="line">        Closure cl = &#123; owner &#125;</span><br><span class="line">        Closure cl2 = &#123; <span class="variable language_">this</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> inner = <span class="keyword">new</span> Inner()</span><br><span class="line">        <span class="keyword">assert</span> inner.cl() == inner                  <span class="comment">// `owner` in the closure will return the inner class, not the top-level one</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> inner.cl() == inner.cl2()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NestedClosures</span> &#123;</span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> nestedClosures = &#123;</span><br><span class="line">            <span class="keyword">def</span> cl = &#123; owner &#125;</span><br><span class="line">            cl()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">assert</span> nestedClosures() == nestedClosures   <span class="comment">// then `owner` corresponds to the enclosing closure, hence a different object from `this`!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Delegate-of-a-closure"><a href="#Delegate-of-a-closure" class="headerlink" title="Delegate of a closure"></a>Delegate of a closure</h3><p><code>Delegate</code> ÈªòËÆ§Á≠â‰∫é <code>owner</code>ÔºåÂèØ‰ª•ÊâãÂä®ÊåáÂÆö</p>
<p>The delegate of a closure can be accessed by using the <code>delegate</code> property or calling the <code>getDelegate</code> method.</p>
<p>It is a powerful concept for building domain specific languages in Groovy.</p>
<p>While <code>closure-this</code> and <code>closure-owner</code> refer to the lexical(ËØ≠Ê≥ï‰∏ä) scope of a closure, the delegate is a user defined object that a closure will use.</p>
<p>By default, the delegate is set to <code>owner</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Enclosing</span> &#123;</span><br><span class="line">    <span class="type">void</span> run() &#123;</span><br><span class="line">        <span class="keyword">def</span> cl = &#123; getDelegate() &#125;</span><br><span class="line">        <span class="keyword">def</span> cl2 = &#123; delegate &#125;</span><br><span class="line">        <span class="keyword">assert</span> cl() ==  cl2()</span><br><span class="line">        <span class="keyword">assert</span> cl() == <span class="variable language_">this</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> enclosed = &#123;</span><br><span class="line">            &#123; -&gt; delegate &#125;.call()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">assert</span> enclosed() == enclosed       <span class="comment">// `delegate` will correspond to the `owner`</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The delegate of a closure can be changed to any object:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Thing</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="attr">name:</span> <span class="string">&quot;Norman&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> t = <span class="keyword">new</span> Thing(<span class="attr">name:</span> <span class="string">&#x27;Teapot&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> upperCaseName = &#123; delegate.name.toUpperCase() &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Then by changing the delegate of the closure, you can see that the target object will change</span></span><br><span class="line">upperCaseName.delegate = p</span><br><span class="line"><span class="keyword">assert</span> upperCaseName() == <span class="string">&#x27;NORMAN&#x27;</span></span><br><span class="line"></span><br><span class="line">upperCaseName.delegate = t</span><br><span class="line"><span class="keyword">assert</span> upperCaseName() == <span class="string">&#x27;TEAPOT&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Delegation-strategy"><a href="#Delegation-strategy" class="headerlink" title="Delegation strategy"></a>Delegation strategy</h3><p>Whenever, in a closure, a property is accessed without explicitly setting a receiver object, then a delegation strategy is involved:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="attr">name:</span> <span class="string">&#x27;Igor&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> cl = &#123; name.toUpperCase() &#125;     <span class="comment">// `name` is not referencing a variable in the lexical scope of the closure</span></span><br><span class="line"></span><br><span class="line">cl.delegate = p</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> cl() == <span class="string">&#x27;IGOR&#x27;</span></span><br></pre></td></tr></table></figure>

<p>The reason this code works is that ++the <code>name</code> property will be resolved transparently on the <code>delegate</code> object++!</p>
<p>There‚Äôs no need to set an explicit <code>delegate.</code> receiver: the call will be made because the default delegation strategy of the closure makes it so.</p>
<p>A closure actually defines multiple resolution strategies that you can choose:</p>
<ul>
<li><code>Closure.OWNER_FIRST</code> is the ++default strategy++. If a property&#x2F;method exists on the owner, then it will be called on the owner. If not, then the ++delegate++ is used.</li>
<li><code>Closure.DELEGATE_FIRST</code> reverses the logic: the ++delegate++ is used first, then the owner</li>
<li><code>Closure.OWNER_ONLY</code> will only resolve the property&#x2F;method lookup on the owner: the delegate will be ignored</li>
<li><code>Closure.DELEGATE_ONLY</code> will only resolve the property&#x2F;method lookup on the delegate: the owner will be ignored</li>
<li><code>Closure.TO_SELF</code> can be used by developers who need advanced meta-programming techniques and wish to implement a custom resolution strategy: the resolution will not be made on the owner or the delegate but only on the closure class itself. It makes only sense to use this if you implement your own subclass of <code>Closure</code></li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">    <span class="keyword">def</span>    pretty = &#123; <span class="string">&quot;My name is $name&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">    String toString() &#123; pretty() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Thing</span> &#123;</span><br><span class="line">    String name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="attr">name:</span> <span class="string">&#x27;Sarah&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> t = <span class="keyword">new</span> Thing(<span class="attr">name:</span> <span class="string">&#x27;Teapot&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> p.toString() == <span class="string">&#x27;My name is Sarah&#x27;</span></span><br><span class="line"></span><br><span class="line">p.pretty.delegate = t</span><br><span class="line"><span class="keyword">assert</span> p.toString() == <span class="string">&#x27;My name is Sarah&#x27;</span>           <span class="comment">// there is no change in the result: `name` is first resolved on the `owner` of the closure. Âõ†‰∏∫ÈªòËÆ§ÊòØ OWNER_FIRST Á≠ñÁï•</span></span><br><span class="line"></span><br><span class="line">p.pretty.resolveStrategy = Closure.DELEGATE_FIRST   <span class="comment">// `name` will first be looked in the delegate, then if not found, on the owner. Since `name` is defined in the delegate, an instance of `Thing`, then this value is used</span></span><br><span class="line"><span class="keyword">assert</span> p.toString() == <span class="string">&#x27;My name is Teapot&#x27;</span></span><br></pre></td></tr></table></figure>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Êú¨ÊñáÊ†áÈ¢òÔºöGroovy Closures Delegation strategy</li>
        <li>Êú¨Êñá‰ΩúËÄÖÔºöÊûóÂ®ÅÁæΩ</li>
        <li>ÂàõÂª∫Êó∂Èó¥Ôºö2022-04-29 17:17:42</li>
        <li>
            Êú¨ÊñáÈìæÊé•Ôºöhttps://linweiyu21.github.io/groovy/object-orientation/closures/groovy-closures-delegation-strategy/
        </li>
        <li>
            ÁâàÊùÉÂ£∞ÊòéÔºöÊú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Groovy/">#Groovy</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Object-Orientation/">#Object Orientation</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Closures/">#Closures</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/groovy/object-orientation/closures/groovy-closures-in-gstrings/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Groovy Closures in GStrings</span>
                                <span class="post-nav-item">‰∏ä‰∏ÄÁØá</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/groovy/object-orientation/closures/groovy-closures-parameters/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Groovy Closures Parameters</span>
                                <span class="post-nav-item">‰∏ã‰∏ÄÁØá</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;ËØÑËÆ∫</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: '8xWQ0WFbKUNN4h8ixIO12etk-gzGzoHsz',
                    appKey: '7cLjTvkIsF6aIuIVSd0um89m',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: 'ËØ∑ÂºÄÂßã‰Ω†ÁöÑË°®Êºî',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return 'Âçö‰∏ª';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'ÊûóÂ®ÅÁæΩ';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">ÊûóÂ®ÅÁæΩ</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        ËÆøÈóÆ‰∫∫Êï∞&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        ÊÄªËÆøÈóÆÈáè&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Áî± <a target="_blank" href="https://hexo.io">Hexo</a> È©±Âä®&nbsp;|&nbsp;‰∏ªÈ¢ò&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Groovy-Closures-Delegation-strategy"><span class="nav-number">1.</span> <span class="nav-text">Groovy Closures Delegation strategy</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Groovy-closure-vs-lambda-expressions"><span class="nav-number">1.1.</span> <span class="nav-text">Groovy closure vs lambda expressions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Owner-delegate-and-this"><span class="nav-number">1.2.</span> <span class="nav-text">Owner, delegate and this</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-meaning-of-this"><span class="nav-number">1.2.1.</span> <span class="nav-text">The meaning of this</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Owner-of-a-closure"><span class="nav-number">1.2.2.</span> <span class="nav-text">Owner of a closure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delegate-of-a-closure"><span class="nav-number">1.2.3.</span> <span class="nav-text">Delegate of a closure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delegation-strategy"><span class="nav-number">1.2.4.</span> <span class="nav-text">Delegation strategy</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="ÊêúÁ¥¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
